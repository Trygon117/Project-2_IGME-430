/*! For license information please see controllerBundle.js.LICENSE.txt */
(()=>{var e={832:(e,t,a)=>{const n=a(603),r=a(764).lW,s=e=>React.createElement("div",null,React.createElement("div",{className:"box",style:{minHeight:"100vh"}},React.createElement("h1",{className:"title"},"My Novels:"),React.createElement("hr",null),React.createElement("div",{id:"novel-cards",className:"is-flex",style:{gap:10}}))),o=e=>{const t=r.from(e.novel.cover.data,"base64").toString("base64"),a=`data:${e.novel.coverMime};base64,${t}`;return React.createElement("div",{style:{border:"ridge thin",width:200,height:360},onMouseEnter:t=>{const a=document.getElementById(`${e.novel.title}-title`);a.classList.add("is-size-4"),a.classList.remove("is-size-5"),t.currentTarget.style.width=250,t.currentTarget.style.height=450},onMouseLeave:t=>{const a=document.getElementById(`${e.novel.title}-title`);a.classList.add("is-size-5"),a.classList.remove("is-size-4"),t.currentTarget.style.width=200,t.currentTarget.style.height=360},onClick:t=>{console.log(`Card clicked: ${t.currentTarget}`),window.localStorage.setItem("partchment-editorNovelID",e.novel._id),window.location.assign("/editNovel")}},React.createElement("div",{className:"card"},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${e.novel.title}-img`,src:a,alt:"Placeholder image"})))),React.createElement("h1",{id:`${e.novel.title}-title`,className:"is-size-5 has-text-centered has-text-grey",style:{overflow:"hidden"}},e.novel.title))},l=e=>React.createElement("div",{className:"card",style:{width:200},onMouseEnter:e=>{e.currentTarget.style.width=250},onMouseLeave:e=>{e.currentTarget.style.width=200},onClick:t=>{i(e)}},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:"/assets/img/AddCard.png",alt:"Placeholder image"})))),c=async e=>{const t=await fetch("/getLoggedInAs"),a=await t.json();console.log(a);const r=a.username;ReactDOM.render(React.createElement(s,{csrf:e}),document.getElementById("create-content")),n.sendPost("/searchNovelsByUser",{user:r,_csrf:e},(t=>{t.error||(console.log(t),novels=t.novels,console.log(novels),Object.values(novels).forEach((t=>{const a=t.title.toLowerCase().replace(" ","_"),n=document.createElement("div");n.id=a,document.getElementById("novel-cards").appendChild(n),ReactDOM.render(React.createElement(o,{csrf:e,novel:t}),document.getElementById(a))})));const a="empty-card",n=document.createElement("div");n.id=a,document.getElementById("novel-cards").appendChild(n),ReactDOM.render(React.createElement(l,{csrf:e}),document.getElementById(a))}))},i=e=>{const t=e=>React.createElement("div",null,React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{height:65,width:"100vw",border:"thin ridge"}},React.createElement("div",{className:"column is-offset-0"},React.createElement("a",{className:"button is-white",onClick:()=>{c(e.csrf)}},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back"))),React.createElement("div",{style:{height:10}}),React.createElement("form",{id:"createNovelForm",name:"createNovelForm",onSubmit:handleCreateNovel,action:"/createNovel",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Create A New Novel!")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"title"},"Title: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"title",type:"text",name:"title",placeholder:"Title"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-book"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label"},"Book Cover: "),React.createElement("div",{className:""},React.createElement("div",{className:"file is-boxed has-name is-info"},React.createElement("label",{className:"file-label"},React.createElement("input",{className:"file-input",id:"cover",type:"file",name:"cover",onChange:async e=>{const t=e.currentTarget.files[0];if(!t)return;const a=new FileReader;a.addEventListener("load",(()=>{const e=a.result;document.querySelector("#coverPreview").src=e,document.querySelector("#fileName").innerHTML=t.name})),a.readAsDataURL(t)}}),React.createElement("span",{className:"file-cta"},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fas fa-upload"})),React.createElement("span",{className:"file-label"},"Choose a file…")),React.createElement("span",{id:"fileName",className:"file-name"},"Use a 2:3 aspect ratio"))),React.createElement("div",{className:"",style:{width:200}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:"coverPreview",src:"/assets/img/1080x1920.png",alt:"Placeholder image"}))))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"create-novel-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Create"}))));ReactDOM.render(React.createElement(t,{csrf:e.csrf}),document.getElementById("create-content"))};handleCreateNovel=e=>{e.preventDefault();const t=document.getElementById("title").value,a=document.getElementById("cover"),r=document.getElementById("create-novel-error-span"),s=e.target.querySelector("#_csrf").value;if(!t)return void(r.innerHTML="Title is required!");const o=a.files[0];if(!o||void 0===o)return void(r.innerHTML="Cover is required!");const l={_csrf:s,formData:new FormData(document.querySelector("#createNovelForm"))};n.sendMultipartPost("/createNovel",l,d)};const d=e=>{c(e.csrfToken)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();c(t.csrfToken)}}},986:(e,t,a)=>{const n=a(603);let r,s,o=!0;const l=e=>{console.log("props"),console.log(e);let t=e.chapter,a=!1;const l=async a=>{const r="Publish"===document.getElementById("publish-button").innerText,s=()=>{const e=document.getElementById("publish-button"),a=document.getElementById("publish-icon"),n=document.createTextNode("Publish");e.innerHTML="",console.log("Chapter"),console.log(t),t.published?(n.textContent="Unpublish",e.classList.add("is-danger"),e.classList.remove("is-primary"),a.className="fa-solid fa-x"):(n.textContent="Publish",e.classList.remove("is-danger"),e.classList.add("is-primary"),a.className="fa-solid fa-check"),e.appendChild(a),e.appendChild(n)};if(r)v("publish chapter",(r=>{console.log(t);const o={chapterID:t._id,novelID:t.novelID,chapter:t.chapter,chapterNumber:r.chapterNumber,mode:r.mode,referenceChapter:r.chapter,_csrf:e.csrf};n.sendPost("/publishChapter",o,(r=>{console.log("pubChapterResponse"),console.log(r),"novel not published"===r.error?v("publish novel",(()=>{console.log("publish novel"),n.sendPost("/publishNovel",{novelID:t.novelID,published:!0,_csrf:e.csrf},(e=>{console.log(e),e.error?console.log("Could not publish the novel"):l(a)}))})):r.error?(console.log("error publishing"),document.getElementById("modal").classList.remove("is-active")):(console.log("published!"),document.getElementById("modal").classList.remove("is-active"),t=r.chapter,console.log(e),s())}))}));else{const a={chapterID:t._id,novelID:t.novelID,chapter:t.chapter,mode:"unpublish",_csrf:e.csrf};await n.sendPost("/publishChapter",a,(a=>{console.log("unPubResponse"),console.log(a),t=a.chapter,console.log(e),s()}))}},c=e=>{switch(e.key){case"Control":a=!0;break;case"b":a&&(e.preventDefault(),console.log("bold"),u());break;case"i":a&&(e.preventDefault(),p());break;case"u":a&&(e.preventDefault(),h())}},i=e=>{"Control"===e.key&&(a=!1)},d=a=>{if(o)return;console.log("updating...");const s=document.getElementById("editable-chapter-content"),l=document.getElementById("saved-span");if(l.innerHTML="Unsaved",l.classList.remove("is-success"),l.classList.add("is-warning"),s.innerText.length<=1){const e=document.createElement("span");e.classList.add("georgia-font-span"),e.classList.add("font-size-20-span"),e.innerText=s.innerText,s.innerHTML="",s.appendChild(e);const t=document.createRange(),a=window.getSelection();t.setStart(e,s.innerText.length),t.collapse(!0),a.removeAllRanges(),a.addRange(t)}const c=e=>{if(e.hasChildNodes())e.childNodes.forEach((e=>{c(e)}));else if(e.textContent&&-1!=e.textContent.indexOf("​")){const t=window.getSelection();if(t.rangeCount<=0)return void(e.textContent=e.textContent.replace("​",""));const a=t.getRangeAt(0);let n;a.startOffset===a.endOffset&&(n=a.startOffset);let r=a.commonAncestorContainer.parentElement;if(e.textContent=e.textContent.replace("​",""),r.isEqualNode(e.parentElement)){const t=document.createRange(),a=window.getSelection();n&&n>0?t.setStart(e,n-1):t.setStart(e,e.textContent.length),t.collapse(!0),a.removeAllRanges(),a.addRange(t)}}};c(s),r&&(clearInterval(r),r=null),r=setInterval((async()=>{console.log("update content"),clearInterval(r),r=null,console.log(t),await n.sendPost("/editChapter",{chapterID:t._id,content:s.innerHTML,_csrf:e.csrf},(e=>{e.error?(console.log(e.error),l.innerHTML="Error",l.classList.remove("is-warning"),l.classList.remove("is-success"),l.classList.add("is-error")):(l.innerHTML="Saved",l.classList.remove("is-warning"),l.classList.remove("is-error"),l.classList.add("is-success"))}))}),1e3)},m=e=>{const t=window.getSelection();if(t.rangeCount<=0)return!1;const a=t.getRangeAt(0);let r=a.commonAncestorContainer.parentElement;if(!n.isDescendent(document.getElementById("textDiv"),r)&&!r.isEqualNode(document.getElementById("textDiv")))return!1;if(r.isEqualNode(document.getElementById("saved-span")))return!1;if(0===a.cloneContents().childNodes.length){const e=document.getElementById("bold-button"),t=document.getElementById("italic-button"),a=document.getElementById("underline-button");r.classList.contains("bold-span")?(e.classList.remove("is-outlined"),e.classList.add("is-dark")):(e.classList.add("is-outlined"),e.classList.remove("is-dark")),r.classList.contains("italic-span")?(t.classList.remove("is-outlined"),t.classList.add("is-dark")):(t.classList.add("is-outlined"),t.classList.remove("is-dark")),r.classList.contains("underline-span")?(a.classList.remove("is-outlined"),a.classList.add("is-dark")):(a.classList.add("is-outlined"),a.classList.remove("is-dark"))}},u=async()=>{f("bold-span")&&(console.log("updating"),d())},p=()=>{f("italic-span")&&d()},h=()=>{f("underline-span")&&d()},f=e=>{const t=window.getSelection();if(t.rangeCount<=0)return!1;const a=t.getRangeAt(0);let r=a.commonAncestorContainer.parentElement,s=r.cloneNode(!0);if(!n.isDescendent(document.getElementById("textDiv"),r)&&!r.isEqualNode(document.getElementById("textDiv")))return!1;if(r.isEqualNode(document.getElementById("saved-span")))return!1;let o=r.classList;const l=a.extractContents();if(0===l.childNodes.length&&(console.log("no children"),!r.classList.contains(e))){const n=document.createElement("span");n.className=e,n.innerHTML="&#8203",console.log(n),a.insertNode(n);const r=document.createRange();return r.setStart(n,1),r.collapse(!0),t.removeAllRanges(),void t.addRange(r)}const c=Array.from(l.childNodes);let i;a.insertNode(l);let d=!1;"SPAN"===r.tagName?(d=!0,i=Array.from(r.childNodes),r.remove()):(r=document.getElementById("editable-chapter-content"),s=r.cloneNode(!0),i=Array.from(r.childNodes),r.innerHTML="");const m=[],u=g(i,c);u.firstNodesToAdd.forEach((e=>{let t=e;d&&(3===e.nodeType?(t=document.createElement("span"),t.classList=o,t.innerText=e.textContent):"SPAN"===e.tagName?o.forEach((e=>{t.classList.add(e)})):console.log("firstNodeToAdd had unhandled nodeType")),m.unshift(t)}));let p=!1;for(const t of s.childNodes){if(console.log(t),1!==t.nodeType){p=!1;break}if(!t.classList.contains(e)){p=!1;break}p=!0}u.selectNodesToAdd.forEach((t=>{let a=t;s.classList.contains(e)||p?3===t.nodeType?(a=document.createElement("span"),a.classList=o,a.classList.remove(e),a.innerHTML=t.textContent):"SPAN"===t.tagName&&a.classList.remove(e):3===t.nodeType?(a=document.createElement("span"),a.classList=o,a.classList.add(e),a.innerHTML=t.textContent):"SPAN"===t.tagName&&a.classList.add(e),m.unshift(a)})),u.lastNodesToAdd.forEach((e=>{let t=e;d&&(3===e.nodeType?(t=document.createElement("span"),t.classList=o,t.innerText=e.textContent):"SPAN"===e.tagName?o.forEach((e=>{t.classList.add(e)})):console.log("lastNodeToAdd had unhandled nodeType")),m.unshift(t)})),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();let h=document.getElementById("editable-chapter-content");m.forEach((e=>{a.insertNode(e)}));const f=h.querySelectorAll("span");let v=[];f.forEach((e=>{""===e.innerText&&v.push(e)})),v.forEach((e=>{e.remove()}));const w=y(h);h.before(w),h.remove(),h=document.getElementById("editable-chapter-content");const R=b(h);return h.before(R),h.remove(),h=document.getElementById("editable-chapter-content"),console.log(h),console.log(h.cloneNode(!0)),E(h),!0},g=(e,t)=>{const a=[],n=[],r=[];return e.forEach((e=>{let s=!1;t.forEach((t=>{e.isEqualNode(t)&&(n.push(t),s=!0)})),s||(0===n.length?a.push(e):r.push(e))})),{firstNodesToAdd:a,selectNodesToAdd:n,lastNodesToAdd:r}},y=e=>{let t=e.cloneNode(!0);for(const e of t.querySelectorAll("span"))if(e.nextElementSibling===e.nextSibling&&null!==e.nextSibling&&"SPAN"===e.nextSibling.tagName){if(0===e.classList.length){const a=document.createTextNode(e.innerText);e.before(a),e.remove(),t=y(t);break}if(e.className===e.nextSibling.className){let a=document.createElement("span");a.classList=e.classList,a.innerText=e.innerText+e.nextSibling.innerText,e.before(a),e.nextElementSibling.remove(),e.remove(),t=y(t);break}}return t},b=e=>{let t=e.cloneNode(!0);for(const e of t.childNodes)if(3==e.nodeType&&e.nextSibling&&3===e.nextSibling.nodeType){let a=document.createTextNode(e.textContent+e.nextSibling.textContent);e.before(a),e.nextSibling.remove(),e.remove(),t=y(t);break}return t},E=e=>{e.addEventListener("input",d),e.addEventListener("click",m),e.addEventListener("keyDown",c),e.addEventListener("keyUp",i)},v=(a,r)=>{const o=document.getElementById("modal-text-area"),l=document.getElementById("modal"),c=document.getElementById("modal-yes-button"),i=document.getElementById("modal-cancel-button"),d=document.getElementById("modal-title");switch(c.disabled=!1,a){case"publish novel":o.innerHTML="";const a=document.createElement("p"),m=document.createElement("p");a.innerText="This chapter cannot be published because the novel is not published.",m.innerText="Would you like to publish the novel ? ",o.appendChild(a),o.appendChild(m),c.style.visibility="visible",c.innerText="Yes",c.removeEventListener("click",s),s=r,c.addEventListener("click",r),i.innerText="Cancel",d.innerText="Novel Not Published",l.classList.add("is-active");break;case"publish chapter":o.innerHTML="",c.disabled=!0,n.sendPost("/searchNovelByID",{novelID:t.novelID,_csrf:e.csrf},(e=>{console.log(e);const t=[];Object.keys(e.novel.chapters).forEach((e=>{e.includes("chapter-")&&t.push(e)}));const a=document.createElement("div");a.style.border="ridge thin",a.style.height="350px",a.style.overflowY="auto";for(const e of t){const t=document.createElement("div");t.id="chap-option-container",t.setAttribute("data-selected","false");const n=()=>{let e=!1;"true"===t.getAttribute("data-selected")&&(e=!0),a.querySelectorAll("#chap-option-container").forEach((e=>{e.setAttribute("data-selected","false")}));let n=!1;t.childNodes.forEach((e=>{"true"===e.getAttribute("data-selected")&&(n=!0)})),e&&!n||t.setAttribute("data-selected","true")},r=document.createElement("span");r.id="chap-insert",r.setAttribute("insert","before");const s=document.createElement("i");s.className="fa-solid fa-arrow-up";const o=document.createElement("p");o.innerText="insert before",r.style.border="thin ridge",r.className="has-text-grey",r.style.display="flex",r.style.alignItems="center",r.style.gap="10px",r.style.height="30px",r.appendChild(s),r.appendChild(o),r.style.visibility="hidden",r.style.display="none";const l=()=>{"true"===r.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#62c462",o.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#ffc9c9",o.style.fontSize="20px"):(r.style.height="30px",r.style.backgroundColor="#ffffff",o.style.fontSize="17px")};r.onmouseenter=()=>{r.style.height="40px",r.style.backgroundColor="#bbf0de",r.style.fontSize="20px"},r.onmouseleave=()=>{"true"===r.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#62c462",o.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#ffc9c9",o.style.fontSize="20px"):(r.style.height="30px",r.style.backgroundColor="#ffffff",o.style.fontSize="17px")},r.onclick=()=>{let e=!1;"true"===r.getAttribute("data-selected")&&(e=!0),a.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),a.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),e||r.setAttribute("data-selected","true"),n(),console.log("here"),y()};const i=document.createElement("span");i.id="chap-insert",i.setAttribute("insert","after");const d=document.createElement("i");d.className="fa-solid fa-arrow-down";const m=document.createElement("p");m.innerText="insert After",i.style.border="thin ridge",i.className="has-text-grey",i.style.display="flex",i.style.alignItems="center",i.style.gap="10px",i.style.height="30px",i.appendChild(d),i.appendChild(m),i.style.visibility="hidden",i.style.display="none";const u=()=>{"true"===i.getAttribute("data-selected")?(i.style.height="40px",i.style.backgroundColor="#62c462",m.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(i.style.height="40px",i.style.backgroundColor="#ffc9c9",m.style.fontSize="20px"):(i.style.height="30px",i.style.backgroundColor="#ffffff",m.style.fontSize="17px")};i.onchange=u,i.onmouseenter=()=>{i.style.height="40px",i.style.backgroundColor="#bbf0de",i.style.fontSize="20px"},i.onmouseleave=()=>{"true"===i.getAttribute("data-selected")?(i.style.height="40px",i.style.backgroundColor="#62c462",m.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(i.style.height="40px",i.style.backgroundColor="#ffc9c9",m.style.fontSize="20px"):(i.style.height="30px",i.style.backgroundColor="#ffffff",m.style.fontSize="17px")},i.onclick=()=>{let e=!1;"true"===i.getAttribute("data-selected")&&(e=!0),a.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),a.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),e||i.setAttribute("data-selected","true"),n(),y()};const p=document.createElement("span");p.id="chap-option";const h=document.createElement("i"),f=document.createElement("p");p.style.border="thin ridge",p.className="has-text-grey",p.style.display="flex",p.style.alignItems="center",p.style.gap="10px",p.style.height="30px",h.className="fa-solid fa-repeat",f.innerText=e,f.style.fontSize="17px";const g=()=>{"true"===p.getAttribute("data-selected")?(p.style.height="40px",p.style.backgroundColor="#62c462",f.style.fontSize="20px"):"true"===p.parentElement.getAttribute("data-selected")?(p.style.height="40px",p.style.backgroundColor="#ffc9c9",f.style.fontSize="20px"):(p.style.height="30px",p.style.backgroundColor="#ffffff",f.style.fontSize="17px")};p.onchange=g,p.onmouseenter=()=>{p.style.height="40px",p.style.backgroundColor="#bbf0de",f.style.fontSize="20px"},p.onmouseleave=()=>{"true"!==p.getAttribute("data-selected")?"true"===t.getAttribute("data-selected")?(p.style.height="40px",p.style.backgroundColor="#ffc9c9",f.style.fontSize="20px"):(p.style.height="30px",p.style.backgroundColor="#ffffff",f.style.fontSize="17px"):(p.style.height="40px",p.style.backgroundColor="#62c462",f.style.fontSize="20px")},p.onclick=()=>{let e=!1;"true"===p.getAttribute("data-selected")&&(e=!0),a.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false"),e.style.height="30px",e.style.backgroundColor="#ffffff",e.style.fontSize="17px"})),a.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false"),e.style.visibility="hidden",e.style.display="none"})),e?c.disabled=!0:(p.setAttribute("data-selected","true"),r.style.visibility="visible",i.style.visibility="visible",r.style.display="flex",i.style.display="flex",c.disabled=!1),n(),y()};const y=()=>{u(),l(),g()};p.appendChild(h),p.appendChild(f),t.appendChild(r),t.appendChild(p),t.appendChild(i),a.appendChild(t)}if(console.log(a),""===a.innerText){const e=document.createElement("p");e.innerText="This is the first chapter!",a.appendChild(e)}const n=document.createElement("a");n.className="button is-link",n.innerText="Publish As latest Chapter",n.style.marginBottom="10px",n.addEventListener("click",(()=>{r({chapterNumber:t.length,mode:"add-last"})}));const m=document.createElement("p");m.innerText="Or, Choose where to add it: ",m.className="subtitle",m.style.marginTop="10px",o.appendChild(n),o.appendChild(m),o.appendChild(a),c.style.visibility="visible",c.innerText="Publish";const u=()=>{a.querySelectorAll("span").forEach((e=>{if("true"===e.getAttribute("data-selected")){const t=e.parentElement.querySelector("#chap-option").querySelector("p").innerText;"chap-option"===e.id?r({chapter:t,mode:"replace"}):"chap-insert"===e.id&&("before"==e.getAttribute("insert")?r({chapter:t,mode:"insert-before"}):"after"==e.getAttribute("insert")&&r({chapter:t,mode:"insert-after"}))}}))};s&&c.removeEventListener("click",s),s=u,c.addEventListener("click",u),i.innerText="Cancel",d.innerText="Publish Chapter",l.classList.add("is-active")}));break;case"preview":o.innerHTML="";const u=document.createElement("p");u.innerText=t.content,o.appendChild(u),o.value=t.content,o.rows="1",c.style.visibility="hidden",i.innerText="Cancel",d.innerText=t.title,l.classList.add("is-active")}},w=()=>{document.getElementById("modal").classList.remove("is-active")};return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal",style:{zIndex:1001}},React.createElement("div",{className:"modal-background",onClick:e=>{(document.querySelectorAll(".modal")||[]).forEach((e=>{e.classList.remove("is-active")}))}}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:w})),React.createElement("section",{className:"modal-card-body"},React.createElement("div",{id:"modal-text-area"})),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-yes-button",className:"button is-success",onClick:w},"Yes"),React.createElement("button",{id:"modal-cancel-button",className:"button",onClick:w},"Cancel")))),React.createElement("div",{id:"editor-head",style:{position:"sticky",top:"0px",backgroundColor:"white",border:"thin ridge",zIndex:1e3}},React.createElement("div",{style:{height:65,width:"100vw",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",null,React.createElement("a",{className:"button is-white",href:"/editNovel"},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back")),React.createElement("div",{style:{display:"flex",flexFlow:"row",gap:10}},React.createElement("a",{id:"preview-button",className:"button is-link",onClick:e=>{console.log("preview!")}},React.createElement("i",{className:"fa-solid fa-eye",style:{padding:"0 10 0 0"}}),"Preview"),React.createElement("a",{id:"publish-button",className:"button is-primary",onClick:l},React.createElement("i",{id:"publish-icon",className:"fa-solid fa-check",style:{padding:"0 10 0 0"}}),"Publish"))),React.createElement("div",{id:"editor-controls",style:{height:40,width:"100vw",display:"flex",flexFlow:"row",justifyContent:"center",gap:"15px",margin:"0px 10px 10px 10px"}},React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"bold-button",className:"button is-outlined",onClick:u},React.createElement("i",{className:"fa-solid fa-bold"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"italic-button",className:"button is-outlined",onClick:p},React.createElement("i",{className:"fa-solid fa-italic"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"underline-button",className:"button is-outlined",onClick:h},React.createElement("i",{className:"fa-solid fa-underline"}))))),React.createElement("div",{id:"text-root",style:{display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center",width:"100vw",minHeight:"900px",marginBottom:"50px"}},React.createElement("div",{id:"title-div-container",style:{width:"720px",margin:0}},React.createElement("div",{id:"title-div",className:"title",contentEditable:"true",style:{marginTop:20,marginBottom:20,outline:"0px solid transparent"},onSelect:e=>{e.currentTarget.spellcheck=!0},onBlur:async a=>{console.log("update chap title");const r=document.getElementById("title-div");r.spellcheck=!1,console.log(t),await n.sendPost("/editChapter",{chapterID:t._id,title:r.innerHTML,_csrf:e.csrf},(e=>{console.log("response"),console.log(e),r.innerHTML=e.title}))}})),React.createElement("div",{id:"textDiv",style:{position:"relative",display:"block",width:"720px",minHeight:"900px",paddingBottom:"5px",borderWidth:"thick",border:"solid"}},React.createElement("span",{id:"saved-span",className:"tag is-success",style:{position:"absolute",bottom:"5px",right:"10px"}},"Saved"),React.createElement("div",{id:"editable-chapter-content",name:"textArea",contentEditable:"true",style:{padding:"3%",outline:"0px solid transparent",width:"100%",height:"100%"},onInput:d,onClick:m,onKeyDown:c,onKeyUp:i}))))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json(),a=localStorage.getItem("partchment-editorChapterID");if(!a)return console.log("No Chapter Selected"),void window.location.assign("/editNovel");n.sendPost("/searchChapterByID",{chapterID:a,_csrf:t.csrfToken},(e=>{console.log("chapterData"),console.log(e),"No Chapter Found"!==e.error?(ReactDOM.render(React.createElement(l,{csrf:t.csrfToken,chapter:e.chapter}),document.getElementById("edit-chapter-content")),(e=>{document.getElementById("title-div").innerHTML=e.title;const t=document.getElementById("publish-button"),a=document.getElementById("publish-icon"),n=document.createTextNode("Publish");t.innerHTML="",e.published?(n.textContent="Unpublish",t.classList.add("is-danger"),t.classList.remove("is-primary"),a.className="fa-solid fa-x"):(n.textContent="Publish",t.classList.remove("is-danger"),t.classList.add("is-primary"),a.className="fa-solid fa-check"),t.appendChild(a),t.appendChild(n),document.getElementById("editable-chapter-content").innerHTML=e.content,o=!1})(e.chapter)):window.location.assign("/editNovel")}))}}},401:(e,t,a)=>{const n=a(603),r=a(764).lW,s=a(441),o=e=>{console.log("edit novel window"),console.log(e);let t=e.novel,a="False";t.published&&(a="True");const o=r.from(t.cover.data,"base64").toString("base64"),l=`data:${t.coverMime};base64,${o}`,d=new Date(t.createdDate).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal"},React.createElement("div",{className:"modal-background",onClick:s.closeAllModals}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:s.closeModal})),React.createElement("section",{id:"modal-card-body",className:"modal-card-body"}),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-save-button",className:"button is-success",onClick:s.closeModal},"Save changes"),React.createElement("button",{className:"button",onClick:s.closeModal},"Cancel")))),React.createElement("div",{className:"box",style:{minHeight:"80vh",width:"100vw",margin:"auto",padding:0}},React.createElement("div",{className:"",style:{height:65,width:"100vw",margin:"auto",border:"thin ridge",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",{className:""},React.createElement("a",{className:"button is-white",href:"/create"},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back")),React.createElement("div",{className:""},React.createElement("button",{className:"button is-link",onClick:a=>{n.sendPost("/createChapter",{novelID:t._id,_csrf:e.csrf},(e=>{console.log(e),window.localStorage.setItem("partchment-editorChapterID",e.createdChapter._id),window.location.assign("/editChapter")}))}},React.createElement("i",{className:"fa-solid fa-plus",style:{padding:"0 10 0 0"}})," Create Chapter"))),React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{width:"95vw",margin:"auto"}},React.createElement("div",{className:"column",style:{maxWidth:"300px",margin:"auto"}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${t.title}-img`,src:l,alt:"Placeholder image"}))),React.createElement("div",{className:"column is-three-quarters",style:{height:"34.35vw",minHeight:"250px",display:"flex",flexFlow:"column"}},React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h1",{id:"novel-title",className:"title",style:{margin:0,paddingRight:"10px"}},t.title),React.createElement("a",{onClick:a=>{const r=document.getElementById("novel-title");console.log("Update title"),s.openModal({modalType:"title",title:t.title},(a=>{const s=document.createElement("span");s.classList="bulma-loader-mixin",r.appendChild(s),n.sendPost("/editNovel",{novelID:t._id,title:a.title,_csrf:e.csrf},(e=>{console.log(e),e.error&&console.log(e.error),t.title=e.title,r.innerHTML=t.title}))}))},"data-modal-type":"title"},React.createElement("i",{className:"fa-solid fa-pencil"}))),React.createElement("h2",{className:"subtitle"},"By: ",t.author),React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h2",{className:"subtitle",style:{margin:0,paddingRight:"10px"}},"Abstract"),React.createElement("a",{onClick:a=>{document.getElementById("modal-textarea");const r=document.getElementById("abstract-text");s.openModal({modalType:"abstract",abstract:t.abstract},(a=>{const s=document.createElement("span");s.classList="bulma-loader-mixin",r.appendChild(s),n.sendPost("/editNovel",{novelID:t._id,abstract:a.abstract,_csrf:e.csrf},(e=>{e.error&&console.log(e.error),t.abstract=e.abstract,r.innerHTML=t.abstract}))}))},"data-modal-type":"abstract"},React.createElement("i",{className:"fa-solid fa-pencil"}))),React.createElement("div",{id:"abstract-text",style:{height:"100%",width:"100%",minHeight:"100px"}},t.abstract))),React.createElement("div",{className:"box"},React.createElement("ul",null,React.createElement("li",null,"Published Chapters: ",t.publishedChapterCount),React.createElement("li",null,"Unpublished Chapters: ",t.totalChapterCount-t.publishedChapterCount),React.createElement("li",null,"Created Date: ",d),React.createElement("li",null,"Published: ",a),React.createElement("li",null,"Publication Date: ",t.published))),React.createElement("hr",null),React.createElement("div",{style:{marginLeft:"20px",marginRight:"20px"}},React.createElement("div",{className:"tabs is-toggle"},React.createElement("ul",null,React.createElement("li",{id:"chapters-button-li",className:"is-active"},React.createElement("a",{id:"chapters-button",onClick:()=>{const t=document.getElementById("chapters-button-li"),a=document.getElementById("drafts-button-li");t.classList.add("is-active"),a.classList.remove("is-active"),c(e.chapters,e.csrf)}},"Chapters")),React.createElement("li",{id:"drafts-button-li"},React.createElement("a",{id:"drafts-button",onClick:()=>{const t=document.getElementById("chapters-button-li");document.getElementById("drafts-button-li").classList.add("is-active"),t.classList.remove("is-active"),i(e.chapters,e.csrf)}},"Drafts")))),React.createElement("div",{id:"chapters-heading",className:"columns",style:{width:"100%",cursor:"hand",display:"flex",justifyContent:"space-between",borderBottom:"thick solid"}},React.createElement("span",{id:"chapter-number",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Chapter"),React.createElement("span",{id:"chapter-title",className:"column is-three-fifths has-text-weight-bold"},"Title"),React.createElement("span",{id:"chapter-views",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Views"),React.createElement("span",{id:"chapter-publish",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Publish"),React.createElement("span",{id:"chapter-publish",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Delete")),React.createElement("div",{id:"chapters-div",style:{width:"100%",display:"flex",flexFlow:"column",gap:"20px"}}))))},l=e=>{const t=()=>{window.localStorage.setItem("partchment-editorChapterID",e.chapters[e.chapter]._id),window.location.assign("/editChapter")};let a="fa-solid fa-check",r="button is-outline";return e.chapters[e.chapter].published&&(a="fa-solid fa-minus",r="button is-warning"),React.createElement("div",{id:`${e.chapter}-row`,className:"columns",style:{width:"100%",cursor:"hand",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseEnter:()=>{document.getElementById(`${e.chapter}-row`).style.backgroundColor="#bbf0de"},onMouseLeave:()=>{document.getElementById(`${e.chapter}-row`).style.backgroundColor="#ffffff"}},React.createElement("span",{id:"chapter-number",className:"column",style:{textAlign:"center"},onClick:t},e.chapter),React.createElement("span",{id:"chapter-title",className:"column is-three-fifths",onClick:t},e.chapters[e.chapter].title),React.createElement("span",{id:"chapter-views",className:"column",style:{textAlign:"center"},onClick:t},e.chapters[e.chapter].views),React.createElement("span",{id:"chapter-publish",className:"column",style:{textAlign:"center"}},React.createElement("a",{id:"publish-button",className:r,onClick:()=>{console.log("publish chapter"),console.log(e),e.chapters[e.chapter].published?n.publishChapter("unpublish",{chapter:e.chapters[e.chapter],_csrf:e.csrf},(e=>{window.location="/editNovel"})):s.openModal({modalType:"publishChapter",chapter:e.chapters[e.chapter],csrf:e.csrf},(t=>{console.log("modal response"),console.log(t),n.publishChapter(t.mode,{chapter:t.chapter,referenceChapter:t.referenceChapter,_csrf:e.csrf},(e=>{window.location="/editNovel"}))}))}},React.createElement("i",{id:"publish-icon",className:a}))),React.createElement("span",{id:"chapter-publish",className:"column",style:{textAlign:"center"}},React.createElement("a",{id:"delete-button",className:"button is-danger",onClick:()=>{s.openModal({modalType:"deleteChapter",chapter:e.chapters[e.chapter],csrf:e.csrf},(t=>{n.sendPost("/deleteChapter",{chapterID:e.chapters[e.chapter]._id,_csrf:e.csrf},(e=>{console.log(e)}))}))}},React.createElement("i",{id:"delete-icon",className:"fa-solid fa-x"}))))},c=async(e,t)=>{const a=document.getElementById("chapters-div");if(a.innerHTML="",Object.keys(e).forEach((n=>{if(n.includes("chapter")){const r=document.createElement("div");ReactDOM.render(React.createElement(l,{chapter:n,chapters:e,csrf:t}),r),a.appendChild(r)}})),""===a.innerHTML){const e=document.createElement("div");e.innerText="No Published Chapters",a.appendChild(e)}},i=async(e,t)=>{const a=document.getElementById("chapters-div");if(a.innerHTML="",Object.keys(e).forEach((n=>{if(n.includes("draft")){const r=document.createElement("div");ReactDOM.render(React.createElement(l,{chapter:n,chapters:e,csrf:t}),r),a.appendChild(r)}})),""===a.innerHTML){console.log("empty");const e=document.createElement("div");e.innerText="No Drafts",a.appendChild(e)}};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log("init editNovel"),console.log(t);const a=localStorage.getItem("partchment-editorNovelID");if(!a)return console.log("No Novel Selected"),void window.location.assign("/create");n.sendPost("/searchNovelByID",{novelID:a,_csrf:t.csrfToken},(async e=>{console.log(e),"No Novel Found"===e.error&&window.location.assign("/create"),await(async(e,t,a)=>{if(console.log("get chapters"),e.chapters&&0!==Object.keys(e.chapters).length){const r=e.chapters;console.log("chapterIDs"),console.log(r);const s={};for(let e=0;e<Object.keys(r).length;e++){const o=Object.keys(r)[e];await n.sendPost("/searchChapterByID",{chapterID:r[o],_csrf:t},(t=>{if(s[o]=t.chapter,e+1>=Object.keys(r).length)return a(s),s}))}}else a({})})(e.novel,t.csrfToken,(a=>{console.log("chapters"),console.log(a),ReactDOM.render(React.createElement(o,{csrf:t.csrfToken,novel:e.novel,chapters:a}),document.getElementById("edit-novel-content")),c(a,t.csrfToken)}))}))}}},603:e=>{const t=async(e,t,n)=>{if(console.log(e),!t._csrf)return void console.log("Missing CSRF Token, request not sent");const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await r.json();a(s,t,n)},a=(e,t,a)=>{e.error&&console.log(`error: ${e.error}`),e.redirect&&(window.location=e.redirect),a&&(e.csrfToken=t._csrf,a(e))};e.exports={sendPost:t,sendMultipartPost:async(e,t,n)=>{const r=await fetch(e,{method:"POST",body:t.formData}),s=await r.json();a(s,t,n)},isDescendent:(e,t)=>{let a=t.parentNode;for(;a;){if(a===e)return!0;a=a.parentNode}return!1},publishChapter:(e,a,n)=>{const r={};switch(e){case"add-last":case"unpublish":r.chapterID=a.chapter._id,r.novelID=a.chapter.novelID,r.chapter=a.chapter.chapter,r.mode=e;break;case"replace":case"insert-before":case"insert-after":r.chapterID=a.chapter._id,r.novelID=a.chapter.novelID,r.chapter=a.chapter.chapter,r.mode=e,r.referenceChapter=a.referenceChapter;break;default:n("No Mode")}r._csrf=a._csrf,t("/publishChapter",r,n)}}},984:(e,t,a)=>{a(603);const n=a(764).lW,r=e=>{let t=1;const a=e=>{let a=document.getElementsByClassName("slide");if(!(t.length<1)){a.length<e&&(t=1),e<1&&(t=a.length);for(let e=0;e<a.length;e++)a[e].style.display="none";a[t-1].style.display="block"}};return React.createElement("div",{style:{minHeight:"90vh",width:"90vw",margin:"auto",marginTop:"20px"}},React.createElement("div",{className:"columns",style:{minHeight:"340px"}},React.createElement("div",{className:"column",style:{maxWidth:"1200px",margin:"auto"}},React.createElement("h1",{className:"title",style:{marginLeft:"10vw"}},"Featured Novels"),React.createElement("div",{id:"featured-carousel",style:{position:"relative"}},React.createElement("div",{id:"carousel-cards"}),React.createElement("a",{className:"prev",onClick:()=>{a(t+=1)}},"❮"),React.createElement("a",{className:"next",onClick:()=>{a(t-=1)}},"❯")))),React.createElement("div",{style:{maxWidth:"1000px",margin:"auto"}},React.createElement("h1",{className:"title"},"Novels"),React.createElement("div",{id:"novel-cards-container"})))},s=e=>{const t=e.novel;console.log("props"),console.log(e);const a=n.from(t.cover.data,"base64").toString("base64"),r=`data:${t.coverMime};base64,${a}`;return React.createElement("div",{id:`${t.title.replace(/ /g,"_")}-card`,className:"columns",style:{height:"calc(80vw * .333)",border:"thin ridge",margin:"auto",marginBottom:"20px",maxWidth:"1000px",maxHeight:"290px"}},React.createElement("div",{id:"cover-image-div",className:"column is-one-fifth"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:r}))),React.createElement("div",{className:"column is-four-fifths"},React.createElement("a",null,React.createElement("h1",{className:"title"},t.title)),React.createElement("h2",{className:"subtitle"},"By ",t.author),React.createElement("p",{style:{overflow:"hidden",textOverflow:"auto",height:"calc((80vw * .333) - 120px)"}},'"',t.abstract,'"')))},o=e=>{const t=e.novel,a=n.from(t.cover.data,"base64").toString("base64"),r=`data:${t.coverMime};base64,${a}`;return React.createElement("div",{id:`${t.title.replace(/ /g,"_")}-featured-card`,className:"columns",style:{height:"calc(70vw * .315)",border:"thin ridge",margin:"auto",maxWidth:"1200px",maxHeight:"290px"}},React.createElement("div",{id:"cover-image-div",className:"column"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:r}))),React.createElement("div",{className:"column is-four-fifths",style:{display:"flex",flexFlow:"column",height:"100%"}},React.createElement("a",null,React.createElement("h1",{className:"title"},t.title)),React.createElement("h2",{className:"subtitle"},"By ",t.author),React.createElement("p",{style:{display:"flex",overflow:"hidden",textOverflow:"ellipsis",height:"calc((70vw * .315) - 120px)"}},'"',t.abstract,'"')))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log(t),console.log("here"),ReactDOM.render(React.createElement(r,{csrf:t.csrfToken}),document.getElementById("home-content")),console.log("im here");const a=await fetch("/getAllNovels",{method:"GET"}),n=await a.json(),l=n;console.log("allNovels"),console.log(n),((e,t)=>{console.log("novels"),console.log(e);for(const a of e){const e=document.createElement("div");document.getElementById("novel-cards-container").appendChild(e),ReactDOM.render(React.createElement(s,{csrf:t,novel:a}),e);const n=document.getElementById(`${a.title.replace(/ /g,"_")}-card`);n.onmouseenter=()=>{n.style.backgroundColor="#bbf0de"},n.onmouseleave=()=>{n.style.backgroundColor="#ffffff"},n.onclick=()=>{localStorage.setItem("partchment-viewNovelID",a._id),localStorage.setItem("partchment-viewNovelBack","/home"),window.location.assign("/viewNovel")}}})(n,t.csrfToken),((e,t)=>{console.log("featured novels"),console.log(e);for(let a=0;a<Object.keys(e).length;a++){const n=Object.values(e)[a];console.log("featured novel"),console.log(n);const r=document.createElement("div");r.className=`item-${a+1} slide`,r.style.display=0===a?"block":"none",document.getElementById("carousel-cards").appendChild(r),ReactDOM.render(React.createElement(o,{csrf:t,novel:n}),r);const s=document.getElementById(`${n.title.replace(/ /g,"_")}-featured-card`);s.onmouseenter=()=>{s.style.backgroundColor="#bbf0de"},s.onmouseleave=()=>{s.style.backgroundColor="#ffffff"},s.onclick=()=>{localStorage.setItem("partchment-viewNovelID",n._id),localStorage.setItem("partchment-viewNovelBack","/home"),window.location.assign("/viewNovel")}}})(l,t.csrfToken),console.log(document.getElementById("home-content"))}}},911:(e,t,a)=>{a(603);const n=a(764).lW,r=e=>React.createElement("div",{id:"shelves"}),s=e=>{novel=e.novel,console.log("novel"),console.log(novel);const t=n.from(e.novel.cover,"base64").toString("base64"),a=`data:${e.novel.coverMime};base64,${t}`,r=150*e.n;return console.log(r),React.createElement("div",{className:"novel-card","data-card-number":e.n,"data-card-id":e.novel._id,style:{width:150,position:"absolute",bottom:"0px",left:`${r}px`},onMouseEnter:t=>{const a=document.getElementById(`${e.novel.title}-title`);a.classList.add("is-size-4"),a.classList.remove("is-size-5"),t.currentTarget.style.width=200;const n=document.querySelectorAll(".novel-card");for(const t of n)t.getAttribute("data-card-number")>e.n&&(t.style.left=150*t.getAttribute("data-card-number")+50)},onMouseLeave:t=>{const a=document.getElementById(`${e.novel.title}-title`);a.classList.add("is-size-5"),a.classList.remove("is-size-4"),t.currentTarget.style.width=150;const n=document.querySelectorAll(".novel-card");for(const t of n)t.getAttribute("data-card-number")>e.n&&(t.style.left=150*t.getAttribute("data-card-number"))},onClick:e=>{console.log(`Card clicked: ${e.currentTarget}`);const t=e.currentTarget.getAttribute("data-card-id");localStorage.setItem("partchment-viewNovelID",t),localStorage.setItem("partchment-viewNovelBack","/library"),window.location.assign("/viewNovel")}},React.createElement("div",{className:"card"},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${e.novel.title}-img`,src:a,alt:"Placeholder image"})))),React.createElement("h1",{id:`${e.novel.title}-title`,className:"is-size-5 has-text-left has-text-grey-dark",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.novel.title),React.createElement("h2",{className:"is-size-6 has-text-left has-text-grey"},novel.author))},o=e=>{const t=document.getElementById("shelves"),a=document.createElement("h1");a.innerText=e.title,a.className="title",a.style.paddingBottom="0px",a.style.marginBottom="0px";const n=document.createElement("div");n.style.display="flex",n.style.flexFlow="no-wrap",n.style.gap="10px",n.style.overflowX="auto",n.style.paddingLeft="10px",n.style.paddingRight="10px",n.style.paddingTop="5px",n.style.paddingBottom="20px",n.style.borderBottom="thick solid",n.style.position="relative",n.style.height="400px";let r=0;for(const t of Object.values(e))if(t._id){const e=document.createElement("div");e.style.position="relative",ReactDOM.render(React.createElement(s,{novel:t,n:r}),e),n.appendChild(e),r++}t.appendChild(a),t.appendChild(n)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();libraryReponse=await fetch("/getMyLibrary"),myLibrary=await libraryReponse.json(),console.log(myLibrary),ReactDOM.render(React.createElement(r,{csrf:t.csrfToken}),document.getElementById("library-content"));for(const e of myLibrary)o(e)}}},316:(e,t,a)=>{const n=a(603),r=e=>{e.preventDefault();const t=e.target.querySelector("#user").value,a=e.target.querySelector("#pass").value,r=e.target.querySelector("#_csrf").value;return t&&a?(n.sendPost(e.target.action,{username:t,pass:a,_csrf:r}),!1):(e.target.querySelector("#login-error-span").innerHTML="Username or password is empty!",!1)},s=e=>{e.preventDefault();const t=e.target.querySelector("#user").value,a=e.target.querySelector("#pass").value,r=e.target.querySelector("#pass2").value,s=e.target.querySelector("#_csrf").value;return t&&a&&r?a!==r?(e.target.querySelector("#signup-error-span").innerHTML="Passwords do not match!",!1):(n.sendPost(e.target.action,{username:t,pass:a,pass2:r,_csrf:s}),!1):(e.target.querySelector("#signup-error-span").innerHTML="Username or password is empty!",!1)},o=e=>(console.log("login window"),console.log(e),React.createElement("form",{id:"loginForm",name:"loginForm",onSubmit:r,action:"/login",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Login")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"username"},"Username: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"user",type:"text",name:"username",placeholder:"Username"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fas fa-user"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass",type:"password",name:"pass",placeholder:"Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"login-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Sign in"})))),l=e=>(authenticateUsername=async t=>{const a=t.currentTarget;console.log("signup window - authenitcate username"),console.log(e),await n.sendPost("/isUsernameAvailable",{username:t.currentTarget.value,_csrf:e.csrf},(e=>{let t=a.parentElement,n=t.querySelector("#username-success-icon"),r=t.parentElement.querySelector("#isAvailable");e.found?(n.innerHTML='<i class="fa-solid fa-exclamation"></i>',r.innerHTML="This username is taken",r.classList="help is-danger"):(n.innerHTML='<i class="fas fa-check"></i>',r.innerHTML="This username is available",r.classList="help is-success")}))},React.createElement("form",{id:"signupForm",name:"signupForm",onSubmit:s,action:"/signup",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Sign Up")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"username"},"Username: "),React.createElement("div",{className:"control has-icons-left has-icons-right"},React.createElement("input",{className:"input",id:"user",type:"text",name:"username",placeholder:"Username",onChange:authenticateUsername}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fas fa-user"})),React.createElement("span",{id:"username-success-icon",className:"icon is-small is-right"})),React.createElement("p",{id:"isAvailable",className:"help is-success"})),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass",type:"password",name:"pass",placeholder:"Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass2"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass2",type:"password",name:"pass",placeholder:"Retype Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"signup-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Sign Up"}))));e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log("init login"),console.log(t),ReactDOM.render(React.createElement(o,{csrf:t.csrfToken}),document.getElementById("login-content"))},renderLoginWindow:async e=>{ReactDOM.render(React.createElement(o,{csrf:e.csrf}),document.getElementById("login-content"))},renderSignUpWindow:async e=>{console.log("render signup window"),console.log(e),console.log(e._csrf),ReactDOM.render(React.createElement(l,{csrf:e._csrf}),document.getElementById("login-content"))}}},441:(e,t,a)=>{const n=a(603);let r;fillChangePasswordModal=()=>{const e=e=>React.createElement("div",null,React.createElement("div",{className:"title"},React.createElement("h1",null,"Change Password")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"oldPass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{id:"oldPass",className:"input",type:"password",name:"oldPass",placeholder:" Old Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"newPass1"},"New Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{id:"newPass1",className:"input",type:"password",name:"newPass1",placeholder:"Enter New Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"newPass2"},"New Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{id:"newPass2",className:"input",type:"password",name:"newPass2",placeholder:"Retype Password",onInput:()=>{const e=document.getElementById("modal-save-button"),t=document.getElementById("newPass1"),a=document.getElementById("newPass2"),n=document.getElementById("change-pass-error-span");t.value!=a.value&&""!==a.value?(n.innerText="New Passwords Must Match",e.disabled=!0):(n.innerText="",e.disabled=!1)}}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("span",{id:"change-pass-error-span",className:"has-text-danger"})),t=document.getElementById("modal-card-body"),a=document.createElement("div");ReactDOM.render(React.createElement(e,null),a),t.appendChild(a)},e.exports={openModal:(e,t)=>{console.log("data"),console.log(e);const a=e.modalType,o=document.getElementById("modal"),l=document.getElementById("modal-card-body");l.innerHTML="";const c=document.getElementById("modal-save-button");c.disabled=!1;const i=document.getElementById("modal-title");switch(a){case"abstract":const a=e=>React.createElement("textarea",{id:"modal-textarea",className:"textarea has-fixed-size",placeholder:"Add a description...",rows:"15",defaultValue:e.value});c.removeEventListener("click",r);const o=()=>{t({abstract:document.getElementById("modal-textarea").value})};r=o,c.addEventListener("click",o),i.innerHTML="Abstract";const u=document.createElement("div");ReactDOM.render(React.createElement(a,{value:e.abstract}),u),l.appendChild(u);break;case"title":const p=e=>React.createElement("textarea",{id:"modal-textarea",className:"textarea has-fixed-size",placeholder:"Add a description...",rows:"1",defaultValue:e.value});c.removeEventListener("click",r);const h=()=>{t({title:document.getElementById("modal-textarea").value})};r=h,c.addEventListener("click",h),i.innerHTML="Title";const f=document.createElement("div");ReactDOM.render(React.createElement(p,{value:e.title}),f),l.appendChild(f);break;case"publishChapter":const g=e=>React.createElement("div",null,React.createElement("a",{className:"button is-link",onClick:()=>{t({mode:"add-last"})}},"Publish As Latest Chapter"),React.createElement("p",{className:"subtitle"},"Or, Choose where to add it:"),React.createElement("div",{id:"modal-chapter-div",style:{border:"thin ridge",minHeight:"400px",overflowY:"auto"}}));c.removeEventListener("click",r);const y=()=>{console.log("yes clicked"),document.getElementById("modal-chapter-div").querySelectorAll("span").forEach((a=>{if("true"===a.getAttribute("data-selected")){const n=a.parentElement.querySelector("#chap-option").querySelector("p").innerText;if("chap-option"===a.id)return void t({chapter:e.chapter,referenceChapter:n,mode:"replace"});if("chap-insert"===a.id){if("before"==a.getAttribute("data-insert"))return void t({chapter:e.chapter,referenceChapter:n,mode:"insert-before"});if("after"==a.getAttribute("data-insert"))return void t({chapter:e.chapter,referenceChapter:n,mode:"insert-after"})}}}))};r=y,c.addEventListener("click",y),i.innerHTML="Publish Chapter";const b=document.createElement("div");ReactDOM.render(React.createElement(g,{value:e.title}),b),l.appendChild(b),d=e.chapter,m=e.csrf,n.sendPost("/searchNovelByID",{novelID:d.novelID,_csrf:m},(e=>{console.log("novel response"),console.log(e);const t=[];Object.keys(e.novel.chapters).forEach((e=>{e.includes("chapter-")&&t.push(e)}));const a=document.getElementById("modal-chapter-div"),n=document.getElementById("modal-save-button"),r=e=>{const t=e=>{let t="true"===e.getAttribute("data-selected");a.querySelectorAll("#chap-option-container").forEach((e=>{e.setAttribute("data-selected","false")}));let n=!1;e.childNodes.forEach((e=>{"true"===e.getAttribute("data-selected")&&(n=!0)})),t&&!n||e.setAttribute("data-selected","true")},r=e=>{let n="true"===e.currentTarget.getAttribute("data-selected");a.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),a.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),n||e.currentTarget.setAttribute("data-selected","true"),t(e.currentTarget.parentElement),l(e.currentTarget.parentElement)},s=e=>{e.currentTarget.style.height="40px",e.currentTarget.style.backgroundColor="#c2f542",e.currentTarget.querySelector("p").style.fontSize="20px"},o=e=>{"true"===e.currentTarget.getAttribute("data-selected")?(e.currentTarget.style.height="40px",e.currentTarget.style.backgroundColor="#62c462",e.currentTarget.querySelector("p").style.fontSize="20px"):"true"===e.target.parentElement.getAttribute("data-selected")?(e.currentTarget.style.height="40px",e.currentTarget.style.backgroundColor="#42cbf5",e.currentTarget.querySelector("p").style.fontSize="20px"):(e.currentTarget.style.height="30px",e.currentTarget.style.backgroundColor="#bbf0de",e.currentTarget.querySelector("p").style.fontSize="17px")},l=e=>{e.querySelectorAll("span").forEach((e=>{var t;"true"===(t=e).getAttribute("data-selected")?(t.style.height="40px",t.style.backgroundColor="#62c462",t.querySelector("p").style.fontSize="20px"):"true"===t.parentElement.getAttribute("data-selected")?(t.style.height="40px",t.style.backgroundColor="#42cbf5",t.querySelector("p").style.fontSize="20px"):(t.style.height="30px",t.style.backgroundColor="#bbf0de",t.querySelector("p").style.fontSize="17px")}))};return React.createElement("div",{id:"chap-option-Container","data-selected":"false",onClick:e=>{}},React.createElement("span",{id:"chap-insert",className:"has-text-grey","data-selected":"false","data-insert":"before",style:{visibility:"hidden",display:"none",height:"30px",gap:"10px",alignItems:"center",border:"thin ridge",backgroundColor:"#bbf0de"},onClick:r,onMouseEnter:s,onMouseLeave:o},React.createElement("i",{className:"fa-solid fa-arrow-up",style:{userSelect:"none"}}),React.createElement("p",{style:{userSelect:"none"}},"insert before")),React.createElement("span",{id:"chap-option",className:"has-text-grey","data-selected":"false",style:{border:"thin ridge",display:"flex",alignItems:"center",gap:"10px",height:"30px",backgroundColor:"#bbf0de"},onClick:e=>{let r="true"===e.currentTarget.getAttribute("data-selected");a.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false"),e.style.height="30px",e.style.backgroundColor="#bbf0de",e.style.fontSize="17px"})),a.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false"),e.style.visibility="hidden",e.style.display="none"})),r?n.disabled=!0:(e.currentTarget.setAttribute("data-selected","true"),e.currentTarget.parentElement.querySelectorAll("#chap-insert").forEach((e=>{e.style.visibility="visible",e.style.display="flex"})),n.disabled=!1),t(e.currentTarget.parentElement),l(e.currentTarget.parentElement)},onMouseEnter:s,onMouseLeave:o},React.createElement("i",{className:"fa-solid fa-repeat",style:{userSelect:"none"}}),React.createElement("p",{style:{fontSize:"17px",userSelect:"none"}},e.chapter)),React.createElement("span",{id:"chap-insert",className:"has-text-grey","data-selected":"false","data-insert":"after",style:{visibility:"hidden",display:"none",height:"30px",gap:"10px",alignItems:"center",border:"thin ridge",backgroundColor:"#bbf0de"},onClick:r,onMouseEnter:s,onMouseLeave:o},React.createElement("i",{className:"fa-solid fa-arrow-down",style:{userSelect:"none"}}),React.createElement("p",{style:{userSelect:"none"}},"insert after")))};for(const e of t){const t=document.createElement("div");ReactDOM.render(React.createElement(r,{chapter:e}),t),a.appendChild(t)}if(console.log(a),""===a.innerText){const e=document.createElement("p");e.innerText="This is the first chapter!",a.appendChild(e)}}));break;case"deleteChapter":console.log("delete chapter"),c.removeEventListener("click",r);const E=()=>{c.innerText="Save",c.className="button is-primary",t()};r=E,c.addEventListener("click",E),c.innerText="Delete",c.className="button is-danger",i.innerHTML="Delete Chapter",l.innerText="Are You Sure you want to delete this chapter?";break;case"changePassword":c.disabled=!0,c.removeEventListener("click",r);const v=()=>{const e=document.getElementById("oldPass"),a=document.getElementById("newPass1"),n=document.getElementById("newPass2");t({oldPass:e.value,newPass1:a.value,newPass2:n.value})};r=v,c.addEventListener("click",v),i.innerHTML="Change Password",fillChangePasswordModal();break;default:console.log("no specified modal type"),s}var d,m;o.classList.add("is-active")},closeModal:()=>{document.getElementById("modal").classList.remove("is-active")},closeAllModals:e=>{(document.querySelectorAll(".modal")||[]).forEach((e=>{e.classList.remove("is-active")}))}}},856:e=>{const t=()=>{const e=document.querySelector("header").getAttribute("data-current-page");Array.from(document.querySelector(".navbar-start").children).concat(Array.from(document.querySelector(".navbar-end").children)).forEach((t=>{if(t.id===e)if("login"===e){const e=document.querySelector("#login"),t=document.querySelector("#signup");document.querySelector("#loginForm")?(e.classList="navbar-item is-tab is-active",t.classList="navbar-item is-tab"):(e.classList="navbar-item is-tab",t.classList="navbar-item is-tab is-active")}else t.classList="navbar-item is-tab is-active";else"signup"===t.id||(t.classList="navbar-item is-tab")}))};e.exports={Navbar:()=>React.createElement("nav",{className:"navbar is-dark has-shadow"},React.createElement("div",{className:"navbar-brand"},React.createElement("a",{className:"navbar-item",href:"/"},React.createElement("i",{className:"fa-solid fa-scroll"})),React.createElement("a",{className:"navbar-burger",id:"burger",onClick:e=>{e.preventDefault();try{let t=e.currentTarget.parentElement.parentElement.querySelector("#nav-links");e.currentTarget.classList.toggle("is-active"),t.classList.toggle("is-active")}catch(e){console.log(e)}}},React.createElement("span",null),React.createElement("span",null),React.createElement("span",null))),React.createElement("div",{className:"navbar-menu",id:"nav-links"},React.createElement("div",{className:"navbar-start"},React.createElement("a",{id:"home",className:"navbar-item is-tab",href:"/home"},"Home"),React.createElement("a",{id:"create",className:"navbar-item is-tab",href:"/create"},"Create"),React.createElement("a",{id:"library",className:"navbar-item is-tab",href:"/library"},"Library")),React.createElement("div",{className:"navbar-end"},React.createElement("a",{id:"login",className:"navbar-item is-tab",onClick:t},"Login"),React.createElement("a",{id:"signup",className:"navbar-item is-tab",onClick:t},"Sign Up"),React.createElement("a",{id:"signout",className:"navbar-item is-tab"},"Sign Out"),React.createElement("a",{id:"profile",className:"navbar-item is-tab",href:"/profile"},React.createElement("i",{className:"fa-solid fa-user"}))))),initializeNavbar:async(e,a)=>{let n=await fetch("/isLoggedIn"),r=await n.json();t();let s=document.getElementById("signout"),o=document.getElementById("profile"),l=document.getElementById("signup"),c=document.getElementById("login");if(r.loggedIn)s.style.display="flex",o.style.display="flex",l.style.display="none",c.style.display="none",s.addEventListener("click",(async e=>{e.preventDefault();let t=await fetch("/logout");window.localStorage.setItem("partchment-LoadSignUp",!1),window.location.assign(t.url)}));else{s.style.display="none",o.style.display="none",l.style.display="flex",c.style.display="flex";let t=!1;null!=document.getElementById("login-content")&&(t=!0),c.addEventListener("click",(async n=>{if(n.preventDefault(),t)return await e.renderLoginWindow({_csrf:a}),!1;{let e=await fetch("/login");return window.localStorage.setItem("partchment-LoadSignUp",!1),window.location.assign(e.url),!1}})),l.addEventListener("click",(async n=>{if(n.preventDefault(),t)return await e.renderSignUpWindow({_csrf:a}),!1;{let e=await fetch("/login");return window.localStorage.setItem("partchment-LoadSignUp",!0),window.location.assign(e.url),!1}}))}},updateSelectedPage:t}},493:e=>{const t=e=>React.createElement("div",{style:{width:"100vw",margin:"auto"}},React.createElement("span",{style:{margin:"auto",alignSelf:"center"}},React.createElement("h1",{className:"title"},"Page Not Found.")));e.exports={init:async()=>{const e=await fetch("/getToken"),a=await e.json();console.log(a),ReactDOM.render(React.createElement(t,{csrf:a.csrfToken}),document.getElementById("not-found-content"))}}},333:(e,t,a)=>{const n=a(441),r=a(603),s=e=>{const t=new Date(e.account.createdDate).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal"},React.createElement("div",{className:"modal-background",onClick:n.closeAllModals}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:n.closeModal})),React.createElement("section",{id:"modal-card-body",className:"modal-card-body"}),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-save-button",className:"button is-success",onClick:n.closeModal},"Save changes"),React.createElement("button",{className:"button",onClick:n.closeModal},"Cancel")))),React.createElement("div",{style:{width:"90vw",minHeight:"90vh",margin:"auto",position:"relative"}},React.createElement("h1",{className:"title"},"Profile"),React.createElement("h2",{className:"subtitle"},"Username: ",e.account.username),React.createElement("h2",{className:"subtitle"},"User Id: ",e.account._id),React.createElement("h2",{className:"subtitle"},"Account Created: ",t),React.createElement("div",{style:{position:"absolute",bottom:"0px",width:"100vw",marginBottom:"30px"}},React.createElement("div",{id:"buttons",style:{display:"flex",flexFlow:"row",gap:"20px",justifyContent:"center"}},React.createElement("a",{id:"premium-button",className:"button is-primary",onClick:async e=>{console.log("acitvate premium"),"Activate Premium"===e.currentTarget.innerText?(premiumResponse=await fetch("/activatePremium"),await premiumResponse.json()):(premiumResponse=await fetch("/deactivatePremium"),await premiumResponse.json()),o()}},"Activate Premium"),React.createElement("a",{id:"change-password-button",className:"button is-warning",onClick:()=>{console.log("change password"),n.openModal({modalType:"changePassword"},(t=>{console.log(t),r.sendPost("/changePassword",{oldPass:t.oldPass,newPass1:t.newPass1,newPass2:t.newPass2,_csrf:e.csrf},(e=>{"success"===e.message&&(document.getElementById("message-span").innerText="Password Changed Successfully")}))}))}},"Change Password")),React.createElement("div",{style:{margin:"auto",width:"100%",minHeight:"1.5",display:"flex",justifyContent:"center"}},React.createElement("span",{id:"message-span",className:"has-text-success"})))))},o=async()=>{const e=document.getElementById("premium-button");premiumResponse=await fetch("/isPremium"),await premiumResponse.json()?(e.className="button is-danger",e.innerText="Deactivate Premium"):(e.className="button is-primary",e.innerText="Activate Premium")};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();loggedInAsResponse=await fetch("/getLoggedInAs"),myAccount=await loggedInAsResponse.json(),console.log(myAccount),ReactDOM.render(React.createElement(s,{account:myAccount,csrf:t.csrfToken}),document.getElementById("profile-content")),o()}}},112:(e,t,a)=>{const n=a(603),r=e=>React.createElement("div",null,React.createElement("div",{id:"bannerDiv"}),React.createElement("div",{style:{margin:"20px"}},React.createElement("div",{id:"chapter-content",style:{border:"solid thick",minHeight:"80vh",padding:"20px",maxWidth:"1000px",margin:"auto"}})),React.createElement("div",{id:"bannerDiv",style:{width:"100vw",margin:"auto"}})),s=e=>React.createElement("img",{src:"/assets/img/AddBanner.png",style:{margin:"auto"}}),o=e=>React.createElement("div",{style:{minHeight:"80vh",position:"relative"}},React.createElement("h1",{className:"title is-size-2"},"Chapter ",e.chapterNumber,": ",e.title),React.createElement("div",{id:"chapter-content-div",style:{paddingBottom:"80px"}}),React.createElement("div",{id:"changeChapter",style:{display:"flex",width:"100%",justifyContent:"center",textAlign:"center",position:"absolute",bottom:"10px"}},React.createElement("span",{className:"previousChapter",onClick:()=>{const t=e.chapterNumber-1;n.sendPost("/setChapterNumber",{novelID:e.novelID,chapterNumber:t,_csrf:e.csrf},(t=>{"There are no more chapters"===t.error||"You cannot view a chapter with a negative index"===t.error||t.error?console.log(t.error):(l(e.csrf),c())}))}},"❮"),React.createElement("h2",{style:{fontWeight:"bold"}},"~-~  End Chapter  ~-~"),React.createElement("span",{className:"nextChapter",onClick:()=>{const t=e.chapterNumber+1;n.sendPost("/setChapterNumber",{novelID:e.novelID,chapterNumber:t,_csrf:e.csrf},(t=>{"There are no more chapters"===t.error||"You cannot view a chapter with a negative index"===t.error||t.error?console.log(t.error):(l(e.csrf),c())}))}},"❯"))),l=async e=>{const t=localStorage.getItem("partchment-readNovel");await n.sendPost("/getChapterNumber",{novelID:t,_csrf:e},(a=>{console.log(a),n.sendPost("/searchChapterNumber",{novelID:t,chapterNumber:a,_csrf:e},(t=>{console.log("chapterResponse"),console.log(t);const n=document.getElementById("chapter-content");n.innerHTML="";const r=document.createElement("div");ReactDOM.render(React.createElement(o,{chapterNumber:a,title:t.title,novelID:t.novelID,csrf:e}),r),n.appendChild(r),document.getElementById("chapter-content-div").innerHTML=t.content}))}))},c=async()=>{const e=await fetch("/getLoggedInAs"),t=await e.json();console.log("account"),console.log(t),t.premium||document.querySelectorAll("#bannerDiv").forEach((e=>{e.innerHTML="";const t=document.createElement("div");t.style.display="flex",t.style.justifyContent="center",ReactDOM.render(React.createElement(s,null),t),e.appendChild(t)}))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log(t),ReactDOM.render(React.createElement(r,{csrf:t.csrfToken}),document.getElementById("read-novel-content")),await l(t.csrfToken),await c()}}},841:(e,t,a)=>{const n=a(603),r=a(764).lW,s=e=>{const t=e.novel;console.log("novel"),console.log(t);const a=r.from(t.cover.data,"base64").toString("base64"),s=`data:${t.coverMime};base64,${a}`,l=new Date(t.createdDate).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return React.createElement("div",null,React.createElement("div",{className:"",style:{height:65,width:"100vw",margin:"auto",border:"thin ridge",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",{className:""},React.createElement("a",{className:"button is-white",onClick:()=>{const e=localStorage.getItem("partchment-viewNovelBack");window.location=e||"/"}},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back"))),React.createElement("div",{className:"box",style:{width:"100vw",margin:"auto",padding:0}},React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{width:"95vw",margin:"auto"}},React.createElement("div",{className:"column",style:{maxWidth:"300px",margin:"auto"}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${t.title}-img`,src:s,alt:"Placeholder image"}))),React.createElement("div",{className:"column is-three-quarters",style:{height:"34.35vw",minHeight:"250px",display:"flex",flexFlow:"column"}},React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h1",{id:"novel-title",className:"title",style:{margin:0,paddingRight:"10px"}},t.title)),React.createElement("h2",{className:"subtitle"},"By: ",t.author),React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h2",{className:"subtitle",style:{margin:0,paddingRight:"10px"}},"Abstract")),React.createElement("div",{id:"abstract-text",style:{height:"100%",width:"100%",minHeight:"100px"}},t.abstract))),React.createElement("div",{className:"box"},React.createElement("ul",null,React.createElement("li",null,"Published Chapters: ",t.publishedChapterCount),React.createElement("li",null,"Unpublished Chapters: ",t.totalChapterCount-t.publishedChapterCount),React.createElement("li",null,"Created Date: ",l),React.createElement("li",null,"Published: ",t.published.toString()))),React.createElement("div",{style:{paddingBottom:"20px",display:"flex",justifyContent:"space-evenly",position:"relative"}},React.createElement("a",{id:"library-button",className:"button is-outline","data-add-remove":"add",onClick:async a=>{const r=t._id;console.log("added novel"),console.log(r),"add"==document.getElementById("library-button").getAttribute("data-add-remove")?await n.sendPost("/addNovelToLibrary",{novelID:r,_csrf:e.csrf},(e=>{console.log(e),o(r)})):await n.sendPost("/removeNovelFromLibrary",{novelID:r,_csrf:e.csrf},(e=>{console.log(e),o(r)}))}},React.createElement("span",{style:{display:"flex",gap:"10px",alignItems:"center"}},React.createElement("i",{className:"fa-solid fa-plus"}),"add to library")),React.createElement("a",{className:"button is-link","data-novel-id":t._id,onClick:async e=>{console.log("start reading"),localStorage.setItem("partchment-readNovel",t._id),window.location="/readNovel"}},React.createElement("span",{style:{display:"flex",gap:"10px",alignItems:"center"}},React.createElement("i",{className:"fa-solid fa-book-open-reader"}),"Start Reading")))))},o=async e=>{libraryReponse=await fetch("/getMyLibrary"),myLibrary=await libraryReponse.json(),console.log("myLibrary"),console.log(myLibrary);let t=!1;for(const a of Object.keys(myLibrary[0]))a.toString()===e&&(t=!0);const a=document.getElementById("library-button");a.innerHTML="";const n=document.createElement("span");if(n.style.display="flex",n.style.gap="10px",n.style.alignItems="center",t){const e=document.createElement("i");e.className="fa-solid fa-minus";const t=document.createTextNode("remove from library");n.appendChild(e),n.appendChild(t),a.classList.remove("is-outlined"),a.classList.add("is-danger"),a.setAttribute("data-add-remove","remove")}else{const e=document.createElement("i");e.className="fa-solid fa-plus";const t=document.createTextNode("add to library");n.appendChild(e),n.appendChild(t),a.classList.add("is-outlined"),a.classList.remove("is-danger"),a.setAttribute("data-add-remove","add")}a.appendChild(n)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log(t),novelID=localStorage.getItem("partchment-viewNovelID"),console.log("novelID"),console.log(novelID),novelID||(window.location="/"),n.sendPost("/searchNovelByID",{_csrf:t.csrfToken,novelID},(e=>{ReactDOM.render(React.createElement(s,{novel:e.novel,csrf:t.csrfToken}),document.getElementById("view-novel-content")),o(novelID)}))}}},742:(e,t)=>{"use strict";t.byteLength=function(e){var t=c(e),a=t[0],n=t[1];return 3*(a+n)/4-n},t.toByteArray=function(e){var t,a,s=c(e),o=s[0],l=s[1],i=new r(function(e,t,a){return 3*(t+a)/4-a}(0,o,l)),d=0,m=l>0?o-4:o;for(a=0;a<m;a+=4)t=n[e.charCodeAt(a)]<<18|n[e.charCodeAt(a+1)]<<12|n[e.charCodeAt(a+2)]<<6|n[e.charCodeAt(a+3)],i[d++]=t>>16&255,i[d++]=t>>8&255,i[d++]=255&t;return 2===l&&(t=n[e.charCodeAt(a)]<<2|n[e.charCodeAt(a+1)]>>4,i[d++]=255&t),1===l&&(t=n[e.charCodeAt(a)]<<10|n[e.charCodeAt(a+1)]<<4|n[e.charCodeAt(a+2)]>>2,i[d++]=t>>8&255,i[d++]=255&t),i},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],o=16383,l=0,c=n-r;l<c;l+=o)s.push(i(e,l,l+o>c?c:l+o));return 1===r?(t=e[n-1],s.push(a[t>>2]+a[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"=")),s.join("")};for(var a=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)a[o]=s[o],n[s.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");return-1===a&&(a=t),[a,a===t?0:4-a%4]}function i(e,t,n){for(var r,s,o=[],l=t;l<n;l+=3)r=(e[l]<<16&16711680)+(e[l+1]<<8&65280)+(255&e[l+2]),o.push(a[(s=r)>>18&63]+a[s>>12&63]+a[s>>6&63]+a[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},764:(e,t,a)=>{"use strict";const n=a(742),r=a(645),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=c,t.h2=50;const o=2147483647;function l(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,a){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return m(e)}return i(e,t,a)}function i(e,t,a){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const a=0|f(e,t);let n=l(a);const r=n.write(e,t);return r!==a&&(n=n.slice(0,r)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return p(e,t,a);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return p(e,t,a);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,a);const r=function(e){if(c.isBuffer(e)){const t=0|h(e.length),a=l(t);return 0===a.length||e.copy(a,0,0,t),a}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?l(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function m(e){return d(e),l(e<0?0:0|h(e))}function u(e){const t=e.length<0?0:0|h(e.length),a=l(t);for(let n=0;n<t;n+=1)a[n]=255&e[n];return a}function p(e,t,a){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(a||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),Object.setPrototypeOf(n,c.prototype),n}function h(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const a=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===a)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return G(e).length;default:if(r)return n?-1:Y(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,a){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if((a>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,a);case"utf8":case"utf-8":return I(this,t,a);case"ascii":return T(this,t,a);case"latin1":case"binary":return B(this,t,a);case"base64":return C(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,a);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,a){const n=e[t];e[t]=e[a],e[a]=n}function b(e,t,a,n,r){if(0===e.length)return-1;if("string"==typeof a?(n=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),K(a=+a)&&(a=r?0:e.length-1),a<0&&(a=e.length+a),a>=e.length){if(r)return-1;a=e.length-1}else if(a<0){if(!r)return-1;a=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:E(e,t,a,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):E(e,[t],a,n,r);throw new TypeError("val must be string, number or Buffer")}function E(e,t,a,n,r){let s,o=1,l=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,l/=2,c/=2,a/=2}function i(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){let n=-1;for(s=a;s<l;s++)if(i(e,s)===i(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(a+c>l&&(a=l-c),s=a;s>=0;s--){let a=!0;for(let n=0;n<c;n++)if(i(e,s+n)!==i(t,n)){a=!1;break}if(a)return s}return-1}function v(e,t,a,n){a=Number(a)||0;const r=e.length-a;n?(n=Number(n))>r&&(n=r):n=r;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(K(n))return o;e[a+o]=n}return o}function w(e,t,a,n){return V(Y(t,e.length-a),e,a,n)}function R(e,t,a,n){return V(function(e){const t=[];for(let a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}(t),e,a,n)}function N(e,t,a,n){return V(G(t),e,a,n)}function x(e,t,a,n){return V(function(e,t){let a,n,r;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)a=e.charCodeAt(o),n=a>>8,r=a%256,s.push(r),s.push(n);return s}(t,e.length-a),e,a,n)}function C(e,t,a){return 0===t&&a===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,a))}function I(e,t,a){a=Math.min(e.length,a);const n=[];let r=t;for(;r<a;){const t=e[r];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(r+o<=a){let a,n,l,c;switch(o){case 1:t<128&&(s=t);break;case 2:a=e[r+1],128==(192&a)&&(c=(31&t)<<6|63&a,c>127&&(s=c));break;case 3:a=e[r+1],n=e[r+2],128==(192&a)&&128==(192&n)&&(c=(15&t)<<12|(63&a)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:a=e[r+1],n=e[r+2],l=e[r+3],128==(192&a)&&128==(192&n)&&128==(192&l)&&(c=(15&t)<<18|(63&a)<<12|(63&n)<<6|63&l,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),r+=o}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let a="",n=0;for(;n<t;)a+=String.fromCharCode.apply(String,e.slice(n,n+=k));return a}(n)}c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,a){return i(e,t,a)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,a){return function(e,t,a){return d(e),e<=0?l(e):void 0!==t?"string"==typeof a?l(e).fill(t,a):l(e).fill(t):l(e)}(e,t,a)},c.allocUnsafe=function(e){return m(e)},c.allocUnsafeSlow=function(e){return m(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let a=e.length,n=t.length;for(let r=0,s=Math.min(a,n);r<s;++r)if(e[r]!==t[r]){a=e[r],n=t[r];break}return a<n?-1:n<a?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let a;if(void 0===t)for(t=0,a=0;a<e.length;++a)t+=e[a].length;const n=c.allocUnsafe(t);let r=0;for(a=0;a<e.length;++a){let t=e[a];if(J(t,Uint8Array))r+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,r)):Uint8Array.prototype.set.call(n,t,r);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,r)}r+=t.length}return n},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const a=t.h2;return e=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,a,n,r){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||a>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=a)return 0;if(n>=r)return-1;if(t>=a)return 1;if(this===e)return 0;let s=(r>>>=0)-(n>>>=0),o=(a>>>=0)-(t>>>=0);const l=Math.min(s,o),i=this.slice(n,r),d=e.slice(t,a);for(let e=0;e<l;++e)if(i[e]!==d[e]){s=i[e],o=d[e];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},c.prototype.indexOf=function(e,t,a){return b(this,e,t,a,!0)},c.prototype.lastIndexOf=function(e,t,a){return b(this,e,t,a,!1)},c.prototype.write=function(e,t,a,n){if(void 0===t)n="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)n=t,a=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(a)?(a>>>=0,void 0===n&&(n="utf8")):(n=a,a=void 0)}const r=this.length-t;if((void 0===a||a>r)&&(a=r),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,e,t,a);case"utf8":case"utf-8":return w(this,e,t,a);case"ascii":case"latin1":case"binary":return R(this,e,t,a);case"base64":return N(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,a);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function T(e,t,a){let n="";a=Math.min(e.length,a);for(let r=t;r<a;++r)n+=String.fromCharCode(127&e[r]);return n}function B(e,t,a){let n="";a=Math.min(e.length,a);for(let r=t;r<a;++r)n+=String.fromCharCode(e[r]);return n}function A(e,t,a){const n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);let r="";for(let n=t;n<a;++n)r+=X[e[n]];return r}function L(e,t,a){const n=e.slice(t,a);let r="";for(let e=0;e<n.length-1;e+=2)r+=String.fromCharCode(n[e]+256*n[e+1]);return r}function S(e,t,a){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,a,n,r,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(a+n>e.length)throw new RangeError("Index out of range")}function M(e,t,a,n,r){H(t,n,r,e,a,7);let s=Number(t&BigInt(4294967295));e[a++]=s,s>>=8,e[a++]=s,s>>=8,e[a++]=s,s>>=8,e[a++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[a++]=o,o>>=8,e[a++]=o,o>>=8,e[a++]=o,o>>=8,e[a++]=o,a}function D(e,t,a,n,r){H(t,n,r,e,a,7);let s=Number(t&BigInt(4294967295));e[a+7]=s,s>>=8,e[a+6]=s,s>>=8,e[a+5]=s,s>>=8,e[a+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[a+3]=o,o>>=8,e[a+2]=o,o>>=8,e[a+1]=o,o>>=8,e[a]=o,a+8}function U(e,t,a,n,r,s){if(a+n>e.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function _(e,t,a,n,s){return t=+t,a>>>=0,s||U(e,0,a,4),r.write(e,t,a,n,23,4),a+4}function O(e,t,a,n,s){return t=+t,a>>>=0,s||U(e,0,a,8),r.write(e,t,a,n,52,8),a+8}c.prototype.slice=function(e,t){const a=this.length;(e=~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),(t=void 0===t?a:~~t)<0?(t+=a)<0&&(t=0):t>a&&(t=a),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,a){e>>>=0,t>>>=0,a||S(e,t,this.length);let n=this[e],r=1,s=0;for(;++s<t&&(r*=256);)n+=this[e+s]*r;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,a){e>>>=0,t>>>=0,a||S(e,t,this.length);let n=this[e+--t],r=1;for(;t>0&&(r*=256);)n+=this[e+--t]*r;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z((function(e){z(e>>>=0,"offset");const t=this[e],a=this[e+7];void 0!==t&&void 0!==a||F(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+a*2**24;return BigInt(n)+(BigInt(r)<<BigInt(32))})),c.prototype.readBigUInt64BE=Z((function(e){z(e>>>=0,"offset");const t=this[e],a=this[e+7];void 0!==t&&void 0!==a||F(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+a;return(BigInt(n)<<BigInt(32))+BigInt(r)})),c.prototype.readIntLE=function(e,t,a){e>>>=0,t>>>=0,a||S(e,t,this.length);let n=this[e],r=1,s=0;for(;++s<t&&(r*=256);)n+=this[e+s]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,a){e>>>=0,t>>>=0,a||S(e,t,this.length);let n=t,r=1,s=this[e+--n];for(;n>0&&(r*=256);)s+=this[e+--n]*r;return r*=128,s>=r&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||S(e,2,this.length);const a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},c.prototype.readInt16BE=function(e,t){e>>>=0,t||S(e,2,this.length);const a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z((function(e){z(e>>>=0,"offset");const t=this[e],a=this[e+7];void 0!==t&&void 0!==a||F(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(a<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Z((function(e){z(e>>>=0,"offset");const t=this[e],a=this[e+7];void 0!==t&&void 0!==a||F(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+a)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||S(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||S(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||S(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||S(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,a,n){e=+e,t>>>=0,a>>>=0,n||P(this,e,t,a,Math.pow(2,8*a)-1,0);let r=1,s=0;for(this[t]=255&e;++s<a&&(r*=256);)this[t+s]=e/r&255;return t+a},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,a,n){e=+e,t>>>=0,a>>>=0,n||P(this,e,t,a,Math.pow(2,8*a)-1,0);let r=a-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+a},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Z((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,a,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*a-1);P(this,e,t,a,n-1,-n)}let r=0,s=1,o=0;for(this[t]=255&e;++r<a&&(s*=256);)e<0&&0===o&&0!==this[t+r-1]&&(o=1),this[t+r]=(e/s>>0)-o&255;return t+a},c.prototype.writeIntBE=function(e,t,a,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*a-1);P(this,e,t,a,n-1,-n)}let r=a-1,s=1,o=0;for(this[t+r]=255&e;--r>=0&&(s*=256);)e<0&&0===o&&0!==this[t+r+1]&&(o=1),this[t+r]=(e/s>>0)-o&255;return t+a},c.prototype.writeInt8=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Z((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,a){return _(this,e,t,!0,a)},c.prototype.writeFloatBE=function(e,t,a){return _(this,e,t,!1,a)},c.prototype.writeDoubleLE=function(e,t,a){return O(this,e,t,!0,a)},c.prototype.writeDoubleBE=function(e,t,a){return O(this,e,t,!1,a)},c.prototype.copy=function(e,t,a,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(a||(a=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<a&&(n=a),n===a)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);const r=n-a;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,a,n):Uint8Array.prototype.set.call(e,this.subarray(a,n),t),r},c.prototype.fill=function(e,t,a,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,a=this.length):"string"==typeof a&&(n=a,a=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;let r;if(t>>>=0,a=void 0===a?this.length:a>>>0,e||(e=0),"number"==typeof e)for(r=t;r<a;++r)this[r]=e;else{const s=c.isBuffer(e)?e:c.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<a-t;++r)this[r+t]=s[r%o]}return this};const q={};function j(e,t,a){q[e]=class extends a{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function $(e){let t="",a=e.length;const n="-"===e[0]?1:0;for(;a>=n+4;a-=3)t=`_${e.slice(a-3,a)}${t}`;return`${e.slice(0,a)}${t}`}function H(e,t,a,n,r,s){if(e>a||e<t){const n="bigint"==typeof t?"n":"";let r;throw r=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${a}${n}`,new q.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,a){z(t,"offset"),void 0!==e[t]&&void 0!==e[t+a]||F(t,e.length-(a+1))}(n,r,s)}function z(e,t){if("number"!=typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,a){if(Math.floor(e)!==e)throw z(e,a),new q.ERR_OUT_OF_RANGE(a||"offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE(a||"offset",`>= ${a?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,a){let n=`The value of "${e}" is out of range.`,r=a;return Number.isInteger(a)&&Math.abs(a)>2**32?r=$(String(a)):"bigint"==typeof a&&(r=String(a),(a>BigInt(2)**BigInt(32)||a<-(BigInt(2)**BigInt(32)))&&(r=$(r)),r+="n"),n+=` It must be ${t}. Received ${r}`,n}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function Y(e,t){let a;t=t||1/0;const n=e.length;let r=null;const s=[];for(let o=0;o<n;++o){if(a=e.charCodeAt(o),a>55295&&a<57344){if(!r){if(a>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}r=a;continue}if(a<56320){(t-=3)>-1&&s.push(239,191,189),r=a;continue}a=65536+(r-55296<<10|a-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,a<128){if((t-=1)<0)break;s.push(a)}else if(a<2048){if((t-=2)<0)break;s.push(a>>6|192,63&a|128)}else if(a<65536){if((t-=3)<0)break;s.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return s}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,a,n){let r;for(r=0;r<n&&!(r+a>=t.length||r>=e.length);++r)t[r+a]=e[r];return r}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let a=0;a<16;++a){const n=16*a;for(let r=0;r<16;++r)t[n+r]=e[a]+e[r]}return t}();function Z(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},645:(e,t)=>{t.read=function(e,t,a,n,r){var s,o,l=8*r-n-1,c=(1<<l)-1,i=c>>1,d=-7,m=a?r-1:0,u=a?-1:1,p=e[t+m];for(m+=u,s=p&(1<<-d)-1,p>>=-d,d+=l;d>0;s=256*s+e[t+m],m+=u,d-=8);for(o=s&(1<<-d)-1,s>>=-d,d+=n;d>0;o=256*o+e[t+m],m+=u,d-=8);if(0===s)s=1-i;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=i}return(p?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,a,n,r,s){var o,l,c,i=8*s-r-1,d=(1<<i)-1,m=d>>1,u=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+m>=1?u/c:u*Math.pow(2,1-m))*c>=2&&(o++,c/=2),o+m>=d?(l=0,o=d):o+m>=1?(l=(t*c-1)*Math.pow(2,r),o+=m):(l=t*Math.pow(2,m-1)*Math.pow(2,r),o=0));r>=8;e[a+p]=255&l,p+=h,l/=256,r-=8);for(o=o<<r|l,i+=r;i>0;e[a+p]=255&o,p+=h,o/=256,i-=8);e[a+p-h]|=128*f}}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}(()=>{const e=a(832),t=a(401),n=a(986),r=a(984),s=a(911),o=a(316),l=a(856),c=a(333),i=a(112),d=a(841),m=a(493);a(603),window.onload=async()=>{const a=await fetch("/getToken"),u=await a.json();if(null!=document.getElementById("navbar")){ReactDOM.render(React.createElement(l.Navbar,{csrf:u.csrfToken}),document.getElementById("navbar"));const e={renderLoginWindow:o.renderLoginWindow,renderSignUpWindow:o.renderSignUpWindow};l.initializeNavbar(e,u.csrfToken)}let p=document.querySelector("header").getAttribute("data-current-page");switch(p){case"create":e.init();break;case"editNovel":t.init();break;case"editChapter":n.init();break;case"home":r.init();break;case"library":s.init();break;case"login":await o.init(),"true"===localStorage.getItem("partchment-LoadSignUp")&&(console.log("controller login"),console.log(u),o.renderSignUpWindow({_csrf:u.csrfToken}),window.localStorage.setItem("partchment-LoadSignUp",!1)),l.updateSelectedPage();break;case"profile":c.init();break;case"viewNovel":d.init();break;case"readNovel":i.init();break;case"notFound":m.init();break;default:console.log(`unknown page: ${p}`)}}})()})();