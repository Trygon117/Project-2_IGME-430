/*! For license information please see controllerBundle.js.LICENSE.txt */
(()=>{var e={832:(e,t,n)=>{const a=n(603),r=n(764).lW,s=e=>React.createElement("div",null,React.createElement("div",{className:"box",style:{minHeight:"100vh"}},React.createElement("h1",{className:"title"},"My Novels:"),React.createElement("hr",null),React.createElement("div",{id:"novel-cards",className:"is-flex",style:{gap:10}}))),i=e=>{const t=r.from(e.novel.cover.data,"base64").toString("base64"),n=`data:${e.novel.coverMime};base64,${t}`;return React.createElement("div",{style:{border:"ridge thin",width:200,height:360},onMouseEnter:t=>{const n=document.getElementById(`${e.novel.title}-title`);n.classList.add("is-size-4"),n.classList.remove("is-size-5"),t.currentTarget.style.width=250,t.currentTarget.style.height=450},onMouseLeave:t=>{const n=document.getElementById(`${e.novel.title}-title`);n.classList.add("is-size-5"),n.classList.remove("is-size-4"),t.currentTarget.style.width=200,t.currentTarget.style.height=360},onClick:t=>{console.log(`Card clicked: ${t.currentTarget}`),window.localStorage.setItem("partchment-editorNovelID",e.novel._id),window.location.assign("/editNovel")}},React.createElement("div",{className:"card"},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${e.novel.title}-img`,src:n,alt:"Placeholder image"})))),React.createElement("h1",{id:`${e.novel.title}-title`,className:"is-size-5 has-text-centered has-text-grey",style:{overflow:"hidden"}},e.novel.title))},o=e=>React.createElement("div",{className:"card",style:{width:200},onMouseEnter:e=>{e.currentTarget.style.width=250},onMouseLeave:e=>{e.currentTarget.style.width=200},onClick:t=>{c(e)}},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:"/assets/img/AddCard.png",alt:"Placeholder image"})))),l=async e=>{const t=await fetch("/getLoggedInAs"),n=(await t.json()).username;ReactDOM.render(React.createElement(s,{csrf:e}),document.getElementById("create-content")),a.sendPost("/searchNovelsByUser",{user:n,_csrf:e},(t=>{t.error||(console.log(t),novels=t.novels,console.log(novels),Object.values(novels).forEach((t=>{const n=t.title.toLowerCase().replace(" ","_"),a=document.createElement("div");a.id=n,document.getElementById("novel-cards").appendChild(a),ReactDOM.render(React.createElement(i,{csrf:e,novel:t}),document.getElementById(n))})));const n="empty-card",a=document.createElement("div");a.id=n,document.getElementById("novel-cards").appendChild(a),ReactDOM.render(React.createElement(o,{csrf:e}),document.getElementById(n))}))},c=e=>{const t=e=>React.createElement("div",null,React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{height:65,width:"100vw",border:"thin ridge"}},React.createElement("div",{className:"column is-offset-0"},React.createElement("a",{className:"button is-white",onClick:()=>{l(e.csrf)}},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back"))),React.createElement("div",{style:{height:10}}),React.createElement("form",{id:"createNovelForm",name:"createNovelForm",onSubmit:handleCreateNovel,action:"/createNovel",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Create A New Novel!")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"title"},"Title: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"title",type:"text",name:"title",placeholder:"Title"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-book"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label"},"Book Cover: "),React.createElement("div",{className:""},React.createElement("div",{className:"file is-boxed has-name is-info"},React.createElement("label",{className:"file-label"},React.createElement("input",{className:"file-input",id:"cover",type:"file",name:"cover",onChange:async e=>{const t=e.currentTarget.files[0];if(!t)return;const n=new FileReader;n.addEventListener("load",(()=>{const e=n.result;document.querySelector("#coverPreview").src=e,document.querySelector("#fileName").innerHTML=t.name})),n.readAsDataURL(t)}}),React.createElement("span",{className:"file-cta"},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fas fa-upload"})),React.createElement("span",{className:"file-label"},"Choose a file…")),React.createElement("span",{id:"fileName",className:"file-name"},"Use a 2:3 aspect ratio"))),React.createElement("div",{className:"",style:{width:200}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:"coverPreview",src:"/assets/img/1080x1920.png",alt:"Placeholder image"}))))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"create-novel-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Create"}))));ReactDOM.render(React.createElement(t,{csrf:e.csrf}),document.getElementById("create-content"))};handleCreateNovel=e=>{e.preventDefault();const t=document.getElementById("title").value,n=document.getElementById("cover"),r=document.getElementById("create-novel-error-span"),s=e.target.querySelector("#_csrf").value;if(!t)return void(r.innerHTML="Title is required!");const i=n.files[0];if(!i||void 0===i)return void(r.innerHTML="Cover is required!");const o={_csrf:s,formData:new FormData(document.querySelector("#createNovelForm"))};a.sendMultipartPost("/createNovel",o,d)};const d=e=>{l(e.csrfToken)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();l(t.csrfToken)}}},986:(e,t,n)=>{const a=n(603);let r,s,i=!0;const o=e=>{console.log("props"),console.log(e);let t=e.chapter,n=!1;const o=async n=>{const r="Publish"===document.getElementById("publish-button").innerText,s=()=>{const e=document.getElementById("publish-button"),n=document.getElementById("publish-icon"),a=document.createTextNode("Publish");e.innerHTML="",console.log("Chapter"),console.log(t),t.published?(a.textContent="Unpublish",e.classList.add("is-danger"),e.classList.remove("is-primary"),n.className="fa-solid fa-x"):(a.textContent="Publish",e.classList.remove("is-danger"),e.classList.add("is-primary"),n.className="fa-solid fa-check"),e.appendChild(n),e.appendChild(a)};if(r)w("publish chapter",(r=>{const i={chapterID:t._id,novelID:t.novelID,chapter:t.chapter,chapterNumber:r.chapterNumber,mode:r.mode,referenceChapter:r.chapter,_csrf:e.csrf};a.sendPost("/publishChapter",i,(r=>{console.log("pubChapterResponse"),console.log(r),"novel not published"===r.error?w("publish novel",(()=>{console.log("publish novel"),a.sendPost("/publishNovel",{novelID:t.novelID,published:!0,_csrf:e.csrf},(e=>{console.log(e),e.error?console.log("Could not publish the novel"):o(n)}))})):r.error?console.log("error publishing"):(console.log("published!"),document.getElementById("modal").classList.remove("is-active"),t=r.chapter,console.log(e),s())}))}));else{const n={chapterID:t._id,novelID:t.novelID,chapter:t.chapter,mode:"unpublish",_csrf:e.csrf};await a.sendPost("/publishChapter",n,(n=>{console.log("unPubResponse"),console.log(n),t=n.chapter,console.log(e),s()}))}},l=e=>{switch(e.key){case"Control":n=!0;break;case"b":n&&(e.preventDefault(),console.log("bold"),m());break;case"i":n&&(e.preventDefault(),f());break;case"u":n&&(e.preventDefault(),h())}},c=e=>{"Control"===e.key&&(n=!1)},d=n=>{if(i)return;console.log("updating...");const s=document.getElementById("editable-chapter-content"),o=document.getElementById("saved-span");if(o.innerHTML="Unsaved",o.classList.remove("is-success"),o.classList.add("is-warning"),s.innerText.length<=1){const e=document.getElementById("font-drop-text"),t=document.getElementById("text-size"),n=document.createElement("span");n.classList.add(`${e.getAttribute("data-font")}-font-span`),n.classList.add(`font-size-${t.value}-span`),n.innerText=s.innerText,s.innerHTML="",s.appendChild(n);const a=document.createRange(),r=window.getSelection();a.setStart(n,s.innerText.length),a.collapse(!0),r.removeAllRanges(),r.addRange(a)}const l=e=>{if(e.hasChildNodes())e.childNodes.forEach((e=>{l(e)}));else if(e.textContent&&-1!=e.textContent.indexOf("​")){const t=window.getSelection();if(t.rangeCount<=0)return void(e.textContent=e.textContent.replace("​",""));const n=t.getRangeAt(0);let a;n.startOffset===n.endOffset&&(a=n.startOffset);let r=n.commonAncestorContainer.parentElement;if(e.textContent=e.textContent.replace("​",""),r.isEqualNode(e.parentElement)){const t=document.createRange(),n=window.getSelection();a&&a>0?t.setStart(e,a-1):t.setStart(e,e.textContent.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t)}}};l(s),r&&(clearInterval(r),r=null),r=setInterval((async()=>{console.log("update content"),clearInterval(r),r=null,console.log(t),await a.sendPost("/editChapter",{chapterID:t._id,content:s.innerHTML,_csrf:e.csrf},(e=>{e.error?(console.log(e.error),o.innerHTML="Error",o.classList.remove("is-warning"),o.classList.remove("is-success"),o.classList.add("is-error")):(o.innerHTML="Saved",o.classList.remove("is-warning"),o.classList.remove("is-error"),o.classList.add("is-success"))}))}),1e3)},u=e=>{const t=window.getSelection();if(t.rangeCount<=0)return!1;const n=t.getRangeAt(0);let r=n.commonAncestorContainer.parentElement;if(!a.isDescendent(document.getElementById("textDiv"),r)&&!r.isEqualNode(document.getElementById("textDiv")))return!1;if(r.isEqualNode(document.getElementById("saved-span")))return!1;if(0===n.cloneContents().childNodes.length){const e=document.getElementById("bold-button"),t=document.getElementById("italic-button"),n=document.getElementById("underline-button");r.classList.contains("bold-span")?(e.classList.remove("is-outlined"),e.classList.add("is-dark")):(e.classList.add("is-outlined"),e.classList.remove("is-dark")),r.classList.contains("italic-span")?(t.classList.remove("is-outlined"),t.classList.add("is-dark")):(t.classList.add("is-outlined"),t.classList.remove("is-dark")),r.classList.contains("underline-span")?(n.classList.remove("is-outlined"),n.classList.add("is-dark")):(n.classList.add("is-outlined"),n.classList.remove("is-dark"))}},m=async()=>{g("bold-span")&&(console.log("updating"),d())},f=()=>{g("italic-span")&&d()},h=()=>{g("underline-span")&&d()},p=e=>{const t=`${e.currentTarget.getAttribute("data-font")}-font-span`,n=document.getElementById("font-drop-text");n.innerHTML=e.currentTarget.innerHTML,n.className=`${e.currentTarget.getAttribute("data-font")}-font-span`,n.setAttribute("data-font",e.currentTarget.getAttribute("data-font")),console.log("font span class"),console.log(t)},g=e=>{const t=window.getSelection();if(t.rangeCount<=0)return!1;const n=t.getRangeAt(0);let r=n.commonAncestorContainer.parentElement,s=r.cloneNode(!0);if(!a.isDescendent(document.getElementById("textDiv"),r)&&!r.isEqualNode(document.getElementById("textDiv")))return!1;if(r.isEqualNode(document.getElementById("saved-span")))return!1;let i=r.classList;const o=n.extractContents();if(0===o.childNodes.length&&(console.log("no children"),!r.classList.contains(e))){const a=document.createElement("span");a.className=e,a.innerHTML="&#8203",console.log(a),n.insertNode(a);const r=document.createRange();return r.setStart(a,1),r.collapse(!0),t.removeAllRanges(),void t.addRange(r)}const l=Array.from(o.childNodes);let c;n.insertNode(o);let d=!1;"SPAN"===r.tagName?(d=!0,c=Array.from(r.childNodes),r.remove()):(r=document.getElementById("editable-chapter-content"),s=r.cloneNode(!0),c=Array.from(r.childNodes),r.innerHTML="");const u=[],m=y(c,l);m.firstNodesToAdd.forEach((e=>{let t=e;d&&(3===e.nodeType?(t=document.createElement("span"),t.classList=i,t.innerText=e.textContent):"SPAN"===e.tagName?i.forEach((e=>{t.classList.add(e)})):console.log("firstNodeToAdd had unhandled nodeType")),u.unshift(t)}));let f=!1;for(const t of s.childNodes){if(console.log(t),1!==t.nodeType){f=!1;break}if(!t.classList.contains(e)){f=!1;break}f=!0}m.selectNodesToAdd.forEach((t=>{let n=t;s.classList.contains(e)||f?3===t.nodeType?(n=document.createElement("span"),n.classList=i,n.classList.remove(e),n.innerHTML=t.textContent):"SPAN"===t.tagName&&n.classList.remove(e):3===t.nodeType?(n=document.createElement("span"),n.classList=i,n.classList.add(e),n.innerHTML=t.textContent):"SPAN"===t.tagName&&n.classList.add(e),u.unshift(n)})),m.lastNodesToAdd.forEach((e=>{let t=e;d&&(3===e.nodeType?(t=document.createElement("span"),t.classList=i,t.innerText=e.textContent):"SPAN"===e.tagName?i.forEach((e=>{t.classList.add(e)})):console.log("lastNodeToAdd had unhandled nodeType")),u.unshift(t)})),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();let h=document.getElementById("editable-chapter-content");u.forEach((e=>{n.insertNode(e)}));const p=h.querySelectorAll("span");let g=[];p.forEach((e=>{""===e.innerText&&g.push(e)})),g.forEach((e=>{e.remove()}));const w=E(h);h.before(w),h.remove(),h=document.getElementById("editable-chapter-content");const R=b(h);return h.before(R),h.remove(),h=document.getElementById("editable-chapter-content"),console.log(h),console.log(h.cloneNode(!0)),v(h),!0},y=(e,t)=>{const n=[],a=[],r=[];return e.forEach((e=>{let s=!1;t.forEach((t=>{e.isEqualNode(t)&&(a.push(t),s=!0)})),s||(0===a.length?n.push(e):r.push(e))})),{firstNodesToAdd:n,selectNodesToAdd:a,lastNodesToAdd:r}},E=e=>{let t=e.cloneNode(!0);for(const e of t.querySelectorAll("span"))if(e.nextElementSibling===e.nextSibling&&null!==e.nextSibling&&"SPAN"===e.nextSibling.tagName){if(0===e.classList.length){const n=document.createTextNode(e.innerText);e.before(n),e.remove(),t=E(t);break}if(e.className===e.nextSibling.className){let n=document.createElement("span");n.classList=e.classList,n.innerText=e.innerText+e.nextSibling.innerText,e.before(n),e.nextElementSibling.remove(),e.remove(),t=E(t);break}}return t},b=e=>{let t=e.cloneNode(!0);for(const e of t.childNodes)if(3==e.nodeType&&e.nextSibling&&3===e.nextSibling.nodeType){let n=document.createTextNode(e.textContent+e.nextSibling.textContent);e.before(n),e.nextSibling.remove(),e.remove(),t=E(t);break}return t},v=e=>{e.addEventListener("input",d),e.addEventListener("click",u),e.addEventListener("keyDown",l),e.addEventListener("keyUp",c)},w=(n,r)=>{const i=document.getElementById("modal-text-area"),o=document.getElementById("modal"),l=document.getElementById("modal-yes-button"),c=document.getElementById("modal-cancel-button"),d=document.getElementById("modal-title");switch(l.disabled=!1,n){case"publish novel":i.innerHTML="";const n=document.createElement("p"),u=document.createElement("p");n.innerText="This chapter cannot be published because the novel is not published.",u.innerText="Would you like to publish the novel ? ",i.appendChild(n),i.appendChild(u),l.style.visibility="visible",l.innerText="Yes",l.removeEventListener("click",s),s=r,l.addEventListener("click",r),c.innerText="Cancel",d.innerText="Novel Not Published",o.classList.add("is-active");break;case"publish chapter":i.innerHTML="",l.disabled=!0,a.sendPost("/searchNovelByID",{novelID:t.novelID,_csrf:e.csrf},(e=>{console.log(e);const t=[];Object.keys(e.novel.chapters).forEach((e=>{e.includes("chapter-")&&t.push(e)}));const n=document.createElement("div");n.style.border="ridge thin",n.style.height="350px",n.style.overflowY="auto";for(const e of t){const t=document.createElement("div");t.id="chap-option-container",t.setAttribute("data-selected","false");const a=()=>{let e=!1;"true"===t.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option-container").forEach((e=>{e.setAttribute("data-selected","false")}));let a=!1;t.childNodes.forEach((e=>{"true"===e.getAttribute("data-selected")&&(a=!0)})),e&&!a||t.setAttribute("data-selected","true")},r=document.createElement("span");r.id="chap-insert",r.setAttribute("insert","before");const s=document.createElement("i");s.className="fa-solid fa-arrow-up";const i=document.createElement("p");i.innerText="insert before",r.style.border="thin ridge",r.className="has-text-grey",r.style.display="flex",r.style.alignItems="center",r.style.gap="10px",r.style.height="30px",r.appendChild(s),r.appendChild(i),r.style.visibility="hidden",r.style.display="none";const o=()=>{"true"===r.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#62c462",i.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#ffc9c9",i.style.fontSize="20px"):(r.style.height="30px",r.style.backgroundColor="#ffffff",i.style.fontSize="17px")};r.onmouseenter=()=>{r.style.height="40px",r.style.backgroundColor="#bbf0de",r.style.fontSize="20px"},r.onmouseleave=()=>{"true"===r.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#62c462",i.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#ffc9c9",i.style.fontSize="20px"):(r.style.height="30px",r.style.backgroundColor="#ffffff",i.style.fontSize="17px")},r.onclick=()=>{let e=!1;"true"===r.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),e||r.setAttribute("data-selected","true"),a(),console.log("here"),y()};const c=document.createElement("span");c.id="chap-insert",c.setAttribute("insert","after");const d=document.createElement("i");d.className="fa-solid fa-arrow-down";const u=document.createElement("p");u.innerText="insert After",c.style.border="thin ridge",c.className="has-text-grey",c.style.display="flex",c.style.alignItems="center",c.style.gap="10px",c.style.height="30px",c.appendChild(d),c.appendChild(u),c.style.visibility="hidden",c.style.display="none";const m=()=>{"true"===c.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#62c462",u.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#ffc9c9",u.style.fontSize="20px"):(c.style.height="30px",c.style.backgroundColor="#ffffff",u.style.fontSize="17px")};c.onchange=m,c.onmouseenter=()=>{c.style.height="40px",c.style.backgroundColor="#bbf0de",c.style.fontSize="20px"},c.onmouseleave=()=>{"true"===c.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#62c462",u.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#ffc9c9",u.style.fontSize="20px"):(c.style.height="30px",c.style.backgroundColor="#ffffff",u.style.fontSize="17px")},c.onclick=()=>{let e=!1;"true"===c.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),e||c.setAttribute("data-selected","true"),a(),y()};const f=document.createElement("span");f.id="chap-option";const h=document.createElement("i"),p=document.createElement("p");f.style.border="thin ridge",f.className="has-text-grey",f.style.display="flex",f.style.alignItems="center",f.style.gap="10px",f.style.height="30px",h.className="fa-solid fa-repeat",p.innerText=e,p.style.fontSize="17px";const g=()=>{"true"===f.getAttribute("data-selected")?(f.style.height="40px",f.style.backgroundColor="#62c462",p.style.fontSize="20px"):"true"===f.parentElement.getAttribute("data-selected")?(f.style.height="40px",f.style.backgroundColor="#ffc9c9",p.style.fontSize="20px"):(f.style.height="30px",f.style.backgroundColor="#ffffff",p.style.fontSize="17px")};f.onchange=g,f.onmouseenter=()=>{f.style.height="40px",f.style.backgroundColor="#bbf0de",p.style.fontSize="20px"},f.onmouseleave=()=>{"true"!==f.getAttribute("data-selected")?"true"===t.getAttribute("data-selected")?(f.style.height="40px",f.style.backgroundColor="#ffc9c9",p.style.fontSize="20px"):(f.style.height="30px",f.style.backgroundColor="#ffffff",p.style.fontSize="17px"):(f.style.height="40px",f.style.backgroundColor="#62c462",p.style.fontSize="20px")},f.onclick=()=>{let e=!1;"true"===f.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false"),e.style.height="30px",e.style.backgroundColor="#ffffff",e.style.fontSize="17px"})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false"),e.style.visibility="hidden",e.style.display="none"})),e?l.disabled=!0:(f.setAttribute("data-selected","true"),r.style.visibility="visible",c.style.visibility="visible",r.style.display="flex",c.style.display="flex",l.disabled=!1),a(),y()};const y=()=>{m(),o(),g()};f.appendChild(h),f.appendChild(p),t.appendChild(r),t.appendChild(f),t.appendChild(c),n.appendChild(t)}if(console.log(n),""===n.innerText){const e=document.createElement("p");e.innerText="This is the first chapter!",n.appendChild(e)}const a=document.createElement("a");a.className="button is-link",a.innerText="Publish As latest Chapter",a.style.marginBottom="10px",a.addEventListener("click",(()=>{r({chapterNumber:t.length,mode:"add-last"})}));const u=document.createElement("p");u.innerText="Or, Choose where to add it: ",u.className="subtitle",u.style.marginTop="10px",i.appendChild(a),i.appendChild(u),i.appendChild(n),l.style.visibility="visible",l.innerText="Publish";const m=()=>{n.querySelectorAll("span").forEach((e=>{if("true"===e.getAttribute("data-selected")){const t=e.parentElement.querySelector("#chap-option").querySelector("p").innerText;"chap-option"===e.id?r({chapter:t,mode:"replace"}):"chap-insert"===e.id&&("before"==e.getAttribute("insert")?r({chapter:t,mode:"insert-before"}):"after"==e.getAttribute("insert")&&r({chapter:t,mode:"insert-after"}))}}))};s&&l.removeEventListener("click",s),s=m,l.addEventListener("click",m),c.innerText="Cancel",d.innerText="Publish Chapter",o.classList.add("is-active")}));break;case"preview":i.innerHTML="";const m=document.createElement("p");m.innerText=t.content,i.appendChild(m),i.value=t.content,i.rows="1",l.style.visibility="hidden",c.innerText="Cancel",d.innerText=t.title,o.classList.add("is-active")}},R=()=>{document.getElementById("modal").classList.remove("is-active")};return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal",style:{zIndex:1001}},React.createElement("div",{className:"modal-background",onClick:e=>{(document.querySelectorAll(".modal")||[]).forEach((e=>{e.classList.remove("is-active")}))}}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:R})),React.createElement("section",{className:"modal-card-body"},React.createElement("div",{id:"modal-text-area"})),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-yes-button",className:"button is-success",onClick:R},"Yes"),React.createElement("button",{id:"modal-cancel-button",className:"button",onClick:R},"Cancel")))),React.createElement("div",{id:"editor-head",style:{position:"sticky",top:"0px",backgroundColor:"white",border:"thin ridge",zIndex:1e3}},React.createElement("div",{style:{height:65,width:"100vw",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",null,React.createElement("a",{className:"button is-white",href:"/editNovel"},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back")),React.createElement("div",{style:{display:"flex",flexFlow:"row",gap:10}},React.createElement("a",{id:"preview-button",className:"button is-link",onClick:e=>{console.log("preview!")}},React.createElement("i",{className:"fa-solid fa-eye",style:{padding:"0 10 0 0"}}),"Preview"),React.createElement("a",{id:"publish-button",className:"button is-primary",onClick:o},React.createElement("i",{id:"publish-icon",className:"fa-solid fa-check",style:{padding:"0 10 0 0"}}),"Publish"))),React.createElement("div",{id:"editor-controls",style:{height:40,width:"100vw",display:"flex",flexFlow:"row",justifyContent:"center",gap:"15px",margin:"0px 10px 10px 10px"}},React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"bold-button",className:"button is-outlined",onClick:m},React.createElement("i",{className:"fa-solid fa-bold"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"italic-button",className:"button is-outlined",onClick:f},React.createElement("i",{className:"fa-solid fa-italic"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"underline-button",className:"button is-outlined",onClick:h},React.createElement("i",{className:"fa-solid fa-underline"}))),React.createElement("span",{className:"dropdown",onClick:e=>{e.currentTarget.classList.toggle("is-active")}},React.createElement("div",{className:"dropdown-trigger"},React.createElement("button",{className:"button","aria-haspopup":"true","aria-controls":"dropdown-menu"},React.createElement("span",{id:"font-drop-text",className:"georgia-font-span","data-font":"georgia",style:{width:"120px",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis"}},"Georgia"),React.createElement("span",{className:"icon is-small"},React.createElement("i",{className:"fas fa-angle-down","aria-hidden":"true"})))),React.createElement("div",{id:"dropdown-menu",className:"dropdown-menu",role:"menu"},React.createElement("div",{className:"dropdown-content"},React.createElement("a",{className:"dropdown-item georgia-font-span","data-font":"georgia",onClick:p},"Georgia"),React.createElement("a",{className:"dropdown-item times-new-roman-font-span","data-font":"times-new-roman",onClick:p},"Times New Roman"),React.createElement("a",{className:"dropdown-item arial-font-span","data-font":"arial",onClick:p},"Arial")))),React.createElement("span",{style:{display:"flex",border:"ridge thin"}},React.createElement("a",{className:"button is-white",onClick:e=>{const t=document.getElementById("text-size");let n=parseInt(t.value)-1;n<=0?n=1:n>=100&&(n=100),t.value=n},style:{height:"38px"}},React.createElement("i",{className:"fa-solid fa-minus"})),React.createElement("input",{id:"text-size",className:"input",type:"number",name:"text-size",defaultValue:"20",min:"0",max:"100",onBlur:e=>{const t=document.getElementById("text-size");let n=parseInt(t.value);n<=0?n=1:n>=100&&(n=100),t.value=n},style:{width:"70px",height:"38px"}}),React.createElement("a",{className:"button is-white",onClick:e=>{const t=document.getElementById("text-size");let n=parseInt(t.value)+1;n<=0?n=1:n>=100&&(n=100),t.value=n},style:{height:"38px"}},React.createElement("i",{className:"fa-solid fa-plus"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"left-align-button",className:"button is-dark",onClick:e=>{const t=document.getElementById("left-align-button"),n=document.getElementById("center-align-button"),a=document.getElementById("right-align-button");t.classList.add("is-dark"),t.classList.remove("is-outlined"),n.classList.remove("is-dark"),n.classList.add("is-outlined"),a.classList.remove("is-dark"),a.classList.add("is-outlined")}},React.createElement("i",{className:"fa-solid fa-align-left"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"center-align-button",className:"button is-outlined",onClick:e=>{const t=document.getElementById("left-align-button"),n=document.getElementById("center-align-button"),a=document.getElementById("right-align-button");t.classList.remove("is-dark"),t.classList.add("is-outlined"),n.classList.add("is-dark"),n.classList.remove("is-outlined"),a.classList.remove("is-dark"),a.classList.add("is-outlined")}},React.createElement("i",{className:"fa-solid fa-align-center"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"right-align-button",className:"button is-outlined",onClick:e=>{const t=document.getElementById("left-align-button"),n=document.getElementById("center-align-button"),a=document.getElementById("right-align-button");t.classList.remove("is-dark"),t.classList.add("is-outlined"),n.classList.remove("is-dark"),n.classList.add("is-outlined"),a.classList.add("is-dark"),a.classList.remove("is-outlined")}},React.createElement("i",{className:"fa-solid fa-align-right"}))))),React.createElement("div",{id:"text-root",style:{display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center",width:"100vw",minHeight:"900px",marginBottom:"50px"}},React.createElement("div",{id:"title-div-container",style:{width:"720px",margin:0}},React.createElement("div",{id:"title-div",className:"title",contentEditable:"true",style:{marginTop:20,marginBottom:20,outline:"0px solid transparent"},onSelect:e=>{e.currentTarget.spellcheck=!0},onBlur:async n=>{console.log("update chap title");const r=document.getElementById("title-div");r.spellcheck=!1,console.log(t),await a.sendPost("/editChapter",{chapterID:t._id,title:r.innerHTML,_csrf:e.csrf},(e=>{console.log("response"),console.log(e),r.innerHTML=e.title}))}})),React.createElement("div",{id:"textDiv",style:{position:"relative",display:"block",width:"720px",minHeight:"900px",paddingBottom:"5px",borderWidth:"thick",border:"solid"}},React.createElement("span",{id:"saved-span",className:"tag is-success",style:{position:"absolute",bottom:"5px",right:"10px"}},"Saved"),React.createElement("div",{id:"editable-chapter-content",name:"textArea",contentEditable:"true",style:{padding:"3%",outline:"0px solid transparent",width:"100%",height:"100%"},onInput:d,onClick:u,onKeyDown:l,onKeyUp:c}))))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json(),n=localStorage.getItem("partchment-editorChapterID");if(!n)return console.log("No Chapter Selected"),void window.location.assign("/editNovel");a.sendPost("/searchChapterByID",{chapterID:n,_csrf:t.csrfToken},(e=>{console.log("chapterData"),console.log(e),"No Chapter Found"!==e.error?(ReactDOM.render(React.createElement(o,{csrf:t.csrfToken,chapter:e.chapter}),document.getElementById("edit-chapter-content")),(e=>{document.getElementById("title-div").innerHTML=e.title;const t=document.getElementById("publish-button"),n=document.getElementById("publish-icon"),a=document.createTextNode("Publish");t.innerHTML="",e.published?(a.textContent="Unpublish",t.classList.add("is-danger"),t.classList.remove("is-primary"),n.className="fa-solid fa-x"):(a.textContent="Publish",t.classList.remove("is-danger"),t.classList.add("is-primary"),n.className="fa-solid fa-check"),t.appendChild(n),t.appendChild(a),document.getElementById("editable-chapter-content").innerHTML=e.content,i=!1})(e.chapter)):window.location.assign("/editNovel")}))}}},401:(e,t,n)=>{const a=n(603),r=n(764).lW,s=e=>{console.log(e);let t=e.novel,n="False";t.published&&(n="True");const s=r.from(t.cover.data,"base64").toString("base64"),l=`data:${t.coverMime};base64,${s}`,c=new Date(t.createdDate).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),d=e=>{const n=e.currentTarget.getAttribute("data-modal-type"),a=document.getElementById("modal-textarea"),r=document.getElementById("modal"),s=document.getElementById("modal-save-button"),i=document.getElementById("modal-title");switch(n){case"abstract":a.value=t.abstract,a.rows="15",s.removeEventListener("click",m),s.addEventListener("click",f),i.innerHTML="Abstract";break;case"title":a.value=t.title,a.rows="1",s.removeEventListener("click",f),s.addEventListener("click",m),i.innerHTML="Title"}r.classList.add("is-active")},u=()=>{document.getElementById("modal").classList.remove("is-active")},m=n=>{const r=document.getElementById("modal-textarea"),s=document.getElementById("novel-title");console.log("Update title"),u();const i=document.createElement("span");i.classList="bulma-loader-mixin",s.appendChild(i),a.sendPost("/editNovel",{novelID:t._id,title:r.value,_csrf:e.csrf},(e=>{console.log(e),e.error&&console.log(e.error),t.title=e.title,s.innerHTML=t.title}))},f=n=>{const r=document.getElementById("modal-textarea"),s=document.getElementById("abstract-text");u();const i=document.createElement("span");i.classList="bulma-loader-mixin",s.appendChild(i),a.sendPost("/editNovel",{novelID:t._id,abstract:r.value,_csrf:e.csrf},(e=>{e.error&&console.log(e.error),t.abstract=e.abstract,s.innerHTML=t.abstract}))};return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal"},React.createElement("div",{className:"modal-background",onClick:e=>{(document.querySelectorAll(".modal")||[]).forEach((e=>{e.classList.remove("is-active")}))}}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:u})),React.createElement("section",{className:"modal-card-body"},React.createElement("textarea",{id:"modal-textarea",className:"textarea has-fixed-size",placeholder:"Add a description...",rows:"10"})),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-save-button",className:"button is-success"},"Save changes"),React.createElement("button",{className:"button",onClick:u},"Cancel")))),React.createElement("div",{className:"box",style:{minHeight:"80vh",width:"100vw",margin:"auto",padding:0}},React.createElement("div",{className:"",style:{height:65,width:"100vw",margin:"auto",border:"thin ridge",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",{className:""},React.createElement("a",{className:"button is-white",href:"/create"},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back")),React.createElement("div",{className:""},React.createElement("button",{className:"button is-link",onClick:n=>{a.sendPost("/createChapter",{novelID:t._id,_csrf:e.csrf},(e=>{console.log(e),window.localStorage.setItem("partchment-editorChapterID",e.createdChapter._id),window.location.assign("/editChapter")}))}},React.createElement("i",{className:"fa-solid fa-plus",style:{padding:"0 10 0 0"}})," Create Chapter"))),React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{width:"95vw",margin:"auto"}},React.createElement("div",{className:"column",style:{maxWidth:"300px",margin:"auto"}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${t.title}-img`,src:l,alt:"Placeholder image"}))),React.createElement("div",{className:"column is-three-quarters",style:{height:"34.35vw",minHeight:"250px",display:"flex",flexFlow:"column"}},React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h1",{id:"novel-title",className:"title",style:{margin:0,paddingRight:"10px"}},t.title),React.createElement("a",{onClick:d,"data-modal-type":"title"},React.createElement("i",{className:"fa-solid fa-pencil"}))),React.createElement("h2",{className:"subtitle"},"By: ",t.author),React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h2",{className:"subtitle",style:{margin:0,paddingRight:"10px"}},"Abstract"),React.createElement("a",{onClick:d,"data-modal-type":"abstract"},React.createElement("i",{className:"fa-solid fa-pencil"}))),React.createElement("div",{id:"abstract-text",style:{height:"100%",width:"100%",minHeight:"100px"}},t.abstract))),React.createElement("div",{className:"box"},React.createElement("ul",null,React.createElement("li",null,"Published Chapters: ",t.publishedChapterCount),React.createElement("li",null,"Unpublished Chapters: ",t.totalChapterCount-t.publishedChapterCount),React.createElement("li",null,"Created Date: ",c),React.createElement("li",null,"Published: ",n),React.createElement("li",null,"Publication Date: ",t.published))),React.createElement("hr",null),React.createElement("div",null,React.createElement("a",{id:"chapters-button",className:"button is-link",onClick:()=>{const t=document.getElementById("chapters-button"),n=document.getElementById("drafts-button"),a=document.getElementById("chapter-title");t.classList.add("is-link"),n.classList.remove("is-link"),a.innerHTML="Chapters",i(e.chapters)}},"Chapters"),React.createElement("a",{id:"drafts-button",className:"button",onClick:()=>{const t=document.getElementById("chapters-button"),n=document.getElementById("drafts-button"),a=document.getElementById("chapter-title");t.classList.remove("is-link"),n.classList.add("is-link"),a.innerHTML="Drafts",o(e.chapters)},style:{marginLeft:10}},"Drafts"),React.createElement("h1",{id:"chapter-title",className:"title"},"Chapters"),React.createElement("div",{id:"chapters-div"},React.createElement("table",{id:"chapters-table",className:"table is-hoverable",style:{width:"100%"}},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{style:{padding:0,paddingLeft:10,width:50}},React.createElement("abbr",{title:"Chapter"},"Chapter")),React.createElement("th",{style:{padding:0,width:100}},React.createElement("abbr",{title:"Name"},"Name")),React.createElement("th",{style:{padding:0,width:50}},React.createElement("abbr",{title:"Views"},"Views")),React.createElement("th",{style:{padding:0,width:50}}," ",React.createElement("abbr",{title:"Publish"},"Publish")),React.createElement("th",{style:{padding:0,width:50}}," ",React.createElement("abbr",{title:"Delete"},"Delete")))),React.createElement("tbody",{id:"chapters-table-body"}))))))},i=async e=>{const t=document.getElementById("chapters-table-body"),n=document.getElementById("chapters-table");if(t.innerHTML="",console.log("load chapters"),console.log(e),Object.keys(e).forEach((n=>{if(n.includes("chapter")){const a=document.createElement("tr"),r=document.createElement("th"),s=document.createElement("td"),i=document.createElement("td"),o=document.createElement("td"),l=document.createElement("td");a.style.width="100%",a.style.cursor="hand",a.addEventListener("click",(()=>{window.localStorage.setItem("partchment-editorChapterID",e[n]._id),window.location.assign("/editChapter")})),r.innerHTML=n,s.innerHTML=e[n].title,i.innerHTML=e[n].views;const c=document.createElement("a"),d=document.createElement("i");d.classList="fa-solid fa-x",c.appendChild(d),l.appendChild(c);const u=document.createElement("a"),m=document.createElement("i");m.classList="fa-solid fa-upload",u.appendChild(m),o.appendChild(u),a.appendChild(r),a.appendChild(s),a.appendChild(i),a.appendChild(o),a.appendChild(l),t.appendChild(a)}})),n.rows.length-1==0){const e=document.createElement("tr"),n=document.createElement("th");n.innerHTML="No published Chapters",e.appendChild(n),e.appendChild(chapterTitle),e.appendChild(chapterViews),e.appendChild(chapterPublish),e.appendChild(chapterDelete),t.appendChild(e)}},o=async e=>{const t=document.getElementById("chapters-table-body"),n=document.getElementById("chapters-table");if(t.innerHTML="",Object.keys(e).forEach((n=>{if(n.includes("draft")){const a=document.createElement("tr"),r=document.createElement("th"),s=document.createElement("td"),i=document.createElement("td"),o=document.createElement("td"),l=document.createElement("td");a.style.width="100%",a.addEventListener("click",(()=>{window.localStorage.setItem("partchment-editorChapterID",e[n]._id),window.location.assign("/editChapter")})),r.innerHTML=n,s.innerHTML=e[n].title,i.innerHTML=e[n].views;const c=document.createElement("a"),d=document.createElement("i");d.classList="fa-solid fa-x",c.appendChild(d),l.appendChild(c);const u=document.createElement("a"),m=document.createElement("i");m.classList="fa-solid fa-upload",u.appendChild(m),o.appendChild(u),a.appendChild(r),a.appendChild(s),a.appendChild(i),a.appendChild(o),a.appendChild(l),t.appendChild(a)}})),n.rows.length-1==0){const e=document.createElement("tr");chapterNumber.innerHTML="No Drafts",e.appendChild(chapterNumber),e.appendChild(chapterTitle),e.appendChild(chapterViews),e.appendChild(chapterPublish),e.appendChild(chapterDelete),t.appendChild(e),t.appendChild(e)}};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log("init editNovel"),console.log(t);const n=localStorage.getItem("partchment-editorNovelID");if(!n)return console.log("No Novel Selected"),void window.location.assign("/create");a.sendPost("/searchNovelByID",{novelID:n,_csrf:t.csrfToken},(async e=>{console.log(e),"No Novel Found"===e.error&&window.location.assign("/create"),await(async(e,t,n)=>{if(console.log("get chapters"),e.chapters){const r=e.chapters;console.log("chapterIDs"),console.log(r);const s={};for(let e=0;e<Object.keys(r).length;e++){const i=Object.keys(r)[e];await a.sendPost("/searchChapterByID",{chapterID:r[i],_csrf:t},(t=>{if(s[i]=t.chapter,e+1>=Object.keys(r).length)return n(s),s}))}}else n({})})(e.novel,t.csrfToken,(n=>{console.log("chapters"),console.log(n),ReactDOM.render(React.createElement(s,{csrf:t.csrfToken,novel:e.novel,chapters:n}),document.getElementById("edit-novel-content")),i(n)}))}))}}},603:e=>{const t=(e,t,n)=>{e.error&&console.log(`error: ${e.error}`),e.redirect&&(window.location=e.redirect),n&&(e.csrfToken=t._csrf,n(e))};e.exports={sendPost:async(e,n,a)=>{if(console.log(e),!n._csrf)return void console.log("Missing CSRF Token, request not sent");const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),s=await r.json();t(s,n,a)},sendMultipartPost:async(e,n,a)=>{const r=await fetch(e,{method:"POST",body:n.formData}),s=await r.json();t(s,n,a)},isDescendent:(e,t)=>{let n=t.parentNode;for(;n;){if(n===e)return!0;n=n.parentNode}return!1}}},984:e=>{const t=e=>React.createElement("div",null,React.createElement("h1",null,"Title"));e.exports={init:async()=>{const e=await fetch("/getToken"),n=await e.json();console.log(n),ReactDOM.render(React.createElement(t,{csrf:n.csrfToken}),document.getElementById("home-content"))}}},911:e=>{e.exports={init:async()=>{const e=await fetch("/getToken");await e.json()}}},316:(e,t,n)=>{const a=n(603),r=e=>{e.preventDefault();const t=e.target.querySelector("#user").value,n=e.target.querySelector("#pass").value,r=e.target.querySelector("#_csrf").value;return t&&n?(a.sendPost(e.target.action,{username:t,pass:n,_csrf:r}),!1):(e.target.querySelector("#login-error-span").innerHTML="Username or password is empty!",!1)},s=e=>{e.preventDefault();const t=e.target.querySelector("#user").value,n=e.target.querySelector("#pass").value,r=e.target.querySelector("#pass2").value,s=e.target.querySelector("#_csrf").value;return t&&n&&r?n!==r?(e.target.querySelector("#signup-error-span").innerHTML="Passwords do not match!",!1):(a.sendPost(e.target.action,{username:t,pass:n,pass2:r,_csrf:s}),!1):(e.target.querySelector("#signup-error-span").innerHTML="Username or password is empty!",!1)},i=e=>(console.log("login window"),console.log(e),React.createElement("form",{id:"loginForm",name:"loginForm",onSubmit:r,action:"/login",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Login")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"username"},"Username: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"user",type:"text",name:"username",placeholder:"Username"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fas fa-user"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass",type:"password",name:"pass",placeholder:"Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"login-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Sign in"})))),o=e=>(authenticateUsername=async t=>{const n=t.currentTarget;console.log("signup window - authenitcate username"),console.log(e),await a.sendPost("/isUsernameAvailable",{username:t.currentTarget.value,_csrf:e.csrf},(e=>{let t=n.parentElement,a=t.querySelector("#username-success-icon"),r=t.parentElement.querySelector("#isAvailable");e.found?(a.innerHTML='<i class="fa-solid fa-exclamation"></i>',r.innerHTML="This username is taken",r.classList="help is-danger"):(a.innerHTML='<i class="fas fa-check"></i>',r.innerHTML="This username is available",r.classList="help is-success")}))},React.createElement("form",{id:"signupForm",name:"signupForm",onSubmit:s,action:"/signup",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Sign Up")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"username"},"Username: "),React.createElement("div",{className:"control has-icons-left has-icons-right"},React.createElement("input",{className:"input",id:"user",type:"text",name:"username",placeholder:"Username",onChange:authenticateUsername}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fas fa-user"})),React.createElement("span",{id:"username-success-icon",className:"icon is-small is-right"})),React.createElement("p",{id:"isAvailable",className:"help is-success"})),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass",type:"password",name:"pass",placeholder:"Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass2"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass2",type:"password",name:"pass",placeholder:"Retype Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"signup-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Sign Up"}))));e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log("init login"),console.log(t),ReactDOM.render(React.createElement(i,{csrf:t.csrfToken}),document.getElementById("login-content"))},renderLoginWindow:async e=>{ReactDOM.render(React.createElement(i,{csrf:e.csrf}),document.getElementById("login-content"))},renderSignUpWindow:async e=>{console.log("render signup window"),console.log(e),console.log(e._csrf),ReactDOM.render(React.createElement(o,{csrf:e._csrf}),document.getElementById("login-content"))}}},856:e=>{const t=()=>{const e=document.querySelector("header").getAttribute("data-current-page");Array.from(document.querySelector(".navbar-start").children).concat(Array.from(document.querySelector(".navbar-end").children)).forEach((t=>{if(t.id===e)if("login"===e){const e=document.querySelector("#login"),t=document.querySelector("#signup");document.querySelector("#loginForm")?(e.classList="navbar-item is-tab is-active",t.classList="navbar-item is-tab"):(e.classList="navbar-item is-tab",t.classList="navbar-item is-tab is-active")}else t.classList="navbar-item is-tab is-active";else"signup"===t.id||(t.classList="navbar-item is-tab")}))};e.exports={Navbar:()=>React.createElement("nav",{className:"navbar is-dark has-shadow"},React.createElement("div",{className:"navbar-brand"},React.createElement("a",{className:"navbar-item",href:"/"},React.createElement("i",{className:"fa-solid fa-scroll"})),React.createElement("a",{className:"navbar-burger",id:"burger",onClick:e=>{e.preventDefault();try{let t=e.currentTarget.parentElement.parentElement.querySelector("#nav-links");e.currentTarget.classList.toggle("is-active"),t.classList.toggle("is-active")}catch(e){console.log(e)}}},React.createElement("span",null),React.createElement("span",null),React.createElement("span",null))),React.createElement("div",{className:"navbar-menu",id:"nav-links"},React.createElement("div",{className:"navbar-start"},React.createElement("a",{id:"home",className:"navbar-item is-tab",href:"/home"},"Home"),React.createElement("a",{id:"create",className:"navbar-item is-tab",href:"/create"},"Create"),React.createElement("a",{id:"library",className:"navbar-item is-tab",href:"/library"},"Library")),React.createElement("div",{className:"navbar-end"},React.createElement("a",{id:"login",className:"navbar-item is-tab",onClick:t},"Login"),React.createElement("a",{id:"signup",className:"navbar-item is-tab",onClick:t},"Sign Up"),React.createElement("a",{id:"signout",className:"navbar-item is-tab"},"Sign Out"),React.createElement("a",{id:"profile",className:"navbar-item is-tab",href:"/profile"},React.createElement("i",{className:"fa-solid fa-user"}))))),initializeNavbar:async(e,n)=>{let a=await fetch("/isLoggedIn"),r=await a.json();t();let s=document.getElementById("signout"),i=document.getElementById("profile"),o=document.getElementById("signup"),l=document.getElementById("login");if(r.loggedIn)s.style.display="flex",i.style.display="flex",o.style.display="none",l.style.display="none",s.addEventListener("click",(async e=>{e.preventDefault();let t=await fetch("/logout");window.localStorage.setItem("partchment-LoadSignUp",!1),window.location.assign(t.url)}));else{s.style.display="none",i.style.display="none",o.style.display="flex",l.style.display="flex";let t=!1;null!=document.getElementById("login-content")&&(t=!0),l.addEventListener("click",(async a=>{if(a.preventDefault(),t)return await e.renderLoginWindow({_csrf:n}),!1;{let e=await fetch("/login");return window.localStorage.setItem("partchment-LoadSignUp",!1),window.location.assign(e.url),!1}})),o.addEventListener("click",(async a=>{if(a.preventDefault(),t)return await e.renderSignUpWindow({_csrf:n}),!1;{let e=await fetch("/login");return window.localStorage.setItem("partchment-LoadSignUp",!0),window.location.assign(e.url),!1}}))}},updateSelectedPage:t}},333:e=>{e.exports={init:async()=>{const e=await fetch("/getToken");await e.json()}}},742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),n=t[0],a=t[1];return 3*(n+a)/4-a},t.toByteArray=function(e){var t,n,s=l(e),i=s[0],o=s[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),d=0,u=o>0?i-4:i;for(n=0;n<u;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===o&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,c[d++]=255&t),1===o&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,a=e.length,r=a%3,s=[],i=16383,o=0,l=a-r;o<l;o+=i)s.push(c(e,o,o+i>l?l:o+i));return 1===r?(t=e[a-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[a-2]<<8)+e[a-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};for(var n=[],a=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=s.length;i<o;++i)n[i]=s[i],a[s.charCodeAt(i)]=i;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,a){for(var r,s,i=[],o=t;o<a;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(n[(s=r)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return i.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},764:(e,t,n)=>{"use strict";const a=n(742),r=n(645),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=l,t.h2=50;const i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|p(e,t);let a=o(n);const r=a.write(e,t);return r!==n&&(a=a.slice(0,r)),a}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return l.from(a,t,n);const r=function(e){if(l.isBuffer(e)){const t=0|h(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?o(0):m(e):"Buffer"===e.type&&Array.isArray(e.data)?m(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),o(e<0?0:0|h(e))}function m(e){const t=e.length<0?0:0|h(e.length),n=o(t);for(let a=0;a<t;a+=1)n[a]=255&e[a];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let a;return a=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(a,l.prototype),a}function h(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(r)return a?-1:V(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){let a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return B(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function y(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function E(e,t,n,a,r){if(0===e.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,a)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,a,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,a,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,a,r){let s,i=1,o=e.length,l=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;i=2,o/=2,l/=2,n/=2}function c(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(r){let a=-1;for(s=n;s<o;s++)if(c(e,s)===c(t,-1===a?0:s-a)){if(-1===a&&(a=s),s-a+1===l)return a*i}else-1!==a&&(s-=s-a),a=-1}else for(n+l>o&&(n=o-l),s=n;s>=0;s--){let n=!0;for(let a=0;a<l;a++)if(c(e,s+a)!==c(t,a)){n=!1;break}if(n)return s}return-1}function v(e,t,n,a){n=Number(n)||0;const r=e.length-n;a?(a=Number(a))>r&&(a=r):a=r;const s=t.length;let i;for(a>s/2&&(a=s/2),i=0;i<a;++i){const a=parseInt(t.substr(2*i,2),16);if(K(a))return i;e[n+i]=a}return i}function w(e,t,n,a){return G(V(t,e.length-n),e,n,a)}function R(e,t,n,a){return G(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function N(e,t,n,a){return G(Y(t),e,n,a)}function x(e,t,n,a){return G(function(e,t){let n,a,r;const s=[];for(let i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),a=n>>8,r=n%256,s.push(r),s.push(a);return s}(t,e.length-n),e,n,a)}function C(e,t,n){return 0===t&&n===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);const a=[];let r=t;for(;r<n;){const t=e[r];let s=null,i=t>239?4:t>223?3:t>191?2:1;if(r+i<=n){let n,a,o,l;switch(i){case 1:t<128&&(s=t);break;case 2:n=e[r+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(s=l));break;case 3:n=e[r+1],a=e[r+2],128==(192&n)&&128==(192&a)&&(l=(15&t)<<12|(63&n)<<6|63&a,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:n=e[r+1],a=e[r+2],o=e[r+3],128==(192&n)&&128==(192&a)&&128==(192&o)&&(l=(15&t)<<18|(63&n)<<12|(63&a)<<6|63&o,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,i=1):s>65535&&(s-=65536,a.push(s>>>10&1023|55296),s=56320|1023&s),a.push(s),r+=i}return function(e){const t=e.length;if(t<=L)return String.fromCharCode.apply(String,e);let n="",a=0;for(;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=L));return n}(a)}l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return d(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(J(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,a=t.length;for(let r=0,s=Math.min(n,a);r<s;++r)if(e[r]!==t[r]){n=e[r],a=t[r];break}return n<a?-1:a<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const a=l.allocUnsafe(t);let r=0;for(n=0;n<e.length;++n){let t=e[n];if(J(t,Uint8Array))r+t.length>a.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(a,r)):Uint8Array.prototype.set.call(a,t,r);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(a,r)}r+=t.length}return a},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(e,t,n,a,r){if(J(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===r&&(r=this.length),t<0||n>e.length||a<0||r>this.length)throw new RangeError("out of range index");if(a>=r&&t>=n)return 0;if(a>=r)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(r>>>=0)-(a>>>=0),i=(n>>>=0)-(t>>>=0);const o=Math.min(s,i),c=this.slice(a,r),d=e.slice(t,n);for(let e=0;e<o;++e)if(c[e]!==d[e]){s=c[e],i=d[e];break}return s<i?-1:i<s?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return E(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return E(this,e,t,n,!1)},l.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}const r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let s=!1;for(;;)switch(a){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":case"latin1":case"binary":return R(this,e,t,n);case"base64":return N(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const L=4096;function B(e,t,n){let a="";n=Math.min(e.length,n);for(let r=t;r<n;++r)a+=String.fromCharCode(127&e[r]);return a}function T(e,t,n){let a="";n=Math.min(e.length,n);for(let r=t;r<n;++r)a+=String.fromCharCode(e[r]);return a}function k(e,t,n){const a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);let r="";for(let a=t;a<n;++a)r+=Z[e[a]];return r}function A(e,t,n){const a=e.slice(t,n);let r="";for(let e=0;e<a.length-1;e+=2)r+=String.fromCharCode(a[e]+256*a[e+1]);return r}function S(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,n,a,r,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function M(e,t,n,a,r){$(t,a,r,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let i=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,n}function D(e,t,n,a,r){$(t,a,r,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let i=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=i,i>>=8,e[n+2]=i,i>>=8,e[n+1]=i,i>>=8,e[n]=i,n+8}function P(e,t,n,a,r,s){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(e,t,n,a,s){return t=+t,n>>>=0,s||P(e,0,n,4),r.write(e,t,n,a,23,4),n+4}function _(e,t,n,a,s){return t=+t,n>>>=0,s||P(e,0,n,8),r.write(e,t,n,a,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const a=this.subarray(e,t);return Object.setPrototypeOf(a,l.prototype),a},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=this[e],r=1,s=0;for(;++s<t&&(r*=256);)a+=this[e+s]*r;return a},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=this[e+--t],r=1;for(;t>0&&(r*=256);)a+=this[e+--t]*r;return a},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Q((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const a=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(a)+(BigInt(r)<<BigInt(32))})),l.prototype.readBigUInt64BE=Q((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const a=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(a)<<BigInt(32))+BigInt(r)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=this[e],r=1,s=0;for(;++s<t&&(r*=256);)a+=this[e+s]*r;return r*=128,a>=r&&(a-=Math.pow(2,8*t)),a},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=t,r=1,s=this[e+--a];for(;a>0&&(r*=256);)s+=this[e+--a]*r;return r*=128,s>=r&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||S(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||S(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Q((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const a=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(a)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=Q((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const a=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(a)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||S(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||S(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||S(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||S(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,a){e=+e,t>>>=0,n>>>=0,a||U(this,e,t,n,Math.pow(2,8*n)-1,0);let r=1,s=0;for(this[t]=255&e;++s<n&&(r*=256);)this[t+s]=e/r&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,a){e=+e,t>>>=0,n>>>=0,a||U(this,e,t,n,Math.pow(2,8*n)-1,0);let r=n-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Q((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Q((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);U(this,e,t,n,a-1,-a)}let r=0,s=1,i=0;for(this[t]=255&e;++r<n&&(s*=256);)e<0&&0===i&&0!==this[t+r-1]&&(i=1),this[t+r]=(e/s>>0)-i&255;return t+n},l.prototype.writeIntBE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);U(this,e,t,n,a-1,-a)}let r=n-1,s=1,i=0;for(this[t+r]=255&e;--r>=0&&(s*=256);)e<0&&0===i&&0!==this[t+r+1]&&(i=1),this[t+r]=(e/s>>0)-i&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Q((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Q((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return _(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return _(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,a){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);const r=a-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,a):Uint8Array.prototype.set.call(e,this.subarray(n,a),t),r},l.prototype.fill=function(e,t,n,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!l.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===e.length){const t=e.charCodeAt(0);("utf8"===a&&t<128||"latin1"===a)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{const s=l.isBuffer(e)?e:l.from(e,a),i=s.length;if(0===i)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=s[r%i]}return this};const H={};function q(e,t,n){H[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",n=e.length;const a="-"===e[0]?1:0;for(;n>=a+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function $(e,t,n,a,r,s){if(e>n||e<t){const a="bigint"==typeof t?"n":"";let r;throw r=s>3?0===t||t===BigInt(0)?`>= 0${a} and < 2${a} ** ${8*(s+1)}${a}`:`>= -(2${a} ** ${8*(s+1)-1}${a}) and < 2 ** ${8*(s+1)-1}${a}`:`>= ${t}${a} and <= ${n}${a}`,new H.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||j(t,e.length-(n+1))}(a,r,s)}function F(e,t){if("number"!=typeof e)throw new H.ERR_INVALID_ARG_TYPE(t,"number",e)}function j(e,t,n){if(Math.floor(e)!==e)throw F(e,n),new H.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new H.ERR_BUFFER_OUT_OF_BOUNDS;throw new H.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}q("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),q("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),q("ERR_OUT_OF_RANGE",(function(e,t,n){let a=`The value of "${e}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=z(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=z(r)),r+="n"),a+=` It must be ${t}. Received ${r}`,a}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function V(e,t){let n;t=t||1/0;const a=e.length;let r=null;const s=[];for(let i=0;i<a;++i){if(n=e.charCodeAt(i),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===a){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Y(e){return a.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,a){let r;for(r=0;r<a&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const a=16*n;for(let r=0;r<16;++r)t[a+r]=e[n]+e[r]}return t}();function Q(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},645:(e,t)=>{t.read=function(e,t,n,a,r){var s,i,o=8*r-a-1,l=(1<<o)-1,c=l>>1,d=-7,u=n?r-1:0,m=n?-1:1,f=e[t+u];for(u+=m,s=f&(1<<-d)-1,f>>=-d,d+=o;d>0;s=256*s+e[t+u],u+=m,d-=8);for(i=s&(1<<-d)-1,s>>=-d,d+=a;d>0;i=256*i+e[t+u],u+=m,d-=8);if(0===s)s=1-c;else{if(s===l)return i?NaN:1/0*(f?-1:1);i+=Math.pow(2,a),s-=c}return(f?-1:1)*i*Math.pow(2,s-a)},t.write=function(e,t,n,a,r,s){var i,o,l,c=8*s-r-1,d=(1<<c)-1,u=d>>1,m=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=a?0:s-1,h=a?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=d):(i=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-i))<1&&(i--,l*=2),(t+=i+u>=1?m/l:m*Math.pow(2,1-u))*l>=2&&(i++,l/=2),i+u>=d?(o=0,i=d):i+u>=1?(o=(t*l-1)*Math.pow(2,r),i+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,r),i=0));r>=8;e[n+f]=255&o,f+=h,o/=256,r-=8);for(i=i<<r|o,c+=r;c>0;e[n+f]=255&i,f+=h,i/=256,c-=8);e[n+f-h]|=128*p}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}(()=>{const e=n(832),t=n(401),a=n(986),r=n(984),s=n(911),i=n(316),o=n(856),l=n(333);n(603),window.onload=async()=>{const n=await fetch("/getToken"),c=await n.json();if(null!=document.getElementById("navbar")){ReactDOM.render(React.createElement(o.Navbar,{csrf:c.csrfToken}),document.getElementById("navbar"));const e={renderLoginWindow:i.renderLoginWindow,renderSignUpWindow:i.renderSignUpWindow};o.initializeNavbar(e,c.csrfToken)}let d=document.querySelector("header").getAttribute("data-current-page");switch(d){case"create":e.init();break;case"editNovel":t.init();break;case"editChapter":a.init();break;case"home":r.init();break;case"library":s.init();break;case"login":await i.init(),"true"===localStorage.getItem("partchment-LoadSignUp")&&(console.log("controller login"),console.log(c),i.renderSignUpWindow({_csrf:c.csrfToken}),window.localStorage.setItem("partchment-LoadSignUp",!1)),o.updateSelectedPage();break;case"profile":l.init();break;default:console.log(`unknown page: ${d}`)}}})()})();