/*! For license information please see controllerBundle.js.LICENSE.txt */
(()=>{var e={832:(e,t,n)=>{const a=n(603),r=n(764).lW,o=e=>React.createElement("div",null,React.createElement("div",{className:"box",style:{minHeight:"100vh"}},React.createElement("h1",{className:"title"},"My Novels:"),React.createElement("hr",null),React.createElement("div",{id:"novel-cards",className:"is-flex",style:{gap:10}}))),s=e=>{const t=r.from(e.novel.cover.data,"base64").toString("base64"),n=`data:${e.novel.coverMime};base64,${t}`;return React.createElement("div",{style:{border:"ridge thin",width:200,height:360},onMouseEnter:t=>{const n=document.getElementById(`${e.novel.title}-title`);n.classList.add("is-size-4"),n.classList.remove("is-size-5"),t.currentTarget.style.width=250,t.currentTarget.style.height=450},onMouseLeave:t=>{const n=document.getElementById(`${e.novel.title}-title`);n.classList.add("is-size-5"),n.classList.remove("is-size-4"),t.currentTarget.style.width=200,t.currentTarget.style.height=360},onClick:t=>{console.log(`Card clicked: ${t.currentTarget}`),window.localStorage.setItem("partchment-editorNovelID",e.novel._id),window.location.assign("/editNovel")}},React.createElement("div",{className:"card"},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${e.novel.title}-img`,src:n,alt:"Placeholder image"})))),React.createElement("h1",{id:`${e.novel.title}-title`,className:"is-size-5 has-text-centered has-text-grey",style:{overflow:"hidden"}},e.novel.title))},l=e=>React.createElement("div",{className:"card",style:{width:200},onMouseEnter:e=>{e.currentTarget.style.width=250},onMouseLeave:e=>{e.currentTarget.style.width=200},onClick:t=>{c(e)}},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:"/assets/img/AddCard.png",alt:"Placeholder image"})))),i=async e=>{const t=await fetch("/getLoggedInAs"),n=await t.json();console.log(n);const r=n.username;ReactDOM.render(React.createElement(o,{csrf:e}),document.getElementById("create-content")),a.sendPost("/searchNovelsByUser",{user:r,_csrf:e},(t=>{t.error||(console.log(t),novels=t.novels,console.log(novels),Object.values(novels).forEach((t=>{const n=t.title.toLowerCase().replace(" ","_"),a=document.createElement("div");a.id=n,document.getElementById("novel-cards").appendChild(a),ReactDOM.render(React.createElement(s,{csrf:e,novel:t}),document.getElementById(n))})));const n="empty-card",a=document.createElement("div");a.id=n,document.getElementById("novel-cards").appendChild(a),ReactDOM.render(React.createElement(l,{csrf:e}),document.getElementById(n))}))},c=e=>{const t=e=>React.createElement("div",null,React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{height:65,width:"100vw",border:"thin ridge"}},React.createElement("div",{className:"column is-offset-0"},React.createElement("a",{className:"button is-white",onClick:()=>{i(e.csrf)}},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back"))),React.createElement("div",{style:{height:10}}),React.createElement("form",{id:"createNovelForm",name:"createNovelForm",onSubmit:handleCreateNovel,action:"/createNovel",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Create A New Novel!")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"title"},"Title: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"title",type:"text",name:"title",placeholder:"Title"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-book"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label"},"Book Cover: "),React.createElement("div",{className:""},React.createElement("div",{className:"file is-boxed has-name is-info"},React.createElement("label",{className:"file-label"},React.createElement("input",{className:"file-input",id:"cover",type:"file",name:"cover",onChange:async e=>{const t=e.currentTarget.files[0];if(!t)return;const n=new FileReader;n.addEventListener("load",(()=>{const e=n.result;document.querySelector("#coverPreview").src=e,document.querySelector("#fileName").innerHTML=t.name})),n.readAsDataURL(t)}}),React.createElement("span",{className:"file-cta"},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fas fa-upload"})),React.createElement("span",{className:"file-label"},"Choose a file…")),React.createElement("span",{id:"fileName",className:"file-name"},"Use a 2:3 aspect ratio"))),React.createElement("div",{className:"",style:{width:200}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:"coverPreview",src:"/assets/img/1080x1920.png",alt:"Placeholder image"}))))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"create-novel-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Create"}))));ReactDOM.render(React.createElement(t,{csrf:e.csrf}),document.getElementById("create-content"))};handleCreateNovel=e=>{e.preventDefault();const t=document.getElementById("title").value,n=document.getElementById("cover"),r=document.getElementById("create-novel-error-span"),o=e.target.querySelector("#_csrf").value;if(!t)return void(r.innerHTML="Title is required!");const s=n.files[0];if(!s||void 0===s)return void(r.innerHTML="Cover is required!");const l={_csrf:o,formData:new FormData(document.querySelector("#createNovelForm"))};a.sendMultipartPost("/createNovel",l,d)};const d=e=>{i(e.csrfToken)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();i(t.csrfToken)}}},986:(e,t,n)=>{const a=n(603);let r,o,s=!0;const l=e=>{console.log("props"),console.log(e);let t=e.chapter,n=!1;const l=async n=>{const r="Publish"===document.getElementById("publish-button").innerText,o=()=>{const e=document.getElementById("publish-button"),n=document.getElementById("publish-icon"),a=document.createTextNode("Publish");e.innerHTML="",console.log("Chapter"),console.log(t),t.published?(a.textContent="Unpublish",e.classList.add("is-danger"),e.classList.remove("is-primary"),n.className="fa-solid fa-x"):(a.textContent="Publish",e.classList.remove("is-danger"),e.classList.add("is-primary"),n.className="fa-solid fa-check"),e.appendChild(n),e.appendChild(a)};if(r)w("publish chapter",(r=>{console.log(t);const s={chapterID:t._id,novelID:t.novelID,chapter:t.chapter,chapterNumber:r.chapterNumber,mode:r.mode,referenceChapter:r.chapter,_csrf:e.csrf};a.sendPost("/publishChapter",s,(r=>{console.log("pubChapterResponse"),console.log(r),"novel not published"===r.error?w("publish novel",(()=>{console.log("publish novel"),a.sendPost("/publishNovel",{novelID:t.novelID,published:!0,_csrf:e.csrf},(e=>{console.log(e),e.error?console.log("Could not publish the novel"):l(n)}))})):r.error?(console.log("error publishing"),document.getElementById("modal").classList.remove("is-active")):(console.log("published!"),document.getElementById("modal").classList.remove("is-active"),t=r.chapter,console.log(e),o())}))}));else{const n={chapterID:t._id,novelID:t.novelID,chapter:t.chapter,mode:"unpublish",_csrf:e.csrf};await a.sendPost("/publishChapter",n,(n=>{console.log("unPubResponse"),console.log(n),t=n.chapter,console.log(e),o()}))}},i=e=>{switch(e.key){case"Control":n=!0;break;case"b":n&&(e.preventDefault(),console.log("bold"),m());break;case"i":n&&(e.preventDefault(),p());break;case"u":n&&(e.preventDefault(),f())}},c=e=>{"Control"===e.key&&(n=!1)},d=n=>{if(s)return;console.log("updating...");const o=document.getElementById("editable-chapter-content"),l=document.getElementById("saved-span");if(l.innerHTML="Unsaved",l.classList.remove("is-success"),l.classList.add("is-warning"),o.innerText.length<=1){const e=document.getElementById("font-drop-text"),t=document.getElementById("text-size"),n=document.createElement("span");n.classList.add(`${e.getAttribute("data-font")}-font-span`),n.classList.add(`font-size-${t.value}-span`),n.innerText=o.innerText,o.innerHTML="",o.appendChild(n);const a=document.createRange(),r=window.getSelection();a.setStart(n,o.innerText.length),a.collapse(!0),r.removeAllRanges(),r.addRange(a)}const i=e=>{if(e.hasChildNodes())e.childNodes.forEach((e=>{i(e)}));else if(e.textContent&&-1!=e.textContent.indexOf("​")){const t=window.getSelection();if(t.rangeCount<=0)return void(e.textContent=e.textContent.replace("​",""));const n=t.getRangeAt(0);let a;n.startOffset===n.endOffset&&(a=n.startOffset);let r=n.commonAncestorContainer.parentElement;if(e.textContent=e.textContent.replace("​",""),r.isEqualNode(e.parentElement)){const t=document.createRange(),n=window.getSelection();a&&a>0?t.setStart(e,a-1):t.setStart(e,e.textContent.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t)}}};i(o),r&&(clearInterval(r),r=null),r=setInterval((async()=>{console.log("update content"),clearInterval(r),r=null,console.log(t),await a.sendPost("/editChapter",{chapterID:t._id,content:o.innerHTML,_csrf:e.csrf},(e=>{e.error?(console.log(e.error),l.innerHTML="Error",l.classList.remove("is-warning"),l.classList.remove("is-success"),l.classList.add("is-error")):(l.innerHTML="Saved",l.classList.remove("is-warning"),l.classList.remove("is-error"),l.classList.add("is-success"))}))}),1e3)},u=e=>{const t=window.getSelection();if(t.rangeCount<=0)return!1;const n=t.getRangeAt(0);let r=n.commonAncestorContainer.parentElement;if(!a.isDescendent(document.getElementById("textDiv"),r)&&!r.isEqualNode(document.getElementById("textDiv")))return!1;if(r.isEqualNode(document.getElementById("saved-span")))return!1;if(0===n.cloneContents().childNodes.length){const e=document.getElementById("bold-button"),t=document.getElementById("italic-button"),n=document.getElementById("underline-button");r.classList.contains("bold-span")?(e.classList.remove("is-outlined"),e.classList.add("is-dark")):(e.classList.add("is-outlined"),e.classList.remove("is-dark")),r.classList.contains("italic-span")?(t.classList.remove("is-outlined"),t.classList.add("is-dark")):(t.classList.add("is-outlined"),t.classList.remove("is-dark")),r.classList.contains("underline-span")?(n.classList.remove("is-outlined"),n.classList.add("is-dark")):(n.classList.add("is-outlined"),n.classList.remove("is-dark"))}},m=async()=>{g("bold-span")&&(console.log("updating"),d())},p=()=>{g("italic-span")&&d()},f=()=>{g("underline-span")&&d()},h=e=>{const t=`${e.currentTarget.getAttribute("data-font")}-font-span`,n=document.getElementById("font-drop-text");n.innerHTML=e.currentTarget.innerHTML,n.className=`${e.currentTarget.getAttribute("data-font")}-font-span`,n.setAttribute("data-font",e.currentTarget.getAttribute("data-font")),console.log("font span class"),console.log(t)},g=e=>{const t=window.getSelection();if(t.rangeCount<=0)return!1;const n=t.getRangeAt(0);let r=n.commonAncestorContainer.parentElement,o=r.cloneNode(!0);if(!a.isDescendent(document.getElementById("textDiv"),r)&&!r.isEqualNode(document.getElementById("textDiv")))return!1;if(r.isEqualNode(document.getElementById("saved-span")))return!1;let s=r.classList;const l=n.extractContents();if(0===l.childNodes.length&&(console.log("no children"),!r.classList.contains(e))){const a=document.createElement("span");a.className=e,a.innerHTML="&#8203",console.log(a),n.insertNode(a);const r=document.createRange();return r.setStart(a,1),r.collapse(!0),t.removeAllRanges(),void t.addRange(r)}const i=Array.from(l.childNodes);let c;n.insertNode(l);let d=!1;"SPAN"===r.tagName?(d=!0,c=Array.from(r.childNodes),r.remove()):(r=document.getElementById("editable-chapter-content"),o=r.cloneNode(!0),c=Array.from(r.childNodes),r.innerHTML="");const u=[],m=y(c,i);m.firstNodesToAdd.forEach((e=>{let t=e;d&&(3===e.nodeType?(t=document.createElement("span"),t.classList=s,t.innerText=e.textContent):"SPAN"===e.tagName?s.forEach((e=>{t.classList.add(e)})):console.log("firstNodeToAdd had unhandled nodeType")),u.unshift(t)}));let p=!1;for(const t of o.childNodes){if(console.log(t),1!==t.nodeType){p=!1;break}if(!t.classList.contains(e)){p=!1;break}p=!0}m.selectNodesToAdd.forEach((t=>{let n=t;o.classList.contains(e)||p?3===t.nodeType?(n=document.createElement("span"),n.classList=s,n.classList.remove(e),n.innerHTML=t.textContent):"SPAN"===t.tagName&&n.classList.remove(e):3===t.nodeType?(n=document.createElement("span"),n.classList=s,n.classList.add(e),n.innerHTML=t.textContent):"SPAN"===t.tagName&&n.classList.add(e),u.unshift(n)})),m.lastNodesToAdd.forEach((e=>{let t=e;d&&(3===e.nodeType?(t=document.createElement("span"),t.classList=s,t.innerText=e.textContent):"SPAN"===e.tagName?s.forEach((e=>{t.classList.add(e)})):console.log("lastNodeToAdd had unhandled nodeType")),u.unshift(t)})),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();let f=document.getElementById("editable-chapter-content");u.forEach((e=>{n.insertNode(e)}));const h=f.querySelectorAll("span");let g=[];h.forEach((e=>{""===e.innerText&&g.push(e)})),g.forEach((e=>{e.remove()}));const w=b(f);f.before(w),f.remove(),f=document.getElementById("editable-chapter-content");const R=E(f);return f.before(R),f.remove(),f=document.getElementById("editable-chapter-content"),console.log(f),console.log(f.cloneNode(!0)),v(f),!0},y=(e,t)=>{const n=[],a=[],r=[];return e.forEach((e=>{let o=!1;t.forEach((t=>{e.isEqualNode(t)&&(a.push(t),o=!0)})),o||(0===a.length?n.push(e):r.push(e))})),{firstNodesToAdd:n,selectNodesToAdd:a,lastNodesToAdd:r}},b=e=>{let t=e.cloneNode(!0);for(const e of t.querySelectorAll("span"))if(e.nextElementSibling===e.nextSibling&&null!==e.nextSibling&&"SPAN"===e.nextSibling.tagName){if(0===e.classList.length){const n=document.createTextNode(e.innerText);e.before(n),e.remove(),t=b(t);break}if(e.className===e.nextSibling.className){let n=document.createElement("span");n.classList=e.classList,n.innerText=e.innerText+e.nextSibling.innerText,e.before(n),e.nextElementSibling.remove(),e.remove(),t=b(t);break}}return t},E=e=>{let t=e.cloneNode(!0);for(const e of t.childNodes)if(3==e.nodeType&&e.nextSibling&&3===e.nextSibling.nodeType){let n=document.createTextNode(e.textContent+e.nextSibling.textContent);e.before(n),e.nextSibling.remove(),e.remove(),t=b(t);break}return t},v=e=>{e.addEventListener("input",d),e.addEventListener("click",u),e.addEventListener("keyDown",i),e.addEventListener("keyUp",c)},w=(n,r)=>{const s=document.getElementById("modal-text-area"),l=document.getElementById("modal"),i=document.getElementById("modal-yes-button"),c=document.getElementById("modal-cancel-button"),d=document.getElementById("modal-title");switch(i.disabled=!1,n){case"publish novel":s.innerHTML="";const n=document.createElement("p"),u=document.createElement("p");n.innerText="This chapter cannot be published because the novel is not published.",u.innerText="Would you like to publish the novel ? ",s.appendChild(n),s.appendChild(u),i.style.visibility="visible",i.innerText="Yes",i.removeEventListener("click",o),o=r,i.addEventListener("click",r),c.innerText="Cancel",d.innerText="Novel Not Published",l.classList.add("is-active");break;case"publish chapter":s.innerHTML="",i.disabled=!0,a.sendPost("/searchNovelByID",{novelID:t.novelID,_csrf:e.csrf},(e=>{console.log(e);const t=[];Object.keys(e.novel.chapters).forEach((e=>{e.includes("chapter-")&&t.push(e)}));const n=document.createElement("div");n.style.border="ridge thin",n.style.height="350px",n.style.overflowY="auto";for(const e of t){const t=document.createElement("div");t.id="chap-option-container",t.setAttribute("data-selected","false");const a=()=>{let e=!1;"true"===t.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option-container").forEach((e=>{e.setAttribute("data-selected","false")}));let a=!1;t.childNodes.forEach((e=>{"true"===e.getAttribute("data-selected")&&(a=!0)})),e&&!a||t.setAttribute("data-selected","true")},r=document.createElement("span");r.id="chap-insert",r.setAttribute("insert","before");const o=document.createElement("i");o.className="fa-solid fa-arrow-up";const s=document.createElement("p");s.innerText="insert before",r.style.border="thin ridge",r.className="has-text-grey",r.style.display="flex",r.style.alignItems="center",r.style.gap="10px",r.style.height="30px",r.appendChild(o),r.appendChild(s),r.style.visibility="hidden",r.style.display="none";const l=()=>{"true"===r.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#62c462",s.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#ffc9c9",s.style.fontSize="20px"):(r.style.height="30px",r.style.backgroundColor="#ffffff",s.style.fontSize="17px")};r.onmouseenter=()=>{r.style.height="40px",r.style.backgroundColor="#bbf0de",r.style.fontSize="20px"},r.onmouseleave=()=>{"true"===r.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#62c462",s.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(r.style.height="40px",r.style.backgroundColor="#ffc9c9",s.style.fontSize="20px"):(r.style.height="30px",r.style.backgroundColor="#ffffff",s.style.fontSize="17px")},r.onclick=()=>{let e=!1;"true"===r.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),e||r.setAttribute("data-selected","true"),a(),console.log("here"),y()};const c=document.createElement("span");c.id="chap-insert",c.setAttribute("insert","after");const d=document.createElement("i");d.className="fa-solid fa-arrow-down";const u=document.createElement("p");u.innerText="insert After",c.style.border="thin ridge",c.className="has-text-grey",c.style.display="flex",c.style.alignItems="center",c.style.gap="10px",c.style.height="30px",c.appendChild(d),c.appendChild(u),c.style.visibility="hidden",c.style.display="none";const m=()=>{"true"===c.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#62c462",u.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#ffc9c9",u.style.fontSize="20px"):(c.style.height="30px",c.style.backgroundColor="#ffffff",u.style.fontSize="17px")};c.onchange=m,c.onmouseenter=()=>{c.style.height="40px",c.style.backgroundColor="#bbf0de",c.style.fontSize="20px"},c.onmouseleave=()=>{"true"===c.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#62c462",u.style.fontSize="20px"):"true"===t.getAttribute("data-selected")?(c.style.height="40px",c.style.backgroundColor="#ffc9c9",u.style.fontSize="20px"):(c.style.height="30px",c.style.backgroundColor="#ffffff",u.style.fontSize="17px")},c.onclick=()=>{let e=!1;"true"===c.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),e||c.setAttribute("data-selected","true"),a(),y()};const p=document.createElement("span");p.id="chap-option";const f=document.createElement("i"),h=document.createElement("p");p.style.border="thin ridge",p.className="has-text-grey",p.style.display="flex",p.style.alignItems="center",p.style.gap="10px",p.style.height="30px",f.className="fa-solid fa-repeat",h.innerText=e,h.style.fontSize="17px";const g=()=>{"true"===p.getAttribute("data-selected")?(p.style.height="40px",p.style.backgroundColor="#62c462",h.style.fontSize="20px"):"true"===p.parentElement.getAttribute("data-selected")?(p.style.height="40px",p.style.backgroundColor="#ffc9c9",h.style.fontSize="20px"):(p.style.height="30px",p.style.backgroundColor="#ffffff",h.style.fontSize="17px")};p.onchange=g,p.onmouseenter=()=>{p.style.height="40px",p.style.backgroundColor="#bbf0de",h.style.fontSize="20px"},p.onmouseleave=()=>{"true"!==p.getAttribute("data-selected")?"true"===t.getAttribute("data-selected")?(p.style.height="40px",p.style.backgroundColor="#ffc9c9",h.style.fontSize="20px"):(p.style.height="30px",p.style.backgroundColor="#ffffff",h.style.fontSize="17px"):(p.style.height="40px",p.style.backgroundColor="#62c462",h.style.fontSize="20px")},p.onclick=()=>{let e=!1;"true"===p.getAttribute("data-selected")&&(e=!0),n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false"),e.style.height="30px",e.style.backgroundColor="#ffffff",e.style.fontSize="17px"})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false"),e.style.visibility="hidden",e.style.display="none"})),e?i.disabled=!0:(p.setAttribute("data-selected","true"),r.style.visibility="visible",c.style.visibility="visible",r.style.display="flex",c.style.display="flex",i.disabled=!1),a(),y()};const y=()=>{m(),l(),g()};p.appendChild(f),p.appendChild(h),t.appendChild(r),t.appendChild(p),t.appendChild(c),n.appendChild(t)}if(console.log(n),""===n.innerText){const e=document.createElement("p");e.innerText="This is the first chapter!",n.appendChild(e)}const a=document.createElement("a");a.className="button is-link",a.innerText="Publish As latest Chapter",a.style.marginBottom="10px",a.addEventListener("click",(()=>{r({chapterNumber:t.length,mode:"add-last"})}));const u=document.createElement("p");u.innerText="Or, Choose where to add it: ",u.className="subtitle",u.style.marginTop="10px",s.appendChild(a),s.appendChild(u),s.appendChild(n),i.style.visibility="visible",i.innerText="Publish";const m=()=>{n.querySelectorAll("span").forEach((e=>{if("true"===e.getAttribute("data-selected")){const t=e.parentElement.querySelector("#chap-option").querySelector("p").innerText;"chap-option"===e.id?r({chapter:t,mode:"replace"}):"chap-insert"===e.id&&("before"==e.getAttribute("insert")?r({chapter:t,mode:"insert-before"}):"after"==e.getAttribute("insert")&&r({chapter:t,mode:"insert-after"}))}}))};o&&i.removeEventListener("click",o),o=m,i.addEventListener("click",m),c.innerText="Cancel",d.innerText="Publish Chapter",l.classList.add("is-active")}));break;case"preview":s.innerHTML="";const m=document.createElement("p");m.innerText=t.content,s.appendChild(m),s.value=t.content,s.rows="1",i.style.visibility="hidden",c.innerText="Cancel",d.innerText=t.title,l.classList.add("is-active")}},R=()=>{document.getElementById("modal").classList.remove("is-active")};return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal",style:{zIndex:1001}},React.createElement("div",{className:"modal-background",onClick:e=>{(document.querySelectorAll(".modal")||[]).forEach((e=>{e.classList.remove("is-active")}))}}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:R})),React.createElement("section",{className:"modal-card-body"},React.createElement("div",{id:"modal-text-area"})),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-yes-button",className:"button is-success",onClick:R},"Yes"),React.createElement("button",{id:"modal-cancel-button",className:"button",onClick:R},"Cancel")))),React.createElement("div",{id:"editor-head",style:{position:"sticky",top:"0px",backgroundColor:"white",border:"thin ridge",zIndex:1e3}},React.createElement("div",{style:{height:65,width:"100vw",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",null,React.createElement("a",{className:"button is-white",href:"/editNovel"},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back")),React.createElement("div",{style:{display:"flex",flexFlow:"row",gap:10}},React.createElement("a",{id:"preview-button",className:"button is-link",onClick:e=>{console.log("preview!")}},React.createElement("i",{className:"fa-solid fa-eye",style:{padding:"0 10 0 0"}}),"Preview"),React.createElement("a",{id:"publish-button",className:"button is-primary",onClick:l},React.createElement("i",{id:"publish-icon",className:"fa-solid fa-check",style:{padding:"0 10 0 0"}}),"Publish"))),React.createElement("div",{id:"editor-controls",style:{height:40,width:"100vw",display:"flex",flexFlow:"row",justifyContent:"center",gap:"15px",margin:"0px 10px 10px 10px"}},React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"bold-button",className:"button is-outlined",onClick:m},React.createElement("i",{className:"fa-solid fa-bold"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"italic-button",className:"button is-outlined",onClick:p},React.createElement("i",{className:"fa-solid fa-italic"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"underline-button",className:"button is-outlined",onClick:f},React.createElement("i",{className:"fa-solid fa-underline"}))),React.createElement("span",{className:"dropdown",onClick:e=>{e.currentTarget.classList.toggle("is-active")}},React.createElement("div",{className:"dropdown-trigger"},React.createElement("button",{className:"button","aria-haspopup":"true","aria-controls":"dropdown-menu"},React.createElement("span",{id:"font-drop-text",className:"georgia-font-span","data-font":"georgia",style:{width:"120px",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis"}},"Georgia"),React.createElement("span",{className:"icon is-small"},React.createElement("i",{className:"fas fa-angle-down","aria-hidden":"true"})))),React.createElement("div",{id:"dropdown-menu",className:"dropdown-menu",role:"menu"},React.createElement("div",{className:"dropdown-content"},React.createElement("a",{className:"dropdown-item georgia-font-span","data-font":"georgia",onClick:h},"Georgia"),React.createElement("a",{className:"dropdown-item times-new-roman-font-span","data-font":"times-new-roman",onClick:h},"Times New Roman"),React.createElement("a",{className:"dropdown-item arial-font-span","data-font":"arial",onClick:h},"Arial")))),React.createElement("span",{style:{display:"flex",border:"ridge thin"}},React.createElement("a",{className:"button is-white",onClick:e=>{const t=document.getElementById("text-size");let n=parseInt(t.value)-1;n<=0?n=1:n>=100&&(n=100),t.value=n},style:{height:"38px"}},React.createElement("i",{className:"fa-solid fa-minus"})),React.createElement("input",{id:"text-size",className:"input",type:"number",name:"text-size",defaultValue:"20",min:"0",max:"100",onBlur:e=>{const t=document.getElementById("text-size");let n=parseInt(t.value);n<=0?n=1:n>=100&&(n=100),t.value=n},style:{width:"70px",height:"38px"}}),React.createElement("a",{className:"button is-white",onClick:e=>{const t=document.getElementById("text-size");let n=parseInt(t.value)+1;n<=0?n=1:n>=100&&(n=100),t.value=n},style:{height:"38px"}},React.createElement("i",{className:"fa-solid fa-plus"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"left-align-button",className:"button is-dark",onClick:e=>{const t=document.getElementById("left-align-button"),n=document.getElementById("center-align-button"),a=document.getElementById("right-align-button");t.classList.add("is-dark"),t.classList.remove("is-outlined"),n.classList.remove("is-dark"),n.classList.add("is-outlined"),a.classList.remove("is-dark"),a.classList.add("is-outlined")}},React.createElement("i",{className:"fa-solid fa-align-left"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"center-align-button",className:"button is-outlined",onClick:e=>{const t=document.getElementById("left-align-button"),n=document.getElementById("center-align-button"),a=document.getElementById("right-align-button");t.classList.remove("is-dark"),t.classList.add("is-outlined"),n.classList.add("is-dark"),n.classList.remove("is-outlined"),a.classList.remove("is-dark"),a.classList.add("is-outlined")}},React.createElement("i",{className:"fa-solid fa-align-center"}))),React.createElement("span",{style:{textAlign:"center"}},React.createElement("a",{id:"right-align-button",className:"button is-outlined",onClick:e=>{const t=document.getElementById("left-align-button"),n=document.getElementById("center-align-button"),a=document.getElementById("right-align-button");t.classList.remove("is-dark"),t.classList.add("is-outlined"),n.classList.remove("is-dark"),n.classList.add("is-outlined"),a.classList.add("is-dark"),a.classList.remove("is-outlined")}},React.createElement("i",{className:"fa-solid fa-align-right"}))))),React.createElement("div",{id:"text-root",style:{display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center",width:"100vw",minHeight:"900px",marginBottom:"50px"}},React.createElement("div",{id:"title-div-container",style:{width:"720px",margin:0}},React.createElement("div",{id:"title-div",className:"title",contentEditable:"true",style:{marginTop:20,marginBottom:20,outline:"0px solid transparent"},onSelect:e=>{e.currentTarget.spellcheck=!0},onBlur:async n=>{console.log("update chap title");const r=document.getElementById("title-div");r.spellcheck=!1,console.log(t),await a.sendPost("/editChapter",{chapterID:t._id,title:r.innerHTML,_csrf:e.csrf},(e=>{console.log("response"),console.log(e),r.innerHTML=e.title}))}})),React.createElement("div",{id:"textDiv",style:{position:"relative",display:"block",width:"720px",minHeight:"900px",paddingBottom:"5px",borderWidth:"thick",border:"solid"}},React.createElement("span",{id:"saved-span",className:"tag is-success",style:{position:"absolute",bottom:"5px",right:"10px"}},"Saved"),React.createElement("div",{id:"editable-chapter-content",name:"textArea",contentEditable:"true",style:{padding:"3%",outline:"0px solid transparent",width:"100%",height:"100%"},onInput:d,onClick:u,onKeyDown:i,onKeyUp:c}))))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json(),n=localStorage.getItem("partchment-editorChapterID");if(!n)return console.log("No Chapter Selected"),void window.location.assign("/editNovel");a.sendPost("/searchChapterByID",{chapterID:n,_csrf:t.csrfToken},(e=>{console.log("chapterData"),console.log(e),"No Chapter Found"!==e.error?(ReactDOM.render(React.createElement(l,{csrf:t.csrfToken,chapter:e.chapter}),document.getElementById("edit-chapter-content")),(e=>{document.getElementById("title-div").innerHTML=e.title;const t=document.getElementById("publish-button"),n=document.getElementById("publish-icon"),a=document.createTextNode("Publish");t.innerHTML="",e.published?(a.textContent="Unpublish",t.classList.add("is-danger"),t.classList.remove("is-primary"),n.className="fa-solid fa-x"):(a.textContent="Publish",t.classList.remove("is-danger"),t.classList.add("is-primary"),n.className="fa-solid fa-check"),t.appendChild(n),t.appendChild(a),document.getElementById("editable-chapter-content").innerHTML=e.content,s=!1})(e.chapter)):window.location.assign("/editNovel")}))}}},401:(e,t,n)=>{const a=n(603),r=n(764).lW,o=n(441),s=e=>{console.log("edit novel window"),console.log(e);let t=e.novel,n="False";t.published&&(n="True");const s=r.from(t.cover.data,"base64").toString("base64"),l=`data:${t.coverMime};base64,${s}`,d=new Date(t.createdDate).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return React.createElement("div",null,React.createElement("div",{id:"modal",className:"modal"},React.createElement("div",{className:"modal-background",onClick:o.closeAllModals}),React.createElement("div",{className:"modal-card"},React.createElement("header",{className:"modal-card-head"},React.createElement("p",{id:"modal-title",className:"modal-card-title"}),React.createElement("button",{className:"delete","aria-label":"close",onClick:o.closeModal})),React.createElement("section",{id:"modal-card-body",className:"modal-card-body"}),React.createElement("footer",{className:"modal-card-foot"},React.createElement("button",{id:"modal-save-button",className:"button is-success",onClick:o.closeModal},"Save changes"),React.createElement("button",{className:"button",onClick:o.closeModal},"Cancel")))),React.createElement("div",{className:"box",style:{minHeight:"80vh",width:"100vw",margin:"auto",padding:0}},React.createElement("div",{className:"",style:{height:65,width:"100vw",margin:"auto",border:"thin ridge",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",{className:""},React.createElement("a",{className:"button is-white",href:"/create"},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back")),React.createElement("div",{className:""},React.createElement("button",{className:"button is-link",onClick:n=>{a.sendPost("/createChapter",{novelID:t._id,_csrf:e.csrf},(e=>{console.log(e),window.localStorage.setItem("partchment-editorChapterID",e.createdChapter._id),window.location.assign("/editChapter")}))}},React.createElement("i",{className:"fa-solid fa-plus",style:{padding:"0 10 0 0"}})," Create Chapter"))),React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{width:"95vw",margin:"auto"}},React.createElement("div",{className:"column",style:{maxWidth:"300px",margin:"auto"}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${t.title}-img`,src:l,alt:"Placeholder image"}))),React.createElement("div",{className:"column is-three-quarters",style:{height:"34.35vw",minHeight:"250px",display:"flex",flexFlow:"column"}},React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h1",{id:"novel-title",className:"title",style:{margin:0,paddingRight:"10px"}},t.title),React.createElement("a",{onClick:n=>{const r=document.getElementById("novel-title");console.log("Update title"),o.openModal({modalType:"title",title:t.title},(n=>{const o=document.createElement("span");o.classList="bulma-loader-mixin",r.appendChild(o),a.sendPost("/editNovel",{novelID:t._id,title:n.title,_csrf:e.csrf},(e=>{console.log(e),e.error&&console.log(e.error),t.title=e.title,r.innerHTML=t.title}))}))},"data-modal-type":"title"},React.createElement("i",{className:"fa-solid fa-pencil"}))),React.createElement("h2",{className:"subtitle"},"By: ",t.author),React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h2",{className:"subtitle",style:{margin:0,paddingRight:"10px"}},"Abstract"),React.createElement("a",{onClick:n=>{document.getElementById("modal-textarea");const r=document.getElementById("abstract-text");o.openModal({modalType:"abstract",abstract:t.abstract},(n=>{const o=document.createElement("span");o.classList="bulma-loader-mixin",r.appendChild(o),a.sendPost("/editNovel",{novelID:t._id,abstract:n.abstract,_csrf:e.csrf},(e=>{e.error&&console.log(e.error),t.abstract=e.abstract,r.innerHTML=t.abstract}))}))},"data-modal-type":"abstract"},React.createElement("i",{className:"fa-solid fa-pencil"}))),React.createElement("div",{id:"abstract-text",style:{height:"100%",width:"100%",minHeight:"100px"}},t.abstract))),React.createElement("div",{className:"box"},React.createElement("ul",null,React.createElement("li",null,"Published Chapters: ",t.publishedChapterCount),React.createElement("li",null,"Unpublished Chapters: ",t.totalChapterCount-t.publishedChapterCount),React.createElement("li",null,"Created Date: ",d),React.createElement("li",null,"Published: ",n),React.createElement("li",null,"Publication Date: ",t.published))),React.createElement("hr",null),React.createElement("div",{style:{marginLeft:"20px",marginRight:"20px"}},React.createElement("div",{className:"tabs is-toggle"},React.createElement("ul",null,React.createElement("li",{id:"chapters-button-li",className:"is-active"},React.createElement("a",{id:"chapters-button",onClick:()=>{const t=document.getElementById("chapters-button-li"),n=document.getElementById("drafts-button-li");t.classList.add("is-active"),n.classList.remove("is-active"),i(e.chapters,e.csrf)}},"Chapters")),React.createElement("li",{id:"drafts-button-li"},React.createElement("a",{id:"drafts-button",onClick:()=>{const t=document.getElementById("chapters-button-li");document.getElementById("drafts-button-li").classList.add("is-active"),t.classList.remove("is-active"),c(e.chapters,e.csrf)}},"Drafts")))),React.createElement("div",{id:"chapters-heading",className:"columns",style:{width:"100%",cursor:"hand",display:"flex",justifyContent:"space-between",borderBottom:"thick solid"}},React.createElement("span",{id:"chapter-number",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Chapter"),React.createElement("span",{id:"chapter-title",className:"column is-three-fifths has-text-weight-bold"},"Title"),React.createElement("span",{id:"chapter-views",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Views"),React.createElement("span",{id:"chapter-publish",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Publish"),React.createElement("span",{id:"chapter-publish",className:"column has-text-weight-bold",style:{textAlign:"center"}},"Delete")),React.createElement("div",{id:"chapters-div",style:{width:"100%",display:"flex",flexFlow:"column",gap:"20px"}}))))},l=e=>{const t=()=>{window.localStorage.setItem("partchment-editorChapterID",e.chapters[e.chapter]._id),window.location.assign("/editChapter")};let n="fa-solid fa-check",r="button is-outline";return e.chapters[e.chapter].published&&(n="fa-solid fa-minus",r="button is-warning"),React.createElement("div",{id:`${e.chapter}-row`,className:"columns",style:{width:"100%",cursor:"hand",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseEnter:()=>{document.getElementById(`${e.chapter}-row`).style.backgroundColor="#bbf0de"},onMouseLeave:()=>{document.getElementById(`${e.chapter}-row`).style.backgroundColor="#ffffff"}},React.createElement("span",{id:"chapter-number",className:"column",style:{textAlign:"center"},onClick:t},e.chapter),React.createElement("span",{id:"chapter-title",className:"column is-three-fifths",onClick:t},e.chapters[e.chapter].title),React.createElement("span",{id:"chapter-views",className:"column",style:{textAlign:"center"},onClick:t},e.chapters[e.chapter].views),React.createElement("span",{id:"chapter-publish",className:"column",style:{textAlign:"center"}},React.createElement("a",{id:"publish-button",className:r,onClick:()=>{console.log("publish chapter"),console.log(e),e.chapters[e.chapter].published?a.publishChapter("unpublish",{chapter:e.chapters[e.chapter],_csrf:e.csrf},(e=>{window.location="/editNovel"})):o.openModal({modalType:"publishChapter",chapter:e.chapters[e.chapter],csrf:e.csrf},(t=>{console.log("modal response"),console.log(t),a.publishChapter(t.mode,{chapter:t.chapter,referenceChapter:t.referenceChapter,_csrf:e.csrf},(e=>{window.location="/editNovel"}))}))}},React.createElement("i",{id:"publish-icon",className:n}))),React.createElement("span",{id:"chapter-publish",className:"column",style:{textAlign:"center"}},React.createElement("a",{id:"delete-button",className:"button is-danger",onClick:()=>{o.openModal({modalType:"deleteChapter",chapter:e.chapters[e.chapter],csrf:e.csrf},(t=>{a.sendPost("/deleteChapter",{chapterID:e.chapters[e.chapter]._id,_csrf:e.csrf},(e=>{console.log(e)}))}))}},React.createElement("i",{id:"delete-icon",className:"fa-solid fa-x"}))))},i=async(e,t)=>{const n=document.getElementById("chapters-div");if(n.innerHTML="",Object.keys(e).forEach((a=>{if(a.includes("chapter")){const r=document.createElement("div");ReactDOM.render(React.createElement(l,{chapter:a,chapters:e,csrf:t}),r),n.appendChild(r)}})),""===n.innerHTML){const e=document.createElement("div");e.innerText="No Published Chapters",n.appendChild(e)}},c=async(e,t)=>{const n=document.getElementById("chapters-div");if(n.innerHTML="",Object.keys(e).forEach((a=>{if(a.includes("draft")){const r=document.createElement("div");ReactDOM.render(React.createElement(l,{chapter:a,chapters:e,csrf:t}),r),n.appendChild(r)}})),""===n.innerHTML){console.log("empty");const e=document.createElement("div");e.innerText="No Drafts",n.appendChild(e)}};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log("init editNovel"),console.log(t);const n=localStorage.getItem("partchment-editorNovelID");if(!n)return console.log("No Novel Selected"),void window.location.assign("/create");a.sendPost("/searchNovelByID",{novelID:n,_csrf:t.csrfToken},(async e=>{console.log(e),"No Novel Found"===e.error&&window.location.assign("/create"),await(async(e,t,n)=>{if(console.log("get chapters"),e.chapters&&0!==Object.keys(e.chapters).length){const r=e.chapters;console.log("chapterIDs"),console.log(r);const o={};for(let e=0;e<Object.keys(r).length;e++){const s=Object.keys(r)[e];await a.sendPost("/searchChapterByID",{chapterID:r[s],_csrf:t},(t=>{if(o[s]=t.chapter,e+1>=Object.keys(r).length)return n(o),o}))}}else n({})})(e.novel,t.csrfToken,(n=>{console.log("chapters"),console.log(n),ReactDOM.render(React.createElement(s,{csrf:t.csrfToken,novel:e.novel,chapters:n}),document.getElementById("edit-novel-content")),i(n,t.csrfToken)}))}))}}},603:e=>{const t=async(e,t,a)=>{if(console.log(e),!t._csrf)return void console.log("Missing CSRF Token, request not sent");const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await r.json();n(o,t,a)},n=(e,t,n)=>{e.error&&console.log(`error: ${e.error}`),e.redirect&&(window.location=e.redirect),n&&(e.csrfToken=t._csrf,n(e))};e.exports={sendPost:t,sendMultipartPost:async(e,t,a)=>{const r=await fetch(e,{method:"POST",body:t.formData}),o=await r.json();n(o,t,a)},isDescendent:(e,t)=>{let n=t.parentNode;for(;n;){if(n===e)return!0;n=n.parentNode}return!1},publishChapter:(e,n,a)=>{const r={};switch(e){case"add-last":case"unpublish":r.chapterID=n.chapter._id,r.novelID=n.chapter.novelID,r.chapter=n.chapter.chapter,r.mode=e;break;case"replace":case"insert-before":case"insert-after":r.chapterID=n.chapter._id,r.novelID=n.chapter.novelID,r.chapter=n.chapter.chapter,r.mode=e,r.referenceChapter=n.referenceChapter;break;default:a("No Mode")}r._csrf=n._csrf,t("/publishChapter",r,a)}}},984:(e,t,n)=>{const a=n(603),r=n(764).lW,o=e=>{let t=1;const n=e=>{let n=document.getElementsByClassName("slide");if(!(t.length<1)){n.length<e&&(t=1),e<1&&(t=n.length);for(let e=0;e<n.length;e++)n[e].style.display="none";n[t-1].style.display="block"}};return React.createElement("div",{style:{minHeight:"90vh",width:"90vw",margin:"auto",marginTop:"20px"}},React.createElement("div",{className:"columns",style:{minHeight:"340px"}},React.createElement("div",{className:"column",style:{maxWidth:"1200px",margin:"auto"}},React.createElement("h1",{className:"title",style:{marginLeft:"10vw"}},"Featured Novels"),React.createElement("div",{id:"featured-carousel",style:{position:"relative"}},React.createElement("div",{id:"carousel-cards"}),React.createElement("a",{className:"prev",onClick:()=>{n(t+=1)}},"❮"),React.createElement("a",{className:"next",onClick:()=>{n(t-=1)}},"❯")))),React.createElement("div",{style:{maxWidth:"1000px",margin:"auto"}},React.createElement("h1",{className:"title"},"Novels"),React.createElement("div",{id:"novel-cards-container"})))},s=e=>{const t=e.novel;console.log("props"),console.log(e);const n=r.from(t.cover.data,"base64").toString("base64"),o=`data:${t.coverMime};base64,${n}`;return React.createElement("div",{id:`${t.title.replace(/ /g,"_")}-card`,className:"columns",style:{height:"calc(80vw * .333)",border:"thin ridge",margin:"auto",marginBottom:"20px",maxWidth:"1000px",maxHeight:"290px"}},React.createElement("div",{id:"cover-image-div",className:"column is-one-fifth"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:o}))),React.createElement("div",{className:"column is-four-fifths"},React.createElement("a",null,React.createElement("h1",{className:"title"},t.title)),React.createElement("h2",{className:"subtitle"},"By ",t.author),React.createElement("p",{style:{overflow:"hidden",textOverflow:"auto",height:"calc((80vw * .333) - 150px)"}},'"',t.abstract,'"')),React.createElement("div",{style:{position:"relative"}},React.createElement("a",{className:"button","data-novel-id":t._id,style:{position:"absolute",bottom:"10px",right:"10px"},onClick:async t=>{loggedInAsResponse=await fetch("/getLoggedInAs"),myAccount=await loggedInAsResponse.json();const n=t.target.getAttribute("data-novel-id");console.log("myAccount"),console.log(myAccount),console.log("added novel"),console.log(n),await a.sendPost("/addNovelToLibrary",{userID:Object.values(myAccount)[0]._id,novelID:n,_csrf:e.csrf},(e=>{console.log(e)}))}},React.createElement("span",{style:{display:"flex",gap:"10px",alignItems:"center"}},React.createElement("i",{className:"fa-solid fa-plus"}),"add to library"))))},l=e=>{const t=e.novel,n=r.from(t.cover.data,"base64").toString("base64"),o=`data:${t.coverMime};base64,${n}`;return React.createElement("div",{id:`${t.title.replace(/ /g,"_")}-featured-card`,className:"columns",style:{height:"calc(70vw * .315)",border:"thin ridge",margin:"auto",maxWidth:"1200px",maxHeight:"290px"}},React.createElement("div",{id:"cover-image-div",className:"column"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{src:o}))),React.createElement("div",{className:"column is-four-fifths",style:{display:"flex",flexFlow:"column",height:"100%"}},React.createElement("a",null,React.createElement("h1",{className:"title"},t.title)),React.createElement("h2",{className:"subtitle"},"By ",t.author),React.createElement("p",{style:{display:"flex",overflow:"hidden",textOverflow:"ellipsis",height:"calc((70vw * .315) - 150px)"}},'"',t.abstract,'"')),React.createElement("div",{style:{position:"relative"}},React.createElement("a",{className:"button","data-novel-id":t._id,style:{position:"absolute",bottom:"10px",right:"10px"},onClick:async t=>{loggedInAsResponse=await fetch("/getLoggedInAs"),myAccount=await loggedInAsResponse.json();const n=t.target.getAttribute("data-novel-id");console.log("myAccount"),console.log(myAccount),console.log("added novel"),console.log(n),await a.sendPost("/addNovelToLibrary",{userID:Object.values(myAccount)[0]._id,novelID:n,_csrf:e.csrf},(e=>{console.log(e)}))}},React.createElement("span",{style:{gap:"10px",alignItems:"center"}},React.createElement("i",{className:"fa-solid fa-plus"}),"add to library"))))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log(t),console.log("here"),ReactDOM.render(React.createElement(o,{csrf:t.csrfToken}),document.getElementById("home-content")),console.log("im here");const n=await fetch("/getAllNovels",{method:"GET"}),a=await n.json(),r=a;console.log("allNovels"),console.log(a),((e,t)=>{console.log("novels"),console.log(e);for(const n of e){const e=document.createElement("div");document.getElementById("novel-cards-container").appendChild(e),ReactDOM.render(React.createElement(s,{csrf:t,novel:n}),e);const a=document.getElementById(`${n.title.replace(/ /g,"_")}-card`);a.onmouseenter=()=>{a.style.backgroundColor="#bbf0de"},a.onmouseleave=()=>{a.style.backgroundColor="#ffffff"},a.onclick=()=>{localStorage.setItem("partchment-viewNovelID",n._id),localStorage.setItem("partchment-viewNovelBack","/home"),window.location.assign("/viewNovel")}}})(a,t.csrfToken),((e,t)=>{console.log("featured novels"),console.log(e);for(let n=0;n<Object.keys(e).length;n++){const a=Object.values(e)[n];console.log("featured novel"),console.log(a);const r=document.createElement("div");r.className=`item-${n+1} slide`,r.style.display=0===n?"block":"none",document.getElementById("carousel-cards").appendChild(r),ReactDOM.render(React.createElement(l,{csrf:t,novel:a}),r);const o=document.getElementById(`${a.title.replace(/ /g,"_")}-featured-card`);o.onmouseenter=()=>{o.style.backgroundColor="#bbf0de"},o.onmouseleave=()=>{o.style.backgroundColor="#ffffff"},o.onclick=()=>{localStorage.setItem("partchment-viewNovelID",a._id),localStorage.setItem("partchment-viewNovelBack","/home"),window.location.assign("/viewNovel")}}})(r,t.csrfToken),console.log(document.getElementById("home-content"))}}},911:(e,t,n)=>{n(603);const a=n(764).lW,r=e=>React.createElement("div",{id:"shelves"}),o=e=>{novel=e.novel,console.log("novel"),console.log(novel);const t=a.from(e.novel.cover,"base64").toString("base64"),n=`data:${e.novel.coverMime};base64,${t}`,r=150*e.n;return console.log(r),React.createElement("div",{className:"novel-card","data-card-number":e.n,style:{width:150,position:"absolute",bottom:"0px",left:`${r}px`},onMouseEnter:t=>{const n=document.getElementById(`${e.novel.title}-title`);n.classList.add("is-size-4"),n.classList.remove("is-size-5"),t.currentTarget.style.width=200;const a=document.querySelectorAll(".novel-card");for(const t of a)t.getAttribute("data-card-number")>e.n&&(t.style.left=150*t.getAttribute("data-card-number")+50)},onMouseLeave:t=>{const n=document.getElementById(`${e.novel.title}-title`);n.classList.add("is-size-5"),n.classList.remove("is-size-4"),t.currentTarget.style.width=150;const a=document.querySelectorAll(".novel-card");for(const t of a)t.getAttribute("data-card-number")>e.n&&(t.style.left=150*t.getAttribute("data-card-number"))},onClick:e=>{console.log(`Card clicked: ${e.currentTarget}`),localStorage.setItem("partchment-viewNovelID",novel._id),localStorage.setItem("partchment-viewNovelBack","/library"),window.location.assign("/viewNovel")}},React.createElement("div",{className:"card"},React.createElement("div",{className:"card-image"},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${e.novel.title}-img`,src:n,alt:"Placeholder image"})))),React.createElement("h1",{id:`${e.novel.title}-title`,className:"is-size-5 has-text-left has-text-grey-dark",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.novel.title),React.createElement("h2",{className:"is-size-6 has-text-left has-text-grey"},novel.author))},s=e=>{const t=document.getElementById("shelves"),n=document.createElement("h1");n.innerText=e.title,n.className="title",n.style.paddingBottom="0px",n.style.marginBottom="0px";const a=document.createElement("div");a.style.display="flex",a.style.flexFlow="no-wrap",a.style.gap="10px",a.style.overflowX="auto",a.style.paddingLeft="10px",a.style.paddingRight="10px",a.style.paddingTop="5px",a.style.paddingBottom="20px",a.style.borderBottom="thick solid",a.style.position="relative",a.style.height="400px";let r=0;for(const t of Object.values(e))if(t._id){const e=document.createElement("div");e.style.position="relative",ReactDOM.render(React.createElement(o,{novel:t,n:r}),e),a.appendChild(e),r++}t.appendChild(n),t.appendChild(a)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();libraryReponse=await fetch("/getMyLibrary"),myLibrary=await libraryReponse.json(),console.log(myLibrary),ReactDOM.render(React.createElement(r,{csrf:t.csrfToken}),document.getElementById("library-content"));for(const e of myLibrary)s(e)}}},316:(e,t,n)=>{const a=n(603),r=e=>{e.preventDefault();const t=e.target.querySelector("#user").value,n=e.target.querySelector("#pass").value,r=e.target.querySelector("#_csrf").value;return t&&n?(a.sendPost(e.target.action,{username:t,pass:n,_csrf:r}),!1):(e.target.querySelector("#login-error-span").innerHTML="Username or password is empty!",!1)},o=e=>{e.preventDefault();const t=e.target.querySelector("#user").value,n=e.target.querySelector("#pass").value,r=e.target.querySelector("#pass2").value,o=e.target.querySelector("#_csrf").value;return t&&n&&r?n!==r?(e.target.querySelector("#signup-error-span").innerHTML="Passwords do not match!",!1):(a.sendPost(e.target.action,{username:t,pass:n,pass2:r,_csrf:o}),!1):(e.target.querySelector("#signup-error-span").innerHTML="Username or password is empty!",!1)},s=e=>(console.log("login window"),console.log(e),React.createElement("form",{id:"loginForm",name:"loginForm",onSubmit:r,action:"/login",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Login")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"username"},"Username: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"user",type:"text",name:"username",placeholder:"Username"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fas fa-user"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass",type:"password",name:"pass",placeholder:"Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"login-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Sign in"})))),l=e=>(authenticateUsername=async t=>{const n=t.currentTarget;console.log("signup window - authenitcate username"),console.log(e),await a.sendPost("/isUsernameAvailable",{username:t.currentTarget.value,_csrf:e.csrf},(e=>{let t=n.parentElement,a=t.querySelector("#username-success-icon"),r=t.parentElement.querySelector("#isAvailable");e.found?(a.innerHTML='<i class="fa-solid fa-exclamation"></i>',r.innerHTML="This username is taken",r.classList="help is-danger"):(a.innerHTML='<i class="fas fa-check"></i>',r.innerHTML="This username is available",r.classList="help is-success")}))},React.createElement("form",{id:"signupForm",name:"signupForm",onSubmit:o,action:"/signup",method:"POST",className:"mainForm box"},React.createElement("div",{className:"title"},React.createElement("h1",null,"Sign Up")),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"username"},"Username: "),React.createElement("div",{className:"control has-icons-left has-icons-right"},React.createElement("input",{className:"input",id:"user",type:"text",name:"username",placeholder:"Username",onChange:authenticateUsername}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fas fa-user"})),React.createElement("span",{id:"username-success-icon",className:"icon is-small is-right"})),React.createElement("p",{id:"isAvailable",className:"help is-success"})),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass",type:"password",name:"pass",placeholder:"Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("div",{className:"field"},React.createElement("label",{className:"label",htmlFor:"pass2"},"Password: "),React.createElement("div",{className:"control has-icons-left"},React.createElement("input",{className:"input",id:"pass2",type:"password",name:"pass",placeholder:"Retype Password"}),React.createElement("span",{className:"icon is-small is-left"},React.createElement("i",{className:"fa-solid fa-lock"})))),React.createElement("input",{id:"_csrf",type:"hidden",name:"_csrf",value:e.csrf}),React.createElement("span",{id:"signup-error-span",className:"has-text-danger"}),React.createElement("div",{className:"control is-pulled-right"},React.createElement("input",{className:"formSubmit button is-link",type:"submit",value:"Sign Up"}))));e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log("init login"),console.log(t),ReactDOM.render(React.createElement(s,{csrf:t.csrfToken}),document.getElementById("login-content"))},renderLoginWindow:async e=>{ReactDOM.render(React.createElement(s,{csrf:e.csrf}),document.getElementById("login-content"))},renderSignUpWindow:async e=>{console.log("render signup window"),console.log(e),console.log(e._csrf),ReactDOM.render(React.createElement(l,{csrf:e._csrf}),document.getElementById("login-content"))}}},441:(e,t,n)=>{const a=n(603);let r;e.exports={openModal:(e,t)=>{console.log("data"),console.log(e);const n=e.modalType,o=document.getElementById("modal"),s=document.getElementById("modal-card-body");s.innerHTML="";const l=document.getElementById("modal-save-button"),i=document.getElementById("modal-title");switch(n){case"abstract":const n=e=>React.createElement("textarea",{id:"modal-textarea",className:"textarea has-fixed-size",placeholder:"Add a description...",rows:"15",defaultValue:e.value});l.removeEventListener("click",r);const o=()=>{t({abstract:document.getElementById("modal-textarea").value})};r=o,l.addEventListener("click",o),i.innerHTML="Abstract";const u=document.createElement("div");ReactDOM.render(React.createElement(n,{value:e.abstract}),u),s.appendChild(u);break;case"title":const m=e=>React.createElement("textarea",{id:"modal-textarea",className:"textarea has-fixed-size",placeholder:"Add a description...",rows:"1",defaultValue:e.value});l.removeEventListener("click",r);const p=()=>{t({title:document.getElementById("modal-textarea").value})};r=p,l.addEventListener("click",p),i.innerHTML="Title";const f=document.createElement("div");ReactDOM.render(React.createElement(m,{value:e.title}),f),s.appendChild(f);break;case"publishChapter":const h=e=>React.createElement("div",null,React.createElement("a",{className:"button is-link",onClick:()=>{t({mode:"add-last"})}},"Publish As Latest Chapter"),React.createElement("p",{className:"subtitle"},"Or, Choose where to add it:"),React.createElement("div",{id:"modal-chapter-div",style:{border:"thin ridge",minHeight:"400px",overflowY:"auto"}}));l.removeEventListener("click",r);const g=()=>{console.log("yes clicked"),document.getElementById("modal-chapter-div").querySelectorAll("span").forEach((n=>{if("true"===n.getAttribute("data-selected")){const a=n.parentElement.querySelector("#chap-option").querySelector("p").innerText;if("chap-option"===n.id)return void t({chapter:e.chapter,referenceChapter:a,mode:"replace"});if("chap-insert"===n.id){if("before"==n.getAttribute("data-insert"))return void t({chapter:e.chapter,referenceChapter:a,mode:"insert-before"});if("after"==n.getAttribute("data-insert"))return void t({chapter:e.chapter,referenceChapter:a,mode:"insert-after"})}}}))};r=g,l.addEventListener("click",g),i.innerHTML="Publish Chapter";const y=document.createElement("div");ReactDOM.render(React.createElement(h,{value:e.title}),y),s.appendChild(y),c=e.chapter,d=e.csrf,a.sendPost("/searchNovelByID",{novelID:c.novelID,_csrf:d},(e=>{console.log("novel response"),console.log(e);const t=[];Object.keys(e.novel.chapters).forEach((e=>{e.includes("chapter-")&&t.push(e)}));const n=document.getElementById("modal-chapter-div"),a=document.getElementById("modal-save-button"),r=e=>{const t=e=>{let t="true"===e.getAttribute("data-selected");n.querySelectorAll("#chap-option-container").forEach((e=>{e.setAttribute("data-selected","false")}));let a=!1;e.childNodes.forEach((e=>{"true"===e.getAttribute("data-selected")&&(a=!0)})),t&&!a||e.setAttribute("data-selected","true")},r=e=>{let a="true"===e.currentTarget.getAttribute("data-selected");n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false")})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false")})),a||e.currentTarget.setAttribute("data-selected","true"),t(e.currentTarget.parentElement),l(e.currentTarget.parentElement)},o=e=>{e.currentTarget.style.height="40px",e.currentTarget.style.backgroundColor="#c2f542",e.currentTarget.querySelector("p").style.fontSize="20px"},s=e=>{"true"===e.currentTarget.getAttribute("data-selected")?(e.currentTarget.style.height="40px",e.currentTarget.style.backgroundColor="#62c462",e.currentTarget.querySelector("p").style.fontSize="20px"):"true"===e.target.parentElement.getAttribute("data-selected")?(e.currentTarget.style.height="40px",e.currentTarget.style.backgroundColor="#42cbf5",e.currentTarget.querySelector("p").style.fontSize="20px"):(e.currentTarget.style.height="30px",e.currentTarget.style.backgroundColor="#bbf0de",e.currentTarget.querySelector("p").style.fontSize="17px")},l=e=>{e.querySelectorAll("span").forEach((e=>{var t;"true"===(t=e).getAttribute("data-selected")?(t.style.height="40px",t.style.backgroundColor="#62c462",t.querySelector("p").style.fontSize="20px"):"true"===t.parentElement.getAttribute("data-selected")?(t.style.height="40px",t.style.backgroundColor="#42cbf5",t.querySelector("p").style.fontSize="20px"):(t.style.height="30px",t.style.backgroundColor="#bbf0de",t.querySelector("p").style.fontSize="17px")}))};return React.createElement("div",{id:"chap-option-Container","data-selected":"false",onClick:e=>{}},React.createElement("span",{id:"chap-insert",className:"has-text-grey","data-selected":"false","data-insert":"before",style:{visibility:"hidden",display:"none",height:"30px",gap:"10px",alignItems:"center",border:"thin ridge",backgroundColor:"#bbf0de"},onClick:r,onMouseEnter:o,onMouseLeave:s},React.createElement("i",{className:"fa-solid fa-arrow-up",style:{userSelect:"none"}}),React.createElement("p",{style:{userSelect:"none"}},"insert before")),React.createElement("span",{id:"chap-option",className:"has-text-grey","data-selected":"false",style:{border:"thin ridge",display:"flex",alignItems:"center",gap:"10px",height:"30px",backgroundColor:"#bbf0de"},onClick:e=>{let r="true"===e.currentTarget.getAttribute("data-selected");n.querySelectorAll("#chap-option").forEach((e=>{e.setAttribute("data-selected","false"),e.style.height="30px",e.style.backgroundColor="#bbf0de",e.style.fontSize="17px"})),n.querySelectorAll("#chap-insert").forEach((e=>{e.setAttribute("data-selected","false"),e.style.visibility="hidden",e.style.display="none"})),r?a.disabled=!0:(e.currentTarget.setAttribute("data-selected","true"),e.currentTarget.parentElement.querySelectorAll("#chap-insert").forEach((e=>{e.style.visibility="visible",e.style.display="flex"})),a.disabled=!1),t(e.currentTarget.parentElement),l(e.currentTarget.parentElement)},onMouseEnter:o,onMouseLeave:s},React.createElement("i",{className:"fa-solid fa-repeat",style:{userSelect:"none"}}),React.createElement("p",{style:{fontSize:"17px",userSelect:"none"}},e.chapter)),React.createElement("span",{id:"chap-insert",className:"has-text-grey","data-selected":"false","data-insert":"after",style:{visibility:"hidden",display:"none",height:"30px",gap:"10px",alignItems:"center",border:"thin ridge",backgroundColor:"#bbf0de"},onClick:r,onMouseEnter:o,onMouseLeave:s},React.createElement("i",{className:"fa-solid fa-arrow-down",style:{userSelect:"none"}}),React.createElement("p",{style:{userSelect:"none"}},"insert after")))};for(const e of t){const t=document.createElement("div");ReactDOM.render(React.createElement(r,{chapter:e}),t),n.appendChild(t)}if(console.log(n),""===n.innerText){const e=document.createElement("p");e.innerText="This is the first chapter!",n.appendChild(e)}}));break;case"unpublishChapter":console.log("unpublish chapter");break;case"deleteChapter":console.log("delete chapter");const b=()=>{l.innerText="Save",l.className="button is-primary",t()};r=b,l.addEventListener("click",b),l.innerText="Delete",l.className="button is-danger",i.innerHTML="Delete Chapter",s.innerText="Are You Sure you want to delete this chapter?"}var c,d;o.classList.add("is-active")},closeModal:()=>{document.getElementById("modal").classList.remove("is-active")},closeAllModals:e=>{(document.querySelectorAll(".modal")||[]).forEach((e=>{e.classList.remove("is-active")}))}}},856:e=>{const t=()=>{const e=document.querySelector("header").getAttribute("data-current-page");Array.from(document.querySelector(".navbar-start").children).concat(Array.from(document.querySelector(".navbar-end").children)).forEach((t=>{if(t.id===e)if("login"===e){const e=document.querySelector("#login"),t=document.querySelector("#signup");document.querySelector("#loginForm")?(e.classList="navbar-item is-tab is-active",t.classList="navbar-item is-tab"):(e.classList="navbar-item is-tab",t.classList="navbar-item is-tab is-active")}else t.classList="navbar-item is-tab is-active";else"signup"===t.id||(t.classList="navbar-item is-tab")}))};e.exports={Navbar:()=>React.createElement("nav",{className:"navbar is-dark has-shadow"},React.createElement("div",{className:"navbar-brand"},React.createElement("a",{className:"navbar-item",href:"/"},React.createElement("i",{className:"fa-solid fa-scroll"})),React.createElement("a",{className:"navbar-burger",id:"burger",onClick:e=>{e.preventDefault();try{let t=e.currentTarget.parentElement.parentElement.querySelector("#nav-links");e.currentTarget.classList.toggle("is-active"),t.classList.toggle("is-active")}catch(e){console.log(e)}}},React.createElement("span",null),React.createElement("span",null),React.createElement("span",null))),React.createElement("div",{className:"navbar-menu",id:"nav-links"},React.createElement("div",{className:"navbar-start"},React.createElement("a",{id:"home",className:"navbar-item is-tab",href:"/home"},"Home"),React.createElement("a",{id:"create",className:"navbar-item is-tab",href:"/create"},"Create"),React.createElement("a",{id:"library",className:"navbar-item is-tab",href:"/library"},"Library")),React.createElement("div",{className:"navbar-end"},React.createElement("a",{id:"login",className:"navbar-item is-tab",onClick:t},"Login"),React.createElement("a",{id:"signup",className:"navbar-item is-tab",onClick:t},"Sign Up"),React.createElement("a",{id:"signout",className:"navbar-item is-tab"},"Sign Out"),React.createElement("a",{id:"profile",className:"navbar-item is-tab",href:"/profile"},React.createElement("i",{className:"fa-solid fa-user"}))))),initializeNavbar:async(e,n)=>{let a=await fetch("/isLoggedIn"),r=await a.json();t();let o=document.getElementById("signout"),s=document.getElementById("profile"),l=document.getElementById("signup"),i=document.getElementById("login");if(r.loggedIn)o.style.display="flex",s.style.display="flex",l.style.display="none",i.style.display="none",o.addEventListener("click",(async e=>{e.preventDefault();let t=await fetch("/logout");window.localStorage.setItem("partchment-LoadSignUp",!1),window.location.assign(t.url)}));else{o.style.display="none",s.style.display="none",l.style.display="flex",i.style.display="flex";let t=!1;null!=document.getElementById("login-content")&&(t=!0),i.addEventListener("click",(async a=>{if(a.preventDefault(),t)return await e.renderLoginWindow({_csrf:n}),!1;{let e=await fetch("/login");return window.localStorage.setItem("partchment-LoadSignUp",!1),window.location.assign(e.url),!1}})),l.addEventListener("click",(async a=>{if(a.preventDefault(),t)return await e.renderSignUpWindow({_csrf:n}),!1;{let e=await fetch("/login");return window.localStorage.setItem("partchment-LoadSignUp",!0),window.location.assign(e.url),!1}}))}},updateSelectedPage:t}},493:e=>{const t=e=>React.createElement("div",{style:{width:"100vw",margin:"auto"}},React.createElement("span",{style:{margin:"auto",alignSelf:"center"}},React.createElement("h1",{className:"title"},"Page Not Found.")));e.exports={init:async()=>{const e=await fetch("/getToken"),n=await e.json();console.log(n),ReactDOM.render(React.createElement(t,{csrf:n.csrfToken}),document.getElementById("not-found-content"))}}},333:e=>{e.exports={init:async()=>{const e=await fetch("/getToken");await e.json()}}},112:(e,t,n)=>{const a=n(603),r=e=>React.createElement("div",{style:{marginLeft:"20px",marginRight:"20px",marginTop:"20px"}},React.createElement("div",{id:"chapter-content",style:{border:"solid thick",minHeight:"80vh",padding:"20px",maxWidth:"1000px",margin:"auto"}})),o=e=>React.createElement("div",{style:{minHeight:"80vh",position:"relative"}},React.createElement("h1",{className:"title is-size-2"},"Chapter ",e.chapterNumber,": ",e.title),React.createElement("div",{id:"chapter-content-div",style:{paddingBottom:"80px"}}),React.createElement("div",{id:"changeChapter",style:{display:"flex",width:"100%",justifyContent:"center",textAlign:"center",position:"absolute",bottom:"10px"}},React.createElement("span",{className:"previousChapter",onClick:()=>{const t=e.chapterNumber-1;a.sendPost("/setChapterNumber",{novelID:e.novelID,chapterNumber:t,_csrf:e.csrf},(t=>{"There are no more chapters"===t.error||"You cannot view a chapter with a negative index"===t.error||t.error?console.log(t.error):s(e.csrf)}))}},"❮"),React.createElement("h2",{style:{fontWeight:"bold"}},"~-~  End Chapter  ~-~"),React.createElement("span",{className:"nextChapter",onClick:()=>{const t=e.chapterNumber+1;a.sendPost("/setChapterNumber",{novelID:e.novelID,chapterNumber:t,_csrf:e.csrf},(t=>{"There are no more chapters"===t.error||"You cannot view a chapter with a negative index"===t.error||t.error?console.log(t.error):s(e.csrf)}))}},"❯"))),s=e=>{const t=localStorage.getItem("partchment-readNovel");a.sendPost("/getChapterNumber",{novelID:t,_csrf:e},(n=>{console.log(n),a.sendPost("/searchChapterNumber",{novelID:t,chapterNumber:n,_csrf:e},(t=>{console.log(t);const a=document.getElementById("chapter-content");a.innerHTML="";const r=document.createElement("div");ReactDOM.render(React.createElement(o,{chapterNumber:n,title:t.title,novelID:t.novelID,csrf:e}),r),a.appendChild(r),document.getElementById("chapter-content-div").innerHTML=t.content}))}))};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log(t),ReactDOM.render(React.createElement(r,{csrf:t.csrfToken}),document.getElementById("read-novel-content")),s(t.csrfToken)}}},841:(e,t,n)=>{const a=n(603),r=n(764).lW,o=e=>{const t=e.novel;console.log("novel"),console.log(t);const n=r.from(t.cover.data,"base64").toString("base64"),o=`data:${t.coverMime};base64,${n}`,l=new Date(t.createdDate).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return React.createElement("div",null,React.createElement("div",{className:"",style:{height:65,width:"100vw",margin:"auto",border:"thin ridge",display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center",paddingRight:"30px"}},React.createElement("div",{className:""},React.createElement("a",{className:"button is-white",onClick:()=>{const e=localStorage.getItem("partchment-viewNovelBack");window.location=e||"/"}},React.createElement("i",{className:"fa-solid fa-arrow-left",style:{padding:"0 10 0 0"}}),"Back"))),React.createElement("div",{className:"box",style:{width:"100vw",margin:"auto",padding:0}},React.createElement("div",{style:{height:20}}),React.createElement("div",{className:"columns",style:{width:"95vw",margin:"auto"}},React.createElement("div",{className:"column",style:{maxWidth:"300px",margin:"auto"}},React.createElement("figure",{className:"image is-2by3"},React.createElement("img",{id:`${t.title}-img`,src:o,alt:"Placeholder image"}))),React.createElement("div",{className:"column is-three-quarters",style:{height:"34.35vw",minHeight:"250px",display:"flex",flexFlow:"column"}},React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h1",{id:"novel-title",className:"title",style:{margin:0,paddingRight:"10px"}},t.title)),React.createElement("h2",{className:"subtitle"},"By: ",t.author),React.createElement("span",{style:{width:"100%",display:"flex",alignItems:"center"}},React.createElement("h2",{className:"subtitle",style:{margin:0,paddingRight:"10px"}},"Abstract")),React.createElement("div",{id:"abstract-text",style:{height:"100%",width:"100%",minHeight:"100px"}},t.abstract))),React.createElement("div",{className:"box"},React.createElement("ul",null,React.createElement("li",null,"Published Chapters: ",t.publishedChapterCount),React.createElement("li",null,"Unpublished Chapters: ",t.totalChapterCount-t.publishedChapterCount),React.createElement("li",null,"Created Date: ",l),React.createElement("li",null,"Published: ",t.published.toString()))),React.createElement("div",{style:{paddingBottom:"20px",display:"flex",justifyContent:"space-evenly",position:"relative"}},React.createElement("a",{id:"library-button",className:"button is-outline","data-add-remove":"add",onClick:async n=>{const r=t._id;console.log("added novel"),console.log(r),"add"==document.getElementById("library-button").getAttribute("data-add-remove")?await a.sendPost("/addNovelToLibrary",{novelID:r,_csrf:e.csrf},(e=>{console.log(e),s(r)})):await a.sendPost("/removeNovelFromLibrary",{novelID:r,_csrf:e.csrf},(e=>{console.log(e),s(r)}))}},React.createElement("span",{style:{display:"flex",gap:"10px",alignItems:"center"}},React.createElement("i",{className:"fa-solid fa-plus"}),"add to library")),React.createElement("a",{className:"button is-link","data-novel-id":t._id,onClick:async e=>{console.log("start reading"),localStorage.setItem("partchment-readNovel",t._id),window.location="/readNovel"}},React.createElement("span",{style:{display:"flex",gap:"10px",alignItems:"center"}},React.createElement("i",{className:"fa-solid fa-book-open-reader"}),"Start Reading")))))},s=async e=>{libraryReponse=await fetch("/getMyLibrary"),myLibrary=await libraryReponse.json(),console.log("myLibrary"),console.log(myLibrary);let t=!1;for(const n of Object.keys(myLibrary[0]))n===e&&(t=!0);const n=document.getElementById("library-button");n.innerHTML="";const a=document.createElement("span");if(a.style.display="flex",a.style.gap="10px",a.style.alignItems="center",t){const e=document.createElement("i");e.className="fa-solid fa-minus";const t=document.createTextNode("remove from library");a.appendChild(e),a.appendChild(t),n.classList.remove("is-outlined"),n.classList.add("is-danger"),n.setAttribute("data-add-remove","remove")}else{const e=document.createElement("i");e.className="fa-solid fa-plus";const t=document.createTextNode("add to library");a.appendChild(e),a.appendChild(t),n.classList.add("is-outlined"),n.classList.remove("is-danger"),n.setAttribute("data-add-remove","add")}n.appendChild(a)};e.exports={init:async()=>{const e=await fetch("/getToken"),t=await e.json();console.log(t),novelID=localStorage.getItem("partchment-viewNovelID"),novelID||(window.location="/"),a.sendPost("/searchNovelByID",{_csrf:t.csrfToken,novelID},(e=>{ReactDOM.render(React.createElement(o,{novel:e.novel,csrf:t.csrfToken}),document.getElementById("view-novel-content"))})),s(novelID)}}},742:(e,t)=>{"use strict";t.byteLength=function(e){var t=i(e),n=t[0],a=t[1];return 3*(n+a)/4-a},t.toByteArray=function(e){var t,n,o=i(e),s=o[0],l=o[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,s,l)),d=0,u=l>0?s-4:s;for(n=0;n<u;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===l&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,c[d++]=255&t),1===l&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,a=e.length,r=a%3,o=[],s=16383,l=0,i=a-r;l<i;l+=s)o.push(c(e,l,l+s>i?i:l+s));return 1===r?(t=e[a-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[a-2]<<8)+e[a-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],a=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=o.length;s<l;++s)n[s]=o[s],a[o.charCodeAt(s)]=s;function i(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,a){for(var r,o,s=[],l=t;l<a;l+=3)r=(e[l]<<16&16711680)+(e[l+1]<<8&65280)+(255&e[l+2]),s.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},764:(e,t,n)=>{"use strict";const a=n(742),r=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=i,t.h2=50;const s=2147483647;function l(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,i.prototype),t}function i(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!i.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|h(e,t);let a=l(n);const r=a.write(e,t);return r!==n&&(a=a.slice(0,r)),a}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return i.from(a,t,n);const r=function(e){if(i.isBuffer(e)){const t=0|f(e.length),n=l(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?l(0):m(e):"Buffer"===e.type&&Array.isArray(e.data)?m(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return i.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),l(e<0?0:0|f(e))}function m(e){const t=e.length<0?0:0|f(e.length),n=l(t);for(let a=0;a<t;a+=1)n[a]=255&e[a];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let a;return a=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(a,i.prototype),a}function f(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function h(e,t){if(i.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return a?-1:Y(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){let a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return B(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function y(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function b(e,t,n,a,r){if(0===e.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=i.from(t,a)),i.isBuffer(t))return 0===t.length?-1:E(e,t,n,a,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):E(e,[t],n,a,r);throw new TypeError("val must be string, number or Buffer")}function E(e,t,n,a,r){let o,s=1,l=e.length,i=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;s=2,l/=2,i/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){let a=-1;for(o=n;o<l;o++)if(c(e,o)===c(t,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===i)return a*s}else-1!==a&&(o-=o-a),a=-1}else for(n+i>l&&(n=l-i),o=n;o>=0;o--){let n=!0;for(let a=0;a<i;a++)if(c(e,o+a)!==c(t,a)){n=!1;break}if(n)return o}return-1}function v(e,t,n,a){n=Number(n)||0;const r=e.length-n;a?(a=Number(a))>r&&(a=r):a=r;const o=t.length;let s;for(a>o/2&&(a=o/2),s=0;s<a;++s){const a=parseInt(t.substr(2*s,2),16);if(K(a))return s;e[n+s]=a}return s}function w(e,t,n,a){return V(Y(t,e.length-n),e,n,a)}function R(e,t,n,a){return V(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function N(e,t,n,a){return V(G(t),e,n,a)}function x(e,t,n,a){return V(function(e,t){let n,a,r;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),a=n>>8,r=n%256,o.push(r),o.push(a);return o}(t,e.length-n),e,n,a)}function I(e,t,n){return 0===t&&n===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);const a=[];let r=t;for(;r<n;){const t=e[r];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(r+s<=n){let n,a,l,i;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[r+1],128==(192&n)&&(i=(31&t)<<6|63&n,i>127&&(o=i));break;case 3:n=e[r+1],a=e[r+2],128==(192&n)&&128==(192&a)&&(i=(15&t)<<12|(63&n)<<6|63&a,i>2047&&(i<55296||i>57343)&&(o=i));break;case 4:n=e[r+1],a=e[r+2],l=e[r+3],128==(192&n)&&128==(192&a)&&128==(192&l)&&(i=(15&t)<<18|(63&n)<<12|(63&a)<<6|63&l,i>65535&&i<1114112&&(o=i))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,a.push(o>>>10&1023|55296),o=56320|1023&o),a.push(o),r+=s}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let n="",a=0;for(;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=k));return n}(a)}i.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(e,t,n){return function(e,t,n){return d(e),e<=0?l(e):void 0!==t?"string"==typeof n?l(e).fill(t,n):l(e).fill(t):l(e)}(e,t,n)},i.allocUnsafe=function(e){return u(e)},i.allocUnsafeSlow=function(e){return u(e)},i.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==i.prototype},i.compare=function(e,t){if(J(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,a=t.length;for(let r=0,o=Math.min(n,a);r<o;++r)if(e[r]!==t[r]){n=e[r],a=t[r];break}return n<a?-1:a<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const a=i.allocUnsafe(t);let r=0;for(n=0;n<e.length;++n){let t=e[n];if(J(t,Uint8Array))r+t.length>a.length?(i.isBuffer(t)||(t=i.from(t)),t.copy(a,r)):Uint8Array.prototype.set.call(a,t,r);else{if(!i.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(a,r)}r+=t.length}return a},i.byteLength=h,i.prototype._isBuffer=!0,i.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},i.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},i.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},i.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):g.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){let e="";const n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(i.prototype[o]=i.prototype.inspect),i.prototype.compare=function(e,t,n,a,r){if(J(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===r&&(r=this.length),t<0||n>e.length||a<0||r>this.length)throw new RangeError("out of range index");if(a>=r&&t>=n)return 0;if(a>=r)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(r>>>=0)-(a>>>=0),s=(n>>>=0)-(t>>>=0);const l=Math.min(o,s),c=this.slice(a,r),d=e.slice(t,n);for(let e=0;e<l;++e)if(c[e]!==d[e]){o=c[e],s=d[e];break}return o<s?-1:s<o?1:0},i.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},i.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},i.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}const r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let o=!1;for(;;)switch(a){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":case"latin1":case"binary":return R(this,e,t,n);case"base64":return N(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),o=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function B(e,t,n){let a="";n=Math.min(e.length,n);for(let r=t;r<n;++r)a+=String.fromCharCode(127&e[r]);return a}function T(e,t,n){let a="";n=Math.min(e.length,n);for(let r=t;r<n;++r)a+=String.fromCharCode(e[r]);return a}function L(e,t,n){const a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);let r="";for(let a=t;a<n;++a)r+=X[e[a]];return r}function A(e,t,n){const a=e.slice(t,n);let r="";for(let e=0;e<a.length-1;e+=2)r+=String.fromCharCode(a[e]+256*a[e+1]);return r}function S(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,a,r,o){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function M(e,t,n,a,r){j(t,a,r,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function _(e,t,n,a,r){j(t,a,r,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function U(e,t,n,a,r,o){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(e,t,n,a,o){return t=+t,n>>>=0,o||U(e,0,n,4),r.write(e,t,n,a,23,4),n+4}function P(e,t,n,a,o){return t=+t,n>>>=0,o||U(e,0,n,8),r.write(e,t,n,a,52,8),n+8}i.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const a=this.subarray(e,t);return Object.setPrototypeOf(a,i.prototype),a},i.prototype.readUintLE=i.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=this[e],r=1,o=0;for(;++o<t&&(r*=256);)a+=this[e+o]*r;return a},i.prototype.readUintBE=i.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=this[e+--t],r=1;for(;t>0&&(r*=256);)a+=this[e+--t]*r;return a},i.prototype.readUint8=i.prototype.readUInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),this[e]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readBigUInt64LE=Z((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(a)+(BigInt(r)<<BigInt(32))})),i.prototype.readBigUInt64BE=Z((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(a)<<BigInt(32))+BigInt(r)})),i.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=this[e],r=1,o=0;for(;++o<t&&(r*=256);)a+=this[e+o]*r;return r*=128,a>=r&&(a-=Math.pow(2,8*t)),a},i.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);let a=t,r=1,o=this[e+--a];for(;a>0&&(r*=256);)o+=this[e+--a]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*t)),o},i.prototype.readInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){e>>>=0,t||S(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){e>>>=0,t||S(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readBigInt64LE=Z((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(a)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),i.prototype.readBigInt64BE=Z((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(a)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),i.prototype.readFloatLE=function(e,t){return e>>>=0,t||S(e,4,this.length),r.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return e>>>=0,t||S(e,4,this.length),r.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return e>>>=0,t||S(e,8,this.length),r.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return e>>>=0,t||S(e,8,this.length),r.read(this,e,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(e,t,n,a){e=+e,t>>>=0,n>>>=0,a||D(this,e,t,n,Math.pow(2,8*n)-1,0);let r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(e,t,n,a){e=+e,t>>>=0,n>>>=0,a||D(this,e,t,n,Math.pow(2,8*n)-1,0);let r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},i.prototype.writeUint8=i.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,255,0),this[t]=255&e,t+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeBigUInt64LE=Z((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),i.prototype.writeBigUInt64BE=Z((function(e,t=0){return _(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),i.prototype.writeIntLE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);D(this,e,t,n,a-1,-a)}let r=0,o=1,s=0;for(this[t]=255&e;++r<n&&(o*=256);)e<0&&0===s&&0!==this[t+r-1]&&(s=1),this[t+r]=(e/o>>0)-s&255;return t+n},i.prototype.writeIntBE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);D(this,e,t,n,a-1,-a)}let r=n-1,o=1,s=0;for(this[t+r]=255&e;--r>=0&&(o*=256);)e<0&&0===s&&0!==this[t+r+1]&&(s=1),this[t+r]=(e/o>>0)-s&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeBigInt64LE=Z((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),i.prototype.writeBigInt64BE=Z((function(e,t=0){return _(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),i.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return P(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return P(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,a){if(!i.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);const r=a-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,a):Uint8Array.prototype.set.call(e,this.subarray(n,a),t),r},i.prototype.fill=function(e,t,n,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!i.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===e.length){const t=e.charCodeAt(0);("utf8"===a&&t<128||"latin1"===a)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{const o=i.isBuffer(e)?e:i.from(e,a),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=o[r%s]}return this};const q={};function $(e,t,n){q[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",n=e.length;const a="-"===e[0]?1:0;for(;n>=a+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function j(e,t,n,a,r,o){if(e>n||e<t){const a="bigint"==typeof t?"n":"";let r;throw r=o>3?0===t||t===BigInt(0)?`>= 0${a} and < 2${a} ** ${8*(o+1)}${a}`:`>= -(2${a} ** ${8*(o+1)-1}${a}) and < 2 ** ${8*(o+1)-1}${a}`:`>= ${t}${a} and <= ${n}${a}`,new q.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){H(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||F(t,e.length-(n+1))}(a,r,o)}function H(e,t){if("number"!=typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,n){if(Math.floor(e)!==e)throw H(e,n),new q.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}$("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),$("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),$("ERR_OUT_OF_RANGE",(function(e,t,n){let a=`The value of "${e}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=z(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=z(r)),r+="n"),a+=` It must be ${t}. Received ${r}`,a}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function Y(e,t){let n;t=t||1/0;const a=e.length;let r=null;const o=[];for(let s=0;s<a;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===a){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return a.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,a){let r;for(r=0;r<a&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const a=16*n;for(let r=0;r<16;++r)t[a+r]=e[n]+e[r]}return t}();function Z(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},645:(e,t)=>{t.read=function(e,t,n,a,r){var o,s,l=8*r-a-1,i=(1<<l)-1,c=i>>1,d=-7,u=n?r-1:0,m=n?-1:1,p=e[t+u];for(u+=m,o=p&(1<<-d)-1,p>>=-d,d+=l;d>0;o=256*o+e[t+u],u+=m,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=a;d>0;s=256*s+e[t+u],u+=m,d-=8);if(0===o)o=1-c;else{if(o===i)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,a),o-=c}return(p?-1:1)*s*Math.pow(2,o-a)},t.write=function(e,t,n,a,r,o){var s,l,i,c=8*o-r-1,d=(1<<c)-1,u=d>>1,m=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=a?0:o-1,f=a?1:-1,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(i=Math.pow(2,-s))<1&&(s--,i*=2),(t+=s+u>=1?m/i:m*Math.pow(2,1-u))*i>=2&&(s++,i/=2),s+u>=d?(l=0,s=d):s+u>=1?(l=(t*i-1)*Math.pow(2,r),s+=u):(l=t*Math.pow(2,u-1)*Math.pow(2,r),s=0));r>=8;e[n+p]=255&l,p+=f,l/=256,r-=8);for(s=s<<r|l,c+=r;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*h}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}(()=>{const e=n(832),t=n(401),a=n(986),r=n(984),o=n(911),s=n(316),l=n(856),i=n(333),c=n(112),d=n(841),u=n(493);n(603),window.onload=async()=>{const n=await fetch("/getToken"),m=await n.json();if(null!=document.getElementById("navbar")){ReactDOM.render(React.createElement(l.Navbar,{csrf:m.csrfToken}),document.getElementById("navbar"));const e={renderLoginWindow:s.renderLoginWindow,renderSignUpWindow:s.renderSignUpWindow};l.initializeNavbar(e,m.csrfToken)}let p=document.querySelector("header").getAttribute("data-current-page");switch(p){case"create":e.init();break;case"editNovel":t.init();break;case"editChapter":a.init();break;case"home":r.init();break;case"library":o.init();break;case"login":await s.init(),"true"===localStorage.getItem("partchment-LoadSignUp")&&(console.log("controller login"),console.log(m),s.renderSignUpWindow({_csrf:m.csrfToken}),window.localStorage.setItem("partchment-LoadSignUp",!1)),l.updateSelectedPage();break;case"profile":i.init();break;case"viewNovel":d.init();break;case"readNovel":c.init();break;case"notFound":u.init();break;default:console.log(`unknown page: ${p}`)}}})()})();